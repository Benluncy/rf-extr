
 A HYBRID OF NEURAL NET AND BRANCH AND BOUND TECHNIQUES FOR SEISMIC HORIZON TRACKING Jay Veezhinathan 
(Amoco Production Research) Frank Kemp (Formerly with Amoco Production Research) Jody Threet (University 
of Tulsa) Abstract A hybrid of neural net and branch and bound search techniques for seismic horizon 
tracking is described in this paper and its results on real as well as synthetic data are shown. Seismic 
horizon tracking is tracking of reflections from a subsurface bed boundary in pro­cessed seismic data. 
Accurately tracking horizons is important for hydrocarbon exploration. Automatic tracking of horizons 
in pro­cessed seismic data is difficult because of noise, nonlhwxity of the horizon shape, and discontinuities 
in the horizon. The hybrid technique works better than existing commercial tech­niques and is able to 
track horizons in the presence of significant discontirtuities. The key steps of the technique are: (1) 
rate peaks in seismic data using a neural ne~ (2) link peaks into segments using a heuristic scheme, 
and (3) identify segments of the horizon of interest using the branch and bound technique. fltis approach 
allows us to integrate seismic attribute information, spatial infor­mation, and geological constraints 
for tracking seismic horizons. Introduction In a seismic survey, signals generated from explosive or 
nonexplo­sive sources on or near the surface propagate through subsurface layers and are finally recorded 
by a spread of receiver arrays. The signsd received by a single array within one receiver for a single 
source signal generation constitutes a ~ . The traces col­lected by all the receiver arrays for a single 
source signal genera­tion constitute a ~ A processed seismic record is called a ~ (F@tse -i). The seismic 
records generated by a sequence of source locations along a linear profile forma @i­*, and a number of 
seismic lines makeup a ~. A horizon in a seismic section is basically reflections from a sub­surface 
bed boundary. The red colored lines running across in Figure 5 are some example horizons. The individual 
traces run ver­tically from top to bottom and are numbered at the top from 1 to 547. The vertical axis 
is time. Manually tracking these horizons becomes an extremely time con­suming task for a 3-D seismic 
dataset containing a large number of seismic lines each of which in turn containing many seismic sec­tions. 
The amount of data to be processed could be staggering. Accurately tracking horizons across multiple 
lines in a seismic dataset is a key to developing a good interpretation of the data. A good interpretation 
is, in turn, essential for sound drilling deci­sions. Automatic tracking facility available in seismic 
interpretation soft­ware packages typically use cross correlation techniques to track a horizon. These 
trackers will be refen ed to as ~ r in the rest of the paper. The new tracker descrhd in this paper will 
&#38; referred to as the ~. Given a peak (located on the horizon of interest) in a trace, the existing 
commercial autotrackera take a cross correlation of this peak with preselected number of nearby peaks 
in the adjacent trace. The peak closest to the maximum cross correlation in the adjacent trace is taken 
to be part of the horizon being tracked. This process is then repeated for the following traces. Note 
that instead of a peak one can also use a trough. Usually, when the maximum cross cor­relation goes below 
a cutoff value, the tracking stops. This is a potential problem because, if the cutoff value is too high, 
the autotracking will stop often necessitating frequent interventions flom the interpreter. If the cutoff 
wdue is too low, spurious peaks will be tracked resulting in an erroneous horizon. Thus these autotrackers 
work well in relatively flat horizons, but they tend to stop frequently in horizons with discontinuities. 
Neural Net Approaches Neuralnetworks have been shown to track another type of seismic event, albeit 
a simpler problem, fairly well (5)(9). This project was started with an objective of developing a neural 
net-based horizon tracker that is superior to commercial autotrackers. An obvious approach to the tracking 
problem is to use a feature­based pattern classification using a neural net or some other tech­nique. 
That is, with the aid of a training set, the seismic entity (a peak or a trough or a Zer-crossing etc.) 
that forms a horizon can be recognized from the rest using a set of signal attributes such as maximum 
amplitude, average amplitude, mean power level, and envelope slope. Once training is done, all remaining 
entities can be classifie@ those that are classified to be on the horizon form the horizon. This approach 
can be called ~ approach. This straight forward technique does not work very well even though seismic 
events tend to have characteristic features. This is due to problems such as noise in the data, nonlinear 
shape of the horizon, and discontinuities in the horizons. A disadvantage of the approach is that it 
is local in mtute and ignores the spatial continu­ity information which humans often use in tracking 
horizons visu­ally. A straight forward improvement to the above scheme to incorpo­rate spatial information 
is to take a window of data (say, all peaks characterized by a set of features in the window) surrounding 
the horizon and train a neural network to classify the seismic entity at the center of the window as 
a horizon entity or a nonhorizon entity. We have attempted this and an extension of this technique for 
horizon tracking. In our extension, we trained a neural net not only to classify the center peak appropriately 
but also to consider the entire pattern in the window and output which direction (up or down along the 
center trace) the window should be moved if the center peak is classified to be a nonhorizon peak. These 
approaches can be called tire wind ow-basexj approaches. The results of our extended feature window-based 
armroach, though comparable to commercial trackers on flat horimns, were 173 not satisfactory for modemtely 
difficult discontinuous horizons. The network output with respect to the conect direction of the movement 
of the window proved unreliable. In tracking the hori­zon if the network made a few up or down movements, 
it tended to wanderaimlessly. So discontinuities in the horizon o!ten proved to be potential land mines 
The feature window-based approaches attempt to incorporate spa­tial information. However, they do not 
explicitly incorporate geo­logical constraints which humans make use of in visual tracking. Some of these 
constraints am horizon segments do not generally overlapandhorizonsdonotcrisscrosseachother.The wandering 
problem can be avoided if the neural networks can be taught to apply these constraints while classifying 
seismic entitim. Though this informationis buriedin the featurewindows used for training, ourresultsindicatethattheneuralnetworkdo 
not learnthese effec­tively. Inotherworda,informationaboutthese cmstraints seem to be lost in the forest 
of data. llds could very well be an adfact of our inputrepresentation. The Hybrid APProacb The previous 
approaches indicate that continuous tracking is fraught with difficulties. As opposed to condnuo us tracking, 
tbe hybrid approach attempts to piece together a horizon from all seg­ments in the section using a hybrid 
of neural net (feature-W chamcterization) and the branch and bound search technique. A key featureof 
the hybridapproachis thatit allows incorporationof geological constraints in identifying segments that 
form the hori­zon. This was not possible before. A feature-based neural network coupled with a simple 
algorithm was used to create and join segments. These segrrmts were then pieced together using the branch 
and bound technique to form the horizon. The intuitive appeal of the technique is that it cannot get 
lost since no continuous tracking is done. The key steps are 1. Peak RatimzUsimZa N-a -Usinga manuallypicked 
portionof thehorizon,abackpropagationnetwork(7)was trainedtorateapeak astohow similaritistoapeakonthe 
horizon of interest. &#38;h peak was chmcterized by its amplitude and mean power level. These atbibutes 
were originally proposed by fhnner(8) and wem &#38;term&#38;d to beuset%linourpreviousworkon firstarrivalpickingusing 
a neural net (9). Three adjacent peaks from a trace were input to this network and the center peak was 
rated as shown in Pigure 1. The reason for using three peaks is to provide a limited amountof local (intra-trace) 
contextual information while rating the center peak. The input to the networkconsisted of 6 values, andthe 
one outputwas a real valuebetweenOto 1.Thenumberof hiddenunitswere2. The resultof this step is shown 
in Figure-2. t heinp utvalueswe resealed to bebetween-lto+l. lle learning rate WSS.8and momentum rate 
was.4. Ij@alIy 2030 traceswere used for trainingthe network. Given the tining traces, positive examples 
are obvious to choose since them is only one horizon peak per trace. On the other hand, many no@orizon 
peaks (negative exam­ples) per trace are available to chose from. lb make sure that the number of negative 
examples was approximately the same as the positive examples, the following scheme was used 1) Randomly 
pick a non-horizon peak from the manyon atraceandusethisto trainthenetworktill theout­puterroris small.2) 
Apply thepartiallytrainedneuralnet to the picked traces and look for non-horizon peaks with output values 
close to 1.Useone of these per trace as nega­tive examples and train the network again. 3) Repeat the 
 174 Flgum2Rated Peakainasakmic sra!tion above step until only a very few non-horizon peaks have outputvalues 
close to 1. Figure 1: Peak Rating Neural Net 2. ~- f herat cdpeaksfromtbe above step were joined together 
to create smaller segments which in turnlinkedtogethertoform1-segmentsintwo phases. Inphase-1, the peaks 
are sorted from the highest rating to the loweat rating. The tirat or top peak in the sorted list is 
mmid-m&#38;~ofaw~~Ifti~t~kti right (or left) adjacent trace had a rating value which exceeds the rating 
of peaks immediately below or above by 0.1 and which is within five sample points of the Iirst peak, 
then this peak is considered to form a segment with the first peak. At this point we have a segment of 
two peaks (tkom two adjacent traces). Ilk process continues as far as it can go to the right. When no 
peak satisfies these conditions on the righ~ peaks on the left of the tirst (peak starting this seg­ment) 
are considered in the same way. The peaks that form this first segment are deleted ffom the sorted list 
and the highest rated peak fromtbemnaindmisusedasthestartm to create another segment in the same way. 
The results of this step are a set of disjointed segments as shown in Pigure 3. . O.. . 000000 0.. o-O-O 
o@ o-o . 000000 S*   y$9* ~ I Figure 3: Peaks Linked intosegments [n phase-2, the numberof segments 
are reduced by attempt­ing to create longer segments by joining appropriate seg­ments from the previous 
phase. IWOsegments (say A and B such that B starts after A) not very far apart (maximum 40 traces apart) 
are joined together if and only if a set of hops fmm the end of A can lead to beginning of B and vice 
versa. A hop is a move from a peak to the closest peak on the adjecent trace, provided the closest peak 
is within 5 time samples away. Tbe result of phase-2 is shown in Figure 4. I 1 Figure 4 Segment Linking 
by Simple lhcking Note that in phase-1 and phase-2a peak can belong to only one segment. .. 3. ~ -From 
the segments generated in the previous step, the segments that form the horizon of interest are identified 
using the well known branch and bound search technique. lb prune the search nodes, two geological constraints 
are applied during the search: 1) segments of the same horizon cannot overlap. 2) since horizons do not 
crisscross each other, the imaginary line between any pair of segments (the end of one and the stat of 
another), can not intersect a third segment. If they do, then this pair can not be part of the same horizon. 
The objective of the branch and bound technique is to chain segments in such a way that the average rating 
of the peaks on the horizon is maximum. The upper bound of a particu­lar node in the search path is calculated 
using average peak rating of segments included in the path so far and assuming a maximum average rating 
of 1 for a segment of maximum possible length (equal to the remaining number of traces in the search). 
For details of the search technique, refer to (3). Results The hybrid approach was tested using both 
real data as well as syn­thetic data. The results are shown in Figures 5-6 and Figures 7-10. Figure 5 
shows six horizons (in red) of real seismic data tracked by the commercial autotracker. The number of 
human interventions required for the autotracker for these six horizons (from top to bot­tom) are 1,6,7,3,2, 
and 5 respectively. Figure 6 shows the result of the hybrid approach. It is to be noted that the hybrid 
approach did not rqdre any human intervention. The horizons used for testing the neural net on synthetic 
data are shown in Figure 7. TIM five horizons shown there (red, black, green, top of salt, and base of 
salt) are noteworthy for their discon­tinuities. The top of the salt and base of the salt are especially 
dif­ficult for tracking because of their near verticrd edges and because of their wiggly nature. The 
results of the hybrid tracker are shown in Figures 8-10. Figure 8 shows in blue the horizon tracked by 
the hybrid approach overlaid on top of red which is the result of interpreter tracking. Figure 9 shows 
the top of the salt dome as tracked by the hybrid tracker in blue. Even though the vertical edge was 
not tracked com­pletely, the hybrid tracker was able to jump around the signifi­cant discontinuities 
which the commercial autotrackers were incapable of. Additionally, no intervention was required. Similar 
results were obtained for the base of the salt dome (F@ure 10). In summaq, the hybrid approach tracked 
better than commercial auto pickers in the datasets we have tested so far. We do have to test the approach 
more and we plan to do so in the future. Previous Work Ourextended feature-window based approach is 
very similar to the One Used by MtXorma&#38; (5) for first arrival picking. While it worked well for 
the first arrival picking problem, it did not work well for horizon tracking which is inherently a more 
diftlcult prob­lem. our hybrid approach, though independently developed, 1S Simih to the work by C&#38;dings 
and Burkhout (2) for tracking seismic events in that they also use a hybrid approach -a hybrid of discrim­inant 
anrdysis (1) and A* search (6). The differences, however, are significarw 1) they search through the 
space peaks evaluated by discriminant analysis to build the horizon. This is a much bigger space than 
the space of segments we work with. 2) we are able to bring in geological constraints in controlling 
the search effectively since we search through segments. Conclusions The technique presented here is 
useful for tracking any boundary where the elements constituting the boundary can be characterized using 
signal attributes and where domain constraints are important for tracking. For binary images, this technique 
may not work well since attribute information may not be rich enough. Our hybrid approach proved to be 
superior to existing commercial autotrackers in the tests we have done so far in terms of tracking accuracy, 
but not in terms of computer time. The computer perfor­mance is of the order of few minutes to few hours 
depending on how many sections have to be tracked. We use it in batch mode. We believe that the superior 
accuracy is achieved because of the combination of tihniques employed to integrate different kinds of 
information such as feature space information, spatial information, and geological information in solving 
this Problem. As opposed to tracking the entire horizon continuously, we synthesize the horizon from 
small locally-tracked horizon segments. This shift in approach is a key contribution of the paper. References 
.. <RefA>1. Du&#38; R. O., and Hm, P. E., 1973, ~ ~, Wiley-Interscience, New York, 1973. 2. Geerlings, A. 
C., and Berkhout, A. J., 1989, Heuristic Event Tracking Linked to Linear Discriminant Analysis, m GeO* 
Data ~, vol. 3, pp. 201-233.  3. Kemp, F., Threet, J., and Veezhinathan, J., 1992, A Neural Net Branch 
and Bound Seismic Tracker, Submitted to SEG Annual Conference. 4. Landmark Graphics Corp, Reference 
Manual, Aug. 1990, technical section on ZAP (Zoned Autopicker).  5, McCormack, M. D., 1990, Seismic 
Trace Editing and First Picking Using Neural Networks, Extended Abstract, ~ QfSK s~ , pp. 716-718, Dallas, 
Texas. . . 6. Nilsson, N. J., 1980, ~ , ~oga Publishing Co., Palo Alto, CA. ..  7. Rumelhart, D. and 
McClelland, J., 1986, ~el _ ~, Vol. 1, MIT Press, Cambridge, MA.  175 8. Tanner,M. T., Koehler, F., 
and Sheriff, R. E., 1979, Com­plex Seismic Trace Analysis, GM@@&#38; Vol. 44, No. 6, June, pp. 1041-1063. 
 9. Veezhinathu J., Wagner, D., and Elder, J., 1991, First-Break Ficking Using a Neural Network, &#38;oert 
Svstems in ~, SEG Publication, 1992. </RefA> AcwaAclww.kmLu3A 01993 ACM O-S9791-56&#38;~176.Sl~ s? 547 S08473440407374341~ 
27524220317614311088~ 44221 cop 8486m MOsm4s0400 3503002s0200 1s0 102 TRACE S47SO0 450 400 3s0 300 2s0 
200 1s0 100 sol 0.400 0s00 k 0.600 o.7m 0.800 Figure 5. Six Interpreted Horizom of Real Data Ustng 
Autoplcker SP COP TRACE S47508473440407374341308 848w03sosm4s0400 S47500 4s0 3 I , f 27524220217614311 
M868 44221 3S03W2S02W 1s0 102 400 350 300 2s0 200 1s0 100 sol 0.800 Figure 6. Stx Horizons of Real 
Data Recognlxed by New Process 177 SP CDP TRACE O.coo HIHIBh 0.500 150100130 1 50 lm -1 50 100 1s0 1s0 
m2s03003504004505m 200230300350400430 2m230W03304004w!m !im 3503006307W 350eoo3507m 3m3m3307w 7503000M 
7s03m 350 7!io 300350 013 m ela 1,000 H3AAUT( 1.500 2.000 2.600 3LM0 3s00 4.000 4.500 4.776 ~ 7. SyntMic 
Sebmk Data and Horizon, TRACE O.000 O6O1OO16O2OO26O 3oo So4m4s0600660600 660700760 m660913 0500 1.000 
1.500 2.WO 2s00 3.m 3.s00 4.000 4.300 4.776 Figum8. Thn?e Hor&#38;omofSyatbetk 178 Data Reco@mdby New~ 
 
			
