
 An Analytic Approach to Significance Assessment in Local Sequence Alignment with Gaps R. Bundschuh Department 
of Physics University of California at San Diego La Jolla, CA 92093-0319 U.S.A. E-mail: rbund@ucsd.edu 
 Abstract A detailed study of the Smith-Waterman alignment algo- rithm IS performed in order to find 
an analytical approach to the problem of assessing the statistical significance of lo- cal alignments 
with gaps. The significance is shown to be given m terms of an eigenvalue equation which captures the 
dynamics of the much simpler global alignment algorithm. This eigenvalue equation is then explicitly 
solved for a sim- ple scoring system and the resulting significance estimations are verified by a comparison 
to extensive numerical simula- tions Keywords: sequence alignment, statistical significance, Gum- bel 
distribution  Introduction Sequence alignment is one of the most commonly used com- putational tools 
of molecular biology. Its applications range from the identificatmn of the function of newly sequenced 
genes to the construction of phylogenic trees [34, 10]. There are two classes of alignment algorithms. 
The simpler gap- less alignment as it was implemented, e.g, in the origi- nal BLAST [1] is very fast 
and theoretically very well un- derstood However, in order to detect weakly homologous sequences, gaps 
have to be allowed in an alignment [26] which leads to the more sophisticated Smith-Waterman al- gorithm 
[29]. Both types of alignment algorithms have the drawback that they will find an optimal alignment and 
an optimal score for any pair of sequences --even randomly chosen and thus completely unrelated ones 
Thus, it is necessary to assess the significance of a resulting alignment. A popu- lax approach to this 
problem is to compare the score of the optimal alignment to the scores generated by the optimal alignments 
of randomly chosen sequences. This is quanti- fied by the p- or E-value. This comparison steadily becomes 
more important since with the increasing size of the databas- es the probability for obtaining a relatively 
large score just by chance increases dramatically. Pernllsslon to make digital or hard cople., of all 
or part of this x~ork for personal or classroom use )s granted without fee pro~,~ded that cop~es are 
not made or distributed fo~ profit ol commc~c)al ad,,antage and that cop~es bear this notice and the 
full c~tatton on the first page To copy otherw)se, to repubh~h, to post on servers or to redistribute 
to lists, rcquHcs prior specific perm)ss)on and/or a ti?e RECOMB 2000 Tokyo Japan USA Copyrtght ACM 2000 
1-58113-186-0/00/04 $5 00 In order to be able to quote a p-value the d~stmbutzon of optimal alignment 
scores for alignments of random se-quences has to be known. In the case of gapless alignment it has been 
worked out rigorously [18, 19, 20] that this distri- bution is a Gumbel or extreme value distribution 
[14]. It is characterized by two parameters which depend on the scor- ing system used and on the amino 
acid frequencies with which the random sequences are generated. For gapless alignment also this dependence 
of the two Gumbel parame- ters on the scoring system is completely known. For the case of gapped alignment, 
there is no theory which describes the distribution of alignment scores of ran- dom sequences. However, 
there is a lot of numerical evi- dence and heuristic arguments that the distribution is still of the 
Gumbel form [30, 8, 21, 32, 33, 2]. Nevertheless, even assuming the correctness of the Gumbel form it 
has turned out to be a very challenging problem to find the two Gumbel parameters for a given scoring 
system. The straightforward method is to generate a large number of alignment scores by shuffling the 
two sequences which are to be compared and take a histogram of this distribution. But, because of the 
slow exponentzal tail of the Gumbel distribution, this method is extremely time consuming. An alternative 
meth- od [33] which extracts more than a single score from each alignment of a pair of random sequences 
has the drawback of being rather complicated and inefficient in its implemen- tation and is m fact for 
this reason not recommended by its authors [15]. In practice, the two Gumbel parameters have to be pre-computed 
for some few fixed scoring systems [2, 3]. The necessity of pre-computmg the Gumbel parameters clearly 
becomes problematic, if adaptive schemes like, e g, PSI-BLAST [3] are being used. These schemes change 
their scoring system recurslvely depending on the sequence data they are confronted with and thus have 
to be able to find the two Gumbel parameters after each update of the scor- ing system from scratch. 
Another aspect which crucially depends on the real-time availability of the Gumbel param- eters is the 
assessment of the statistical significance taking into account the amino acxd composition of the individual 
sequences compared. Pre-computed values of the two Gum- bel parameters are only correct for sequences 
which follow the overall amino acid frequencies which have been used in the computation of the Gumbel 
parameters To remedy this problem, a more effective numerical meth- od which estimates the two Gumbel 
parameters has recently been proposed [25]. There are also some analytical approx- imations [22, 28, 
23] which are mainly valid for rather large gap costs where the influence of the gaps on the Gumbel pa- 
rameters is not yet too strong In this paper, we will present 86 a new analytical scheme to calculate 
the Gumbel parameter A which describes the tad of the Gumbel distribution. This scheme relies on a heuristic 
argument for the vahd~ty of the Gumbel form of the distrlbutmon itself but ~t is valid for any value 
of the gap cost. First, we will show, that although A ~s intrinsically a quantity characterizing local 
alignment It can be calculated from solely studying the much simpler global ahgnment algorithm Under 
some very moderate ap- prox~matmn we then reformulate the problem of finding A in terms of an eigenvalue 
equation which can be thought of as being a generalization of the elgenvalue equation for the case of 
sequences generated from a Markov model [19]. We then show the feasibility of our novel approach by cal- 
culating a closed formula for A which we show numerically to be very close to the real values over the 
whole range of gap costs. Since the Gumbel parameter A characterizes the more difficult tail of the Gumbel 
d~stributlon tt should be easy to extract the other Gumbel parameter characterizing its mean numerically 
from, e g., the island method [25], once ~k is known. Review of Sequence Alignment Sequence alignment 
algorithms come in different levels of sophmtmatmn The simplest alignment algorithm is gap-less alignment. 
It is not only extremely fast but also very well understood theoretically Thus, it has been very widely 
used, e g, m its implementation of the program BLAST [1] Gapless ahgnment looks for similarities between 
two se- quences ~ = ala2...aM, and b = bib2., bN of length M and N ,-. M respectively. The letters a~ 
and b~ are taken from an alphabet of size c. This may be the four letter alpha- bet {A, C, G, T} of DNA 
sequences or the twenty letter al- phabet of protein sequences A local gapless alignment .A of these 
two sequences consists of a substrmg a~_t+~ .. a~-~a, of length g of sequence ~ and a substrmg b~-t+l 
bj-lb~ of sequence b of the same length Each such alignment is l--1 assigned a score S[.A] = S(~,3, l) 
= ~-~k=os~,-k,b~-~, where s~,5 is some gwen "scoring matrix" measuring the mutual degree of similarity 
of the different letters of the alphabet A simple example of such a scoring matrix is the match- mismatch 
matrix I a=b 8o,b = (1) --# a~b which is used for DNA sequence comparisons [24] For pro- tein sequences, 
usually the more sophlstmated 20 x 20 PAM [9] or BLOSSUM matrices [16] are used The computatmnal task 
is to find the z, 3, and e which give the h~ghest total score  _= max S[A] (2) .4 for a given scoring 
matrix s~,b. The optimization task called for m gapless ahgnment can be easily accomphshed by intro- 
ducing an auxiliary quantity, S~,j, which is the optimal score of the above consecutive subsequences 
ending at (z,3) (op- timized over g ) It can be conveniently calculated in O(N 2) instead of the expected 
O(N 3) steps using the dynamic pro- gramming algorithm  S~,~ = max{S,_l,~_~ + s~,,b,, 0}, (3) with the 
initial condition So,k = 0 = Sk,o Once the S,,3 are calculated, the global optimal score is obtained 
as E = maxl <~<M,I<3~N ~,3 In order to characterize the statistical significance of the alignment, it 
is necessary to know the distribution of ~, for the gapless alignment of two random sequences, whose 
ele- ments a~'s are generated independently from the same fre- quencms p~ as the query sequences, and 
scored with the same matrix S~,b This distribution of ~ has been worked out rigorously [19, 20]. For 
suitable scoring parameters, it is a Gumbel or extreme value distribution given by Pr{~ < S} = exp(-~e-~S). 
(4) This distnbutmn Is characterized by the two parameters A and R with A giving the tail of the d~stribution 
and )~- ~ log describing the mean. For gapless alignment, these param- eters can be explicitly cMculated 
[19, 20] from the scoring matrix s~,b and the letter frequencies pa. For example, A is the unique positive 
solution of the equation (exp(As)) ~ E papb exp(Asa,b) = 1. (5) a,b The other parameter a is given by 
a ---KMN, where K is a more comphcated function of the scoring matrix and the letter frequencies Instead 
of revmwing the full derivatmn of the distribution Eq. (4) and its parameters, we will give some heuristic 
arguments which yield the known result These can later be generalized to the more relevant case of alignment 
with gaps For random sequences, one can take j = i m (3) without loss of generality Eq. (3) then becomes 
s,,, -s(i) = max{S(~ -1) + 8(i), 0}, (6) where the variables s(i) = s~,b are independent random vari- 
ables with the distribution Pr{si > s} = ~(a,bl~o,~>~}P~Pb The dynamics of the evolution equation (6) 
can be m two distract phases. The quantity whtch distmgmshes these two phases is the expected local score 
(8) = ~a,bpapbS~,b If It lS positive, the score S(i) will increase on average. Thus, the zero option 
m Eq. (6) can effectively be omitted in this case and the dynamms becomes a random walk S(z) = S(z -1) 
+ s(i) with an average upward drift (s). The maximal score will be close to the end of the sequences 
and will be gwen by ~ ~ N. (s). Since it is hnear m the length of the sequences, tMs is called the hnear 
phase of local alignment It is obviously not stated to Identify matches of subsequenees, and the d*stnbutlon 
of the maximal score ~ ~s a Gaussmn instead of an extreme value distribution The situation is dramatically 
different if (s) is negative In this case the dynamics is qualitatively as follows: The score S(z) starts 
at zero. If the next local score 8(i + 1) is negative -- which *s the more typical case in this regime 
-- then S remains zero. But if the next local score is positive,. then S will increase by that amount. 
Once it is positive, S(z) performs a random walk with independent increments s(z) Since (8) IS negative, 
there is a negatwe draft which forces S(i) to eventually return to zero After it is reset to zero, the 
whole process s~arts over again The qualitative temporal behawor of the score S(z) is depicted m Fig. 
1. ! Figure 1 Sketch of the total score as a function of sequence position m gapless local alignment 
From the figure, it is clear that the score landscape can be divided into a series of "zslands" of positive 
scores, sepa- rated by "oceans" where S = 0. Since each of these islands depends on a different subset 
of independent random num- bers s(2), the islands are statistically independent of each other. If we 
let the maximal score of the k th island be ak, then these ak are independent random variables. Calculat- 
ing the probability for the maximum score ak of an island of length L using the method of steepest descent 
and opti- mizing over the length L of the Islands, we asymptotically obtain a Poisson distribution Pr{ak 
> a} ~ C.e -~ (7) for the maximal island scores ak (see App A ) The param- eter A which gives the typical 
scale of the maximal island score is given by (5). Since the global optimal score E can be expressed 
by the maximal island scores as =max{o~}, (8) k the distribution of E can be calculated from the distribu- 
tion of the ak. The connection is covered by the theory of extremal statistics as developed by Gumbel 
[14, 13]. In the case of a large number K. of independent island peak scores each of which obeys the 
Poisson distribution Eq. (7), the connection is especially simple and we get Pr{E < S} = Pr{max{oi,..., 
ag. } < S} = Pr{ai < S} K (9) = (1 -C.e-XS) K* ,~,[exp(-C.e-XS)] K* =exp(-ae-XS), with a = K.C., i.e., 
the parameter )~ of the island peak score distribution Eq (7) is the same as the parameter A in the Gnmbel 
distribution Eq. (4) of the maximal alignment scores. In order to detect weak similarities between sequences 
separated by a large evolutionary distance, "gaps" have to be allowed within an alignment to compensate 
for insertion- s or deletions occurred during the course of evolution [26]. Here, we will specifically 
consider Smith-Waterman local alignment [29]. In this case, a possible alignment -4 still con- sists 
of two substrings of the two original sequences ~ and But now, these subsequences may have different 
lengths, since gaps may be inserted in the alignment. For example the two subsequences GATGC and GCTC 
may be aligned as GhTGC and GCT-C using one gap. Each such alignment .4 is assigned a score according 
to S[.4] = ~(~,b)~A Sa,b -- 5Ng where the sum is taken over all pairs of aligned letters, Ng is the total 
number of gaps in the alignment, and 5 is an additmnal scoring parameter, the "gap cost" Although in 
practical applications usually the more complicated afllne gap cost is used, we will in the following 
concentrate on this somewhat easier case. The task of local alignment is again to find the alignment 
.4 with the highest score as in Eq. (2), in this enlarged class of possible alignments. This can be very 
efficiently done by a dynamic programming method which becomes obvious in the alignment path representation 
[24]. In this representa- tion, the two sequences to be compared are written on the edges of a square 
lattice as the one shown in Fig 2(a) where we chose for simplicity M = N. Each directed path on this 
lattme represents one possible alignment. The score of this alignment Is the sum over the local scores 
of the traversed bonds Diagonal bonds correspond to gaps and carry the s- core -5. Horizontal bonds are 
assigned the similarity scores s(r,t) --s~,,% where a, and bj are the letters of the two sequences belonging 
to the position (r, t) = (z -3, z + 3 - 1) as shown in Fig. 2(a). This figure also shows the way we use 
the coordinates r and t to address points on the alignment lattice. The coordinate transformation from 
the base num- bers i and 3 to the "space" and "time" variables r and t will later turn out to be crucial 
for understanding the alignment algorithm as a "dynamic process" which in turn allows us to estimate 
the statistical significance. 'T~ '7) G A ................ (r,t)= ~(r,t)= f~t (0,0) T ~ (0,14) c ~)'<,-2~2"(r,0=( 
-3, i I )  a) C~ b) Figure 2. Local alignment of two sequences. (a) shows the alignment of CGATGCT 
and TGCTCGA represent-ed as a directed path on the alignment lattice" the diagonal bonds correspond to 
gaps in the alignment. The horizontal bonds represent aligned pairs. Alignments of identical lett- ers 
(matches) are shown as solid lines; alignments of differ- ent letters (mismatches) are shown dashed. 
The highlighted alignment path r(t) corresponds to one possible alignment of two subsequences, GATGC 
to GCT-C This path con- thins one gap. It Is also shown how the coordinates r and t are used to identify 
the nodes of the lattice. (b) is a sketch of some islands on the local alignment lattice. The lattice 
sites with a positive score are marked with dots. The bonds which have been chosen in the maximization 
process (11) are highlighted. Together they are the restricted optimal path associated with each point 
with a positive score Each of these paths goes back on an island initiation event which is marked by 
an open dot The large filled dots mark the positions of the highest scoring point on each island If we 
were interested in finding the highest scoring global alignment of the two sequences ~ and b, this corresponds 
to finding the best scoring path connecting the beginning (0, 0) with the end (0, 2N) of the lattice 
To find this path effec- tively, we define the auxiliary quantity h(r, t) to be the score of the best 
path ending in the lattice point (r, t) This quan- tity can be calculated by the Needleman-Wunsch dynamic 
programming algorithm [24] h(r, t + 1) = max{h(r, t - 1) + s(r, t), h(r 4- 1, t) -5} (10) If we are interested 
in local alignments, the same trick as In the gapless case (3) is used Cutting off unfavorable scores 
by adding the choice of zero in the maximum of Eq (10) leads to the Smith-Waterman algorithm [29] S(r,t+l) 
= max{S(r,t-1)+s(r,t),S(r:l=l,t)-5,0} (11) The score of the best local alignment is then given by E = 
max~,t S(r, t) In the presence of gaps, we can still dmtlnguish a linear and a logarithmic phase [31]. 
If the global alignment score tends to grow, the zero option of the local alignment algo- rithm does 
not play any role. We effectively revert to global alignment and get a maximum score which is linear 
in the length of the sequences Contrary to gapless ahgnment, ~t is not enough to have a negative expectation 
value of the local scores (s) in order to prevent this. Thin is due to the fact that the alignment algorithm 
uses gaps to connect ran- dom stretches of good matches to optimize the score The average score grows 
by a gap dependent amount u({sa,b}, J) faster compared to the expectation value (s) The log-hnear transmon 
occurs now at u({s~,b}, Jc) + (s) = 0 The loci of the phase transltmn (~c for ahgnment of random sequences 
is only known approximately [5] for the simple scoring system Eq. (1) If the parameters are chosen such 
that u + (s) < 0 the expected global alignment score drifts downwards on aver- age, then the average 
maxtmum score (~) is proportional to the logarithm of the sequence length as in the logarithmic phase 
of gapless ahgnment. The reduced value of (~) in the logarithmic phase makes it the regime of choice 
for the purpose of homology detectmn. Agmn, the distribution of must be known for local alignments of 
random sequences in order to characterize the statistical significance of local ahgnment There is no 
rigorous theory of this distribution in the presence of gaps However, there is a lot of empir- ical evidence 
that the distribution is agmn of the Gumbel form [30, 8, 21, 32, 33, 2]. The values of the parameters 
and A are only known approximately for a few cases close to the gapless limit [22, 28, 23] In practice, 
they have to be determined empirically by time consuming simulations Be-low we will present an explicit 
calculation of the parameter ), for a simple scoring system Significance Estimation using Global Alignment 
As a first and very crucial step, we want to show that ac* cepting the heuristics for the applicability 
of the Gumbel distribution the parameter A, which describes the tail of the Gumbel distnbutmn, can be 
derived solely from studying the much simpler global ahgnment (10) Later, we will de- rive an explimt 
formula by studying global alignment alone. Let us define the generating function ZL()t) ~-(exp[Ah(O, 
n)]) (12) where the brackets (-) denote the ensemble average over all choices of random sequences g and 
g and h(0, L) is the global alignment score at the end of a lattice of length L as shown in Fig. 3(a). 
It can be obtained from the recursion relation (10) with the initial condition h(2k, O) = h(2k + 1, 1) 
= 0. It will turn out that the parameter A of the Gumbel distribution is obtained from the condition 
hm Z~(~) = 1. Oa) L--~ oo Note, that thin condition reduces simply to Eq. (5) In the case of gapless 
alignment, since for infinite gap cost (f, we L/2 L have (exp[Ah(O, n)]) =(exp[A ~k=l s(0, 2k-1)]) =(exp[As])~- 
The key observatmn which leads to the result (13) is the fact that similar to the case of gapless Mignment 
discussed in the last section, the points on the ahgnment lattme can be grouped together as ~slands [25] 
By the constructmn of the local ahgnment algorithm (11), many points on the ahgn- ment lattme have a 
score of zero m the logarithmic ahgn- ment regime As for gapless ahgnment, a positwe score will be generated 
out of this "sea" of zeroes, if a good match occurs by chance This positive score can then imply fur- 
ther positive scores via the recursion relation (11) For every 2w-I ......... ~.-- m2 L 0 1 2 (a) (b) 
(c) Figure 3 Global ahgnment lattice used for significance esti- matron (a) shows the right half of the 
lattice from Fig. 2(a) It can represent all possible paths of length L which end at the point (r, t) 
= (0, L) and start at (r, 0) for an arbitrary r (b) shows such a path schematically. It represents the 
"rim" of an island with its high score denoted by the filled dot at the tip of the triangle. The open 
dot at (r0, to) represents the corresponding island imtlation event. (c) shows with the gray lines, how 
the triangular lattice similar to the one shown in (a) can be embedded into a rectangular alignment lattice 
of width 2W with periodic boundary conditions in the spatml (vertical) direction as long as L < W. point 
(r, t) on the lattice which has a positive score, we can define a restricted optimal path ~r,t(r), which 
is the high- est scoring path out of all paths ~(r) with an end fixed at ~'(t) = r; see the example in 
Fig. 2(a). The path must start at some point (r0, to) where a positive score is created out of the zero 
sea by a good match. An island is then defined to be the collection of points (r, t) with positive score, 
1 e, S(r,t) > 0, and whose restricted optimal path ~,~(r) orig- inates at the same point (ro, to). A 
sketch of these Islands is shown in Fig 2(b). Each of these islands has a maximum score which we denote 
by ak as we did in the gapless case By thin definition, every lattice point with a positive score belongs 
to exactly one island Thus, the maximal score on the total lattice is given by Eq (8) Since large islands 
are well separated by a sea of points with score zero, they can be treated as statistically independent 
clusters on the alignment latrine 1. Thus, their maximal scores ak are again independent identically 
distributed random variables which yield a Gumbel distribution of E via Eq. (9). Our task is thus to 
calculate the distribution of the island peak scores akm the presence of gaps. This distribution of maximal 
island scores can be de- rived heuristically analogously to the gapless case (App. A ) Within an island 
we can neglect the lower cutoff 0 in the local alignment algorithm (11) Thus, an island with gaps corresponds 
to a global gapped alignment of some length L as the one shown schematically in Fig. 3(b) Analogous to 
the gapless case the length L of this island has to be opti- mized for each given peak score value a. 
Then, the island peak distribution again has an asymptotmally Poissonlan form (7) with the decay constant 
A given by Eq. (13) The conditmn lim/.+oo(exp[)~h(0, L)]) = 1 can be understood as being the choice for 
A where the exponential enhancement exp[Ah(0, L)] of events with h(0, L) > 0 exactly balances the exponential 
rareness of these events m the calculatmn of the expectation value (exp[)~h(0, L)])  4 Global Alignment 
as a Dynamic Process From now on we will only study global alignment as de-scribed by Eq (10) and finally 
use Eq (13) to infer the 1 The independence of the peak scores of large islands has also been verified 
numerically [25] value of the parameter A characterizing local alignment In order to simplify the discussion 
we will make three assump- tions on the scoring parameters Sa,b and 5. First, the differ- ences between 
the possible values sa,b of the scoring matrix have to be multiples of some score unit A This holds for 
nearly any practically used scoring system. For the match- mismatch scoring system as given by Eq (1) 
it is trivial with A = 1 + ~u. Protein scoring systems on the other hand usually consider for performance 
reasons only integer scores which automatically yields A = 1 as the score unit. Addi- tionally, the maximal 
entry so -- max~,b{S.,b} of the scoring matrix S~,b is of special importance We will only consider the 
discrete set of gap costs 5 satmfying 2(I = nma~A -- SO with nmax E N (14) In the case of protein sequence 
alignment, Eq. (14) is nat- urally satisfied, since (i and so are usually chosen as integer numbers and 
A = 1 For other scoring systems, the non integer case can in principle also be treated but becomes more 
complicated. Moreover, even if )~ is only known for the discrete values of ~ in Eq. (14), an interpolation 
should still give reasonable results for arbitrary gap costs [5]. Finally, we will neglect correlations 
between the local scores s(r,t), which arise from the fact that all M x N lo- cal scores are generated 
by the M + N randomly drawn letters. Instead of taking these correlations into account, we will introduce 
uncorrelated random variables y(r, t) E {0, 1,... ,nmax} such that s(r,t) =_ so -rl(r,t)A, i.e., Pr{V~,t 
rl(r,t) = ..,t} = H Prl~?(r,t) ----.~,,} (15) r,t with er{r/(r,t) = rl} = ~.a,bp.pbS..,b,~o_.A. The approxi- 
mation (15) is known to change characteristic quantities of sequence alignment only slightly. We will 
confirm numeri- cally at the end of this abstract, that this also holds for the values of )~ which we 
are mainly interested in here. Additionally, we will use instead of the triangular align- ment lattice 
as shown in Fig. 3(a) a rectangular lattice of a fixed width of 2W lattice points as shown in Fig 3(c). 
Across the lattice we apply periodic boundary conditions, i e, we identify h(0,t) and h(2W, t) for all 
t. At the left we start with the initial conditions h(r, t = 1) --- 0 for even r and h(r,t = O) = ~ for 
odd r The properties of global alignment for very long sequences naturally do not depend on the details 
of this choice of initial conditmns, but these values will turn out to be especially convenient This 
choice of the lattice is possible, since we can easily convince our- selves that the score h(r, t) for 
all points with t < W will be identical with the corresponding score on the triangular lattice shown 
in Fig. 3(a) which can be seen as a sublattice of the rectangular lattice At the end of our calculations 
we will take the limit of infinite W. Now we will reformulate the sequence alignment algo- rithm Eq (10) 
on the lattice shown in Fig. 3(c) step by step and transform condition (13) into an eigenvalue equation 
similar to the equation for ~ given m [19] for the case of protein sequences generated by a Markov process 
instead of independently chosen amino acids. First, we will introduce the score dz~erences between neighboring 
lattice points as new variables We will parameterize these score differences by the bond variables n(r, 
t). With the choice of coordinates as illustrated In Fig 4(a), we define them to be {-~[h(r+l,t)-h(r,t+l)+5+so] 
r+t even (16) n(r't)=---~[h(r+l,t+l)-h(r,t)+~] r+t odd n(r,*-I)= h(r+l't~l, n(r.O= ." .: ~ ~ ~ ~ " i 
~ ~ ~ ~ h( ,,,)-h(r~O..(f~)-h(r,,+,)+, n,~_nl h(r,t-I)~ /h(r,t+l) n½-l__~n 2 n(r-I,(-I )= ~ /~r-l,t)=h(rJ-l)-h(r-l,t)+l 
X,O/ h(rJ÷l)-h(r-l,t) h(r-l,t) ........ t (a) (b) (c) Figure 4: Building blocks of the alignment lattice. 
By our numbering scheme of the lattice r and t are either both even or both odd. (a) shows the scores 
at the lattice points and the bond variables n(r, t). (b) shows this building block as an "device", which 
takes two incoming bond variables ni ! and n~ and transforms them into the new bond variables ni and 
n2. (c) shows schematmally how these building blocks are "connected" in the alignment lattice of Fig. 
3(c). Their intereonnection into a layered structure as shown here with a shifted pairing scheme in every 
time step leads to the non- trivial behavior of sequence alignment. The important feature of these quantities 
is, that the evolution equation (10) can be completely rewritten in terms of these bond variables without 
reference to the absolute scores h(r, t). Since the lattice is composed of the building blocks shown 
in Fig. 4(a), the recursion equation transforms pairs of neighboring n(r, t) at some t - 1 into the same 
pairs at time t. The detailed calculation is shown in App. B For even r + t which corresponds to Fig. 
4(a) the result is n(r--l,~) = n(r --l, t --1) --j(r, t) (17)  n(r,t) = n(r,t--1)+3(r,t) where r + t 
is even and j(r, 1~) _~ mlll{17(r , ~), nma x -n(r, t -1), fl(T -1, t)} (18) By induction it is obvious 
from these equations, that the variables n(r, t) will always remmn integer numbers between 0 and nmax, 
if they are integers at t = 0 as it is the case for our choice of initial conditions 2. The transformation 
of a pair of variables (n(r -1, t -1), n(r, t -1)) into a pmr of variables (n(r-1, t), n(r, t)) happens 
according to the lattme structure shown in Fig. 3(c) at odd t for all odd r and at even t for all even 
r We can thus think of the dynamics in terms of the variables n(r, t) as a network of elements of the 
form shown in Fig. 4(b) acting on pmrs of variables n(r, t) interconnected m the way schematically depicted 
in Fig. 4(c). This process is also known [6] as an asymmetric exclusion process which is a well studied 
model for surface growth and highway traffic [17, 27] In reducing the dynamics from a dynamms of scores 
in- to a dynamics of the bond variables n(r, t) one has to pay attention to the boundary conditions. 
Periodic boundary conditions for the score differences n(r, t) turn out to lead to meaningful periodic 
boundary conditions h(0, t) = h(2W, t) for the scores only under the additional constraint 2W--1 Z n(r,t) 
= Wnma× (19) 2Even if the mitlM values of the n(r,$ = 0) are not integer they will under the dynamics 
Eqs (17) and (18) eventually try to take on values less than zero or larger than nmax The minimum m Eq 
(18) then resets them to the integer values zero or nmax Thus, after some startup phase, the n(r, ~) 
will be integer even if their mztlal values are chosen to be non-integer Since the quantity on the left 
hand side is obviously con- served under the dynamics Eqs (17) this will not be an issue, if the initial 
conditmns are chosen m accordance to Eq (19) So far, we transformed the dynamics of the sequence alignment 
algorithm as given by Eq (10) We still have to express our main quantity of interest, (exp[Ah(0, N)]) 
in terms of the dynamics of the variables n(r, t) This can be done again by explicitly expressing the 
change of h(0, N) under the dynamics given by Eqs (17) and (18) The detmls of this calculation are worked 
out in App. B. It yields (exp[)~h(0, N)])o = exp[~soN/2](exp[--~AJ])o, (20) where ( )0 denotes the average 
over the independent random variables z}(r, t) and N/2 W--1 1 J=- 2-WE E b(2k +1,21-1) + 3(2k'21)]" (21) 
/=I k~0 In order to be able to calculate A from conditions (13) we thus have to determine the generating 
function (exp[wJ])o of d As it is worked out in App C this generating function can be expressed by the 
Nth power of some generalized transfer matrix. Its behavior for large N is thus given by the largest 
eigenvalue pw(w) of this generalized transfer matrix. The transfer matrix is built from the (nmax + 1) 
2 dimensional matrix Tx (w/W) which describes the contribution to J from each of the elements as the 
one shown in Fig 4(a). Its matrix elements are given by (TI)(.~,.2),(.;,%)(-~)=-~. Pr{~/(r, t) = rl} 
x (22) x~.~ ,,q -3(,q ,.~:,,,7)6-2 ,,~:.+~ (,~;. ,-; ,.)e=:WJ('q ,'~,'~) with 3(n~,n~,~}) = mm{~},n~,n~x 
- n~}. For w = 0 this reduces to the usual transfer matrix which just contains the probabilities, that 
the configuration (n~, n~) of two neigh- boring lattice sites is transformed by Eqs. (17) and (18) into 
the configuration (nl, n2). Since at each time step W of the elements shown in Fig 4(a) act in parallel, 
W of these matrices have to be multiplied together as Tw(w) = (~w=l TI(w/W). Addi- tional to this matrix 
we need the matrix C which shifts all the variables n(r, t) from r to r+l, l e , qnonl . n2w-1) =--- 
InI . n2w-ino) With these definitions, the generating function of J at a given width of the lattice W 
turns out to be given by (exp[wJ])o -----[Pw(w)] g (23) in terms of the largest elgenvalue pw (w) of 
the matrix Tw (w)C restricted onto the space of vectors [¢} fulfilhn6 condition (19) and being translationally 
lnvarlant, i e, fi~[¢) = [¢) If we know the large width hmit p(w) -- llmw-~oo pw(w) of this largest elgenvalue 
we can use Eqs (13), (20), and (23) in order to calculate A from the condition p(--AA) exp[Aso/2] = 1 
(24) Additionally, the typical slope a of an island which is impor- tant for taking into account the 
effects of different sequence lengths is according to App. A given by a* = so -- 2Ap'(-AA)exp[Aso/2] 
(25) 5 Results for a Simple Scoring System Since finding the largest eigenvalue of the matrix CT(w) for 
a general scoring system is a rather difficult task, we will now restrict ourselves to an especially 
simple case We will use the scoring matrix for DNA sequence comparisons as defined in Eq. (1), which 
implies so = 1 and A = 1 + # Moreover, we will use the mimmal 3 gap cost value 6 = #/2. This choice of 
scoring parameters implies nmax = 1 One important special case of this scoring system is the longest 
common subsequence (LCS) problem [7] for # = 6 = 0 which has been of interest to mathematicians for a 
long time If we denote by p the probability for a match, e.g, p = 1/c for an alphabet of size c with 
equal probabilities for all letters, the basic matrix TI(w[W) is given by l 1 0 0 0) Ti(w/W)= 0 1 (1-p)e 
~r 0  (26) 0 0 p 0 0 0 0 1 in the basis 100), 101), 110), Ill) The largest elgenvalue of the corresponding 
matrix Tw(w)C can be calculated for small widths W using computer algebra. Generalizing the result to 
arbitrary W as explained m App. D yields p(w) = lira pw(w)= (27) w-~oo 1 + vr~e~ r Eq (24) then leads 
to the condition 1 + V~exp[}(1 + #)1 )~ [ _ 1 1 (28)  1 + vgexp[-}(1 + Z)] expl- ~Zj For large values 
of the mismatch (and gap) cost # it con- verges towards the value )~ = -logp which is to be expected 
from Eq. (5) m the gapless limit. Moreover, since ~ = 0 is always trivially a solution of this equation, 
the implied val- ue of A tends towards zero, if the derivative of the left hand side vanishes. A vanishing 
A corresponds to a breakdown of local alignment (all island sizes are equally probable) and indicates 
the phase transition between the logarlthmm and the linear alignment phase Equating the derivative of 
the left hand side of Eq. (28) to zero, correctly reproduces the exact result #c = 2x/p/(1 -v~) for the 
mismatch cost at which the phase transition takes place under the assump- tion (15) of uncorrelated disorder 
[5]. Expanding Eq. (28) for small A yields that ~ vanishes proportional to (#-#c) 1/2 as # approaches 
its critmal value #c as it has been predicted already on more general grounds in [11] In order to test 
the approximation of uncorrelated local disorder (15) and the heuristic elements of the denvatmn of Eq 
(28), we performed extensive numerical simulation- s to corrobate our result We used the DNA alphabet 
of size c -- 4 with identical frequencies for all four letters, I e, p = 1/4 For different choices of 
the mismatch cost # with corresponding gap cost 5 = #/2, we used the island meth- od [25] to find the 
values of A as a function of # numerically For each value of 6 several billion islands have been gen- 
erated using sequences of N = 25,000 in order to achieve relative errors of approximately 1% We used 
completely uncorrelated local scores chosen to be one with probability 3For any smaller gap cost ~ < 
#/2 two gaps become favorable compared to a mismatch Thus, the ahgnment does not depend on the mismatch 
cost # any more and is eqmvalent to the case where is adjusted to fulfill 5 = 2#. p and -/~ with probability 
1-p. The resulting values of A are shown in Fig. 5 The solid hne is the solutmn of Eq (28) and the circles 
represent the values of ,k for uncorrelated local s- cores (15) As shown in Fig. 5 the observed ,Vs follow 
the analytic solution very closely, thereby confirming Eq (28). We also included the values of A which 
result from corre-lated local scores generated from aligning randomly chosen sequences according to Eq 
(1). As one can see, they devi- ate only slightly from the analytical result for uncorrelated disorder. 
This deviation is strongest close to the log-linear phase transition, which for uncorrelated disorder 
happens at # = 2. The difference of ~ 2% in pc between the correlated and the uncorrelated case rapidly 
becomes much smaller for larger alphabet sizes c [4] 1.5 1 0.5 O , , I , 0 1 2 3 4 5 6 7 8 g=2~i Figure 
5. Dependence of the signfficance parameter A on the scoring parameter p. The circles represent the numerical- 
ly obtained values of A for uncorrelated local disorder (15) with match probability p = 1/4 for whmh 
Eq (28) (the solid line) has been derived. They agree well with the analytical result. The dmmonds correspond 
to local disorder gener- ated by comparing two randomly chosen sequences over an alphabet of size c = 
4 The values of ~ obtained from the two ensembles differ from each other only very close to the phase 
transition point pc. Concluding Remarks We have shown, how the important problem of assessing the statistmal 
significance of local Smith-Waterman alignments can be solved by studying the simpler global alignment 
algo- rithm Using the approximation of uncorrelated local simi- laxity scores we have reformulated the 
problem of finding the Gumbel parameter ), m terms of an exphcit eigenvalue equa- tmn. We have demonstrated 
the feasibility of this approach by deriving an explicit formula for A for a simple scoring system and 
we have numerically verified that the expressmn for )~ obtained under the approximation of uncorrelated 
lo- cal similarity scores describes the real &#38;stributmn of optimal alignment scores of random sequences 
very well While we demonstrated the feasibility of our approach here for the s~mplest possible scoring 
system, it is neces- sary to solve the eigenvalue equation presented m thin work for more general scoring 
systems. If an analytic solution is possible this would allow the instantaneous calculation of A for 
any scoring system and arbitrary amino acid frequencms Even if the solutmn of the elgenvalue equatmn 
becomes more and more difficult analytmally, it is still possible to compute the necessary e~genvalue 
numerically for systems of fimte width Since the largest elgenvalue numerically seems to converge rather 
fast to its infinite width limit this should still give reliable values for the parameter A Empirically 
it seems that systems with a width of W = 4 already give very good results for ), although a detaded 
numerical study of this issue still has to be performed. For general scoring systems the corresponding 
matrices become rather big very fast but the specffic type of coupling between neighboring bond variables 
should make very effective numermal meth- ods developed to study one dimensional quantum systems like, 
e g, the density matrix renormalization group method, applicable. Moreover the derivation should be extended 
to the case of affine gap costs which would further increase the complexity of the eigenvalue equation 
through a replacement of each bond variable by three coupled bond variables Even if it turns out that 
in the general case the numerical solutmn of the eigenvalue solutmn is not faster than the determina- 
tion of ), by direct simulatmn, the approach presented here is a mathematmally precise conjecture for 
the value of A and may be the basis of a rigorous theory of the significance as- sessment of local sequence 
alignment with gaps usign large deviatmn theory. Acknowledgments The author gratefully acknowledges 
dmcussions with S. Alt- schul, T. Hwa, R. Olsen, N. Rajewsky, and J. Spouge, and the hospitality of the 
Center for Studies in Physms and Bi- ology at Rockefeller University and the National Center for Biotechnology 
Information where this work has been com-pleted. This work is supported in part by a Hochschulson- derprogramm 
III fellowship of the DAAD and by the Nation- al Scmnce Foundation through Grant No DMR-9971456  References 
<RefA>[1] Altschul, S.F., Gish, W., Mdler, W, Myers, E W, and Llpman, D J 1990. Basic Local Alignment Search 
Tool J. Mol. BzoL 215, 403-410. [2] Altschul, S F., and Gish, W 1996. Local Alignment Statistics. Methods 
m Enzymology 266, 460-480 [3] Altschul, S F., Madden, T.L, Schhaffer, A A, Zhang, J., Zhang, Z., Miller, 
W., and Lipman, D.J. 1997. Gapped BLAST and PSI-BLAST: a new generation of protein database search programs. 
Nuclezc Acids Research 25, 3389-3402. [4] Boutet de Monvel, J. 1999 Extenswe Simulations for Longest 
Common Subsequences Europ. Phys J. B 7, 293-308. [5] Bundschuh, R, and Hwa, T 1999. An Analytm Study 
of the Phase Transition Line in Local Sequence Align- ment with Gaps. Proceedings of the Thzrd Annual 
Inter- natzonal Conference on Computatzonal Molecular Bzol- ogy, S Istrad et al. eds, 70-76, ACM press, 
(New York, NY); Bundschuh, R., and Hwa, T., to appear in Dzse Appl Math. [6] Bundschuh, R 1999 The Asymmetrm 
Exclusion Pro- cess and the Extremal Statistics of Random Sequences in preparation. [7] Chv£tal, V., 
and Sankoff, D 1975 Longest common subsequences of two random sequences J. Apphed Probab. 12, 306-315. 
 [8] Collins, J F., Coulson, A.F W, and Lyall, A. 1988. The significance of protein sequence similarities 
CABIOS 4, 67-71 [9] Dayhoff, M O, Schwartz, R.M, and Orcutt B.C. 1978. A Model of Evolutmnary Change 
m Proteins In Atlas of Protein Sequence and Structure, Dayhoff, M O, and Eck, R.V., eds., 5 supp 3, 345-358 
[10] Doohttle, R.F 1996. Methods ~n Enzymology 266, San Diego, Cahf.. Academic Press [11] Drasdo, D., 
Hwa, T., and L~isslg, M. 1998. A statmtical theory of sequence ahgnment with gaps. Proceedings of the 
Szxth Internatzonal Conference on Intellzgent Sys- tems for Molecular Bwlogy, J. Glasgow et al., eds., 
52- 58, AAAI Press, (Menlo Park, CA) [12] Fisher, D. 1999 Private communicatmn. [13] Galambos, J. 1978. 
The Asymptotzc Theory of Extreme Order Statzst~es, John Wiley &#38; Sons, (New York, NY). [14] Gumbel, 
E.J. 1958. Statzstzcs of Extremes, Columbia University Press, (New York, NY) [15] Hardy, P., and Waterman, 
MS. 1997. The Se-quence Alignment Software Library at USC. From http ://w~-ht o. usc. edu/software. [161 
Hemkoff, S , and Henikoff, J.G. 1992. Amino acid sub- stitutmn matrices from protein blocks. Proc. Natl. 
A- cad. Sci. U.S.A. 89, 10915-10919. [17] Kandel, D., Domany, E., and Nienhuis, B 1990. A six- vertex 
model as a diffusion problem -derivatmn of cor- relatmn functmns. J. Phys. A 23, L755-L762. [18] Karlin, 
S., and Altschul, S.F. 1990 Methods for as-sessing the statistical significance of molecular sequence 
features by using general scoring schemes. Proc. Natl. Acad. Scz. U.S.A. 87, 2264-2268. [19] Karlin, 
S., and Dembo, A. 1992. Limit distributmns of the maximal segmental score among Markov-dependent partml 
sums. Adv. AppL Prob. 24, 113-140. [20] Kaxlin, S., and Altschul, S F. 1993 Apphcations and s- tatistics 
for multiple high-scoring segments in molecular sequences Proc. Natl. Acad. Scz U.S.A. 90, 5873-5877 
[21] Mott, R. 1992. Maximum likelihood estimatmn of the statistical distribution of Smith-Waterman local 
se-quence similarity scores. Bull. Math. Bzol. 54, 59-75. [22] Mott, 1~., and Tribe, R. 1999. Approximate 
statistics of gapped ahgnments. J. Comp. Bzol. 6, 91-112. [23] Mott, R. 1999 Accurate estimate of p-values 
for gapped local sequence abgnment. Private communication [24] Needleman, S B, and Wunsch, C D 1970 A 
general method applicable to the search for similarities in the amino acid sequence of two proteins. 
J. Mol. Bzol. 48, 443-453 [25] Olsen, R, Bundschuh, R, and Hwa, T. 1999 Rapid Assessment of Extremal 
Statistics for Gapped Local Ahgnment. Proceedings of the Seventh Internatwnal Conference on Intellwent 
Systems for Molecular Bzol- ogy, T Lengauer et al., eds, 211-222, AAAI Press, (Menlo Park, CA) [26] Pearson, 
W.R. 1991. Searching protein sequence h-branes, comparison of the sensitivity and selectivity of the 
Smith-Waterman and FASTA algorithms Ge-nomzcs 11, 635-650. [27] Rajewsky, N, Santen, L., Schadschnelder, 
A., and Schreckenberg, M 1998. The asymmetrm exclusion pro- cess Compaxmon of update procedures. J. Star. 
Phys. 92 151-194. [28] Smgmund, D., and Yakir, B. 1999. Approximate p- values for Sequence Alignments 
preprint [29] Smith, S.F, and Waterman, M.S., 1981. Comparison of biosequences Adv. Appl. Math. 2, 482-489 
[30] Smith, T F., Waterman, M.S., and Burks, C. 1985 The statistical distribution of nucleic acid similarities 
Nu-clezc Aczds Research 13, 645-656 [31] Waterman, M.S., Gordon, L., and Arratia, R. 1987 Phase transitions 
in sequence matches and nucleic acid structure, Proc. Natl. Acad. Scl U S.A. 84, 1239-1243. [32] Waterman, 
M.S., and Vingron, M. 1994. Sequence Comparison Significance and Poisson Approximation Star. Sc~. 9, 
367-381. [33] Waterman, M.S., and Vingron, M. 1994 Rapid and ac- curate estimates of statistical sigmficance 
for sequence database searches. Proc. Natl. Acad. Scz. U.S.A. 91, 4625-4628. [34] Waterman, M.S. 1994. 
lntroductwn to Computatzonal Bwlogy. London, UK: Chapman &#38; Hall.</RefA> Appendix A" Island High Score Distribution 
In this appendix we derive heuristically the Poisson distri- bution of maximal island scores. We first 
treat the gapless case [12] and then generalize the derivation to alignment with gaps. In the gapless 
case the distribution of large is- lands of length L measured from their begmmng to their peak point 
at height a is by definition given by L p(alL) = (5(a -Z s(z))) (29) Using the Fourier representation 
of the delta function and the statistical independence of the s(i) this yields 1/ p(a[L) = ~ exp(-ika)(exp(zks))Ldk 
(30) For a given peak score a this probablhty is maximal at a certain length Lo(cr). It is reasonable 
to assume that the distribution of island lengths at a given peak score a is suf- ficiently peaked around 
the length Lo(a) at which the prob- ability is maximized. Thus, the probabihty of finding an roland with 
peak score a with any length as dominated by the probability of finding an island of length Lo(a). If 
we further assume that this length is proportional to the peak score, 1 e , Lo(a) = a-lo ", we get c~--lG 
p(a) ... / exp(-zka)(exp(,ks)) dk (31) For large a, Eq (31) can be evaluated via the method of steepest 
descent as p(a) ,~ exp(-Aa) w]th A = ,k* ((~) - log[(exp(,k* ((~)s))]/a (32) The saddle point k* ((~) 
as given by the saddle point equatmn (s exp(ik* ((~)s)) = 1. (33) (exp( ik* ( a )s ) )c~ The slope ct 
of a typical island is so far unknown. It is fixed by the requirement that it maximizes the probabihty 
to find an island of the given peak score a. Thus, we mimmize Eq. (32) with respect to (~ and get together 
with Eq. (33) (exp(~k* (c~*)s)) = 1. Inserting this into Eq. (32) yields con- dltion (5). Additionally 
we get from Eq. (33) the typical slope o~* of an mlaad as 0¢* --- (s exp(As)). It is related to the relative 
entropy H of the scoring system by H = A(s exp(As)) = A~* (34) which is the crucial quantity for the 
correction of the se-quence length dependence of the statistical significance [2] For alignment with 
gaps, the high score of an island of length L from its beginning to its peak point is not just the sum 
of local scores any more. Instead, it is given by the final score h(0, L) of a global alignment of two 
sequences of length L on a triangular lattice as the one shown in Fig. 3(a) taking into account all possible 
insertions of gaps. We can still use the Fourier transformation to get = ~--~[ e-~k~(e'~h(°,L))dk. (35) 
p(alL) = (5(a -h(O, L))) l In App. C we will see, that (exp(),h(0, L))) is for large L the L'th power 
of the eigenvalue of some matrix. We thus define ~(A) by (exp[Ah(0, L)]) = ~L(x) and again assume a linear 
slope cr of the islands where the trmngular shape of Fig. 3(a) with only L/2 matches or mismatches at 
the central line r = 0 makes the definition a --(~Lo(a)/2 the most natural defimtion for c~. Eq. (35) 
then becomes p(a) ~ / exp{[-ik + 2t~ -1 log'p(ik)la}dk (36) Applying as in the gapless case the method 
of steepest de- scent and maximizing with respect to the slope of the island (~ ymlds Eq. (13). Moreover 
it gives the typical slope of an roland as t~ = _ ~(A) = (h(0, L) exp[Ah(0, L)])) (37) " ~(~) L Appendix 
B: Expression of the score dynamics in terms of the bond variables In this appendix we will derive the 
evolutmn equations (17) and (18) from the recursion equation (10) of the original global alignment algorithm 
To this end we apply Eq. (10) to the definition of n(r, t), where we assume by convention that r + t 
is even as in Fig. 4(a). We get n(r, t) = lth(r+l, t)-h(r, t+l)+~+so] = -~[h(r+l,t)+8+so- max{h(r, t-1)+so-71(r, 
t)A, h(r=l=l, t)-(i}] = l[h(r+l,t)-h(r,t-1)+~- -max{-r/(r, t)A, h(r :t: 1, t) -h(r, t-l) -so -(i}] = 
n(r, t- 1)+min{~/(r, t), n(r- 1, t- 1), nma~-n(r, t- 1)} The equation for n(r-1,t) follows completely 
analogously and with the definitmn Eq (18) this yields Eq. (17). In a similar way we can express the 
quantity (e;~h(0'N))0 in terms of the variables n(r, t). To achmve this, we first define for any "time" 
t the average score 1 w-1 h 2k h(t) =f~-W)-~k=°x [ ( ,t-1)+h(2k+l,t)] t even (38)(2~ Ew£1[h(2k, t)Wh(2k+l,t-1)] 
t odd Because of the translational mvariance of the system m the spatial (r) &#38;rection we get (exp[Ah(0, 
N)])o = (exp[Ah(N)])o. (39) Thus, we can restrict ourselves to calculating the large N behavior of the 
latter quantity. The change m the average score h(t) is given by h(t + 1) - h(t) = (40) = ~1 )-~w=~lth(2k, 
t+l)_h(2k, t_l) ] t even [,~-~ ~_,7_~lth(2k+l,t+l)-h(2k+l,t-1)] t odd. The local score differences in 
this equation can for even r + t be expressed as h(r, t + 1) - h(r, t -1) = so - j(r, t)A (41) by a calculation 
analogous to the one used at the beginning of this appendix to obtain n(r, t) Inserting this into Eq. 
(40) yields -~(t+l)_-~(t)=so A ~W_-olj(2k,*) teven (42) 2 2W [)'~w__~13(2k+l,t ) t odd. Combining Eqs. 
(39) and (42) finally yields N--1 x ~ (~(t+l)-~(t)) (eXh(°'N))0= (e~(N))0 = (e t=o )o (43) N/2 W-- 1 
--~ E E (J(2k+1,21--1)+j(2k,21)) = e),SoN/2(e t=l ~=o )0 = e~oN/2(e-~J)o ' with J as defined in Eq. (21). 
 Appendix C: An eigenvalue equation In this appendm we will reformulate the calculation of the generating 
function (exp[wJ])o as an elgenvalue problem We start from the defimtion N/2W--1 (exp[wJl)° = (H H e~frJ(2k+l'2l-1)e~rJ(2k'21))O 
(44) l=l k=O Since, the values of the variables n(r, t) must be integers between 0 and nmax at any time, 
we do not change the expectation value, if we introduce ones of the form 2W--1 1--Z II .... ,o--- Z {n~.to}~{o, 
,nm,,,,}2Wr=0 {n~.t0}e{0,,nm~,,}2W at each fixed t~me t This ymlds (exp[wJ])0--E "'" E Rw(N'{nmt}) (45) 
{~r,O} {r~e,N } w~th 2W--1 N/2 Rw(N, {n~,t}) -----(H 5~(~,o) .... 0 II Dw({nmt}' 2/-1)x r=0 /=1 ×(1-I~ 
,¢~+1,~'-I Dw({n~,t},21) 1 e :y-~'(zk'~ o \ k=0 / \ k=0 / Once a configuration n(r, t) at each t~me step 
is fixed, the expectation value can be factorized into the parts which con- taln only a single random 
variable y(r, t) 2W--1 N/2W--1 r=0 l=l k=O )~£ - ~-"~r3 (2k+1, 21-1 ) on(2k+l,2l_2),n2k+l,2l_ 2 ¢:.~" 
X X Sn( 2k,21--1),nT 2k,21--15n( 2k,21-1),n2k + l,21_ l )0 X X H (6n(2k--1'21--1)'n2'~-1,21-1 s: un( 
2k,21--1),n2k,2~_ l ~'~3(2k,21) k=0 5n( 2k-- l,21),n2k_l,21 6n( 2k,21),n21~+ l,2z )0 X1. Inserting this 
into Eq (45) we can interpret the summation over the possible configurations of the n(r, t) at each time 
step as the summation of inner indices in a matrix multipli- ll2W-1 cation. In this language the first 
term , ,~=o 8~(~,0),~,o is a vector on the (nma~ + 1) 2w dimensional vector space in- dexed by all possible 
configurations. This vector has exactly one non vanishing entry at the configuration which is cho- sen 
as the initial configuration at t = 0 Th~s non vanishing entry is one and we call this vector [¢o). The 
factor of one which we added for the sake of clarity also plays the role of a vector the entries of which 
are all one It stands for the summation over all possible final configurations at t = N and we call this 
vector (¢1{ All the other factors represent matrices They can be written as tensor products of the (nm~x 
+ 1) 2 dimensional matrix TI (w/W) which describes an elementary process as given by Eqs (17) and (18). 
We can read off ~ts elements to be (T1 (w/W))(~,~:),(~ ,.~) (w) - , , ~v~(~,t) (5:~(~- __ 1 ,~-- 1),R 
1 5n(r,t -- I),n 2 e 5~(r - 1 ,t),R1 5~(r, t ) ,n2 )0- Note that the disorder average for each of these 
matrix el- ements is only an average over the single random variable r/(r,t). The matrix elements can 
thus be rewritten m the form given in Eq. (22). Since the lattme of width 2W is at each time step decom- 
posed into W of the budding blocks described by T1 (w/W), the total system is described by the matrix 
W even @ Tw (w) -- Tw(w) --T1(w/W) (46) k=l If Tw (w) describes the time evolutmn at even time steps, 
we can according to Fig. 4(c) generate the time evolution on odd time steps by shifting all variables 
to the right, applying the dynamics of even time steps and then shifting all variables back to the left. 
With the translation matrix C defined in the main text this can be written as T~-d(w) = CTw(w)C -1 The 
structure of the latrine as depmted by Fig 4(c), finally leads to (exp[wJ])o = (¢11 (T~en (w)T~4~d (w)) 
N/2 I¢0 ) (47) = (¢ll(Tw(w)CTw(w)C-')g/21¢o) In the hmit of large N this obviously becomes Eq. (23) of 
the main text where p~ (w) is the eigenvalue of the matrix Tw(w)CTw(w)C -1 with the largest real part 
Since this matrix has no negative entries and is (restricted to the sector defined by condition (19)) 
for non-pathologmal chomes of the scoring matrix irreducible, the largest eigenvalue of this matrix is 
guaranteed to be non degenerate, real, and its eigenvector can be chosen without negative entrms by the 
Perron Frobenius theorem. Due to the lattice symmetry, the eigenvector I¢) for the largest ogenvalue 
of Tw(w)CTw(w)C -1 should be transla- tionally invariant, i.e., C21~b) = I~) should hold. We can thus 
restrict the search for the largest eigenvalue to the subspace C -- {1¢)1C~{¢) = I¢)} (48) of all translatlonally 
invariant eigenvectors On this sub- space by defimtion C = C -1 so that instead of looking for the largest 
eigenvalue p~(w) of Tw(w)CTw(w)C -l we can also look for the largest eigenvalue pw(w) of Tw(w)C on this 
subspace. Additionally Tw(w)C has to be restrmted onto the subspace of valid configurations as defined 
by con- ditmn (19). These reductions in the size and complemty of the matrices make an explicit calculation 
of pw (w) possible Appendix D: Calculating the largest eigenvalue For small W the largest eigenvalue 
pw(w) of Tw(w)C re-stricted to the subspace of valid translationally mvanant configurations as defined 
by condition (19) and Eq (48) can be calculated using computer algebra Although the matrix Tw (w) depends 
on e ~/2W the largest eigenvalue of Tw (w)C only contmn terms of the form e ~/2. Thin 1s a consequence 
of the translational invarlance of the lattice. In order to reveal the underlymg structure of the largest 
elgenvalues pw (w) for &#38;fferent W it turns out to be very useful to expand them m powers of e ~/~. 
We get W=I "pi(w) = x/~+O(e -~) W=2 p2(w) = vrp-(p-1)e~ +O((e~) 2) w=3 p~(~,) = v'~-(p-1)e~ +(v-1)v~(e-~)~ 
+O((e~)~) W=4 p4(w) = x/p-(p-1)e~ +(p-1)x/p(e~) 2 _{p_ 1) x/~e (e ~ )3 + O((e ~ )a), where the O((e~/2) 
k) terms denote terms of the given or- der with prefactors which are different for different W We can 
see, that the coefficients up to order (e~/2) w-1 remain unchanged upon increasing W and that they moreover 
con- stltute the beginning of a simple geometrm serms We can thus extrapolate this behavior to arbitrary 
W by assuming that thin pattern holds for arbitrary orders Resumming the geometric series then yields 
Eq (27).   
			
