
 Copyright and Reprint Permission: Abstracting is permitted with credit to the source. Libraries are 
permitted to photocopy beyond the limit of U.S. copyright law for private use of patrons those articles 
in this volume that carry a code at the bottom of the first page, provided the per-copy fee indicated 
in the code is paid through Copyright Clearance Center, 222 Rosewood Drive, Danvers, MA 01923. For other 
copying, reprint or republication permission, write to IEEE Copyrights Manager, IEEE Service Center, 
445 Hoes Lane, P.O. Box 1331, Piscataway, NJ 08855-1331. All rights reserved. Copyright 2001 by the Institute 
of Electrical and Electronics Engineers, Inc. All rights reserved.Copyright 2001 IEEE. Personal use of 
this material is permitted. However, permission to reprint/republish this material for advertising or 
promotional purposes or for creating new collective works for resale or redistribution to servers or 
lists, or to reuse any copyrighted component of this work in other works must be obtained from the IEEE. 
Anisotropic Geometric Diffusion in Surface Processing U. Clarenz, U. Diewald, M. Rumpf . Institute for 
Applied Mathematics University of Bonn, Germany Abstract A new multiscale method in surface processing 
is presented here which combines the image processing methodology based on non­linear diffusion equations 
and the theory of geometric evolution problems. Its aim is to smooth discretized surfaces while simul­taneously 
enhancing geometric features such as edges and corners. This is obtained by an anisotropic curvature 
evolution, where time is the multiscale parameter. Here, the diffusion tensor depends on the shape operator 
of the evolving surface. A spatial .nite element discretization on arbitrary unstructured triangular 
meshes and a semi-implicit .nite difference discretiza­tion in time are the building blocks of the easy 
to code algorithm presented here. The systems of linear equations in each timestep are solved by appropriate, 
preconditioned iterative solvers. Differ­ent applications underline the ef.ciency and .exibility of the 
pre­sented type of surface processing tool. Keywords: Image Processing, Geometric Modeling, Numerical 
Analysis 1 INTRODUCTION The processing of detailed triangulated surfaces is an important topic in computer 
graphics [5, 12, 13, 19]. Nowadays, various such surfaces are delivered from different measurement techniques 
[4] or derived from two-or three dimensional data sets [14]. Recent laser scanning technology for example 
enables very .ne triangulation of real world surfaces and sculptures. Also from medical image gen­eration 
methods such as CT and MRI devices or 3D ultrasound cer­tain surfaces of interest can be extracted -frequently 
in triangulated form -at a high resolution for further post processing and analy­sis. These surfaces 
are often characterized by interesting features, such as edges and corners. On the other hand, they are 
typically disturbed by some noise, which is often due to local measurement errors. The aim of this paper 
is to discuss a method which allows the smoothing of discrete surfaces and thus permits a drastic reduction 
of high frequency perturbations. Additionally it is able to retain and even enhance important features 
such as edges and corners on the surface. Figure 1 (cf. also color-page) shows the performance of this 
method and compares it to the smoothing by mean curvature .ow, the appropriate geometric Gaussian smoothing 
.lter. The core of the method is a geometric formulation of scale space evolution problems for surfaces. 
These techniques were originally developed for image processing purposes. Thus the method not only delivers 
a single resulting surface, but a complete scale of sur­faces in time. For increasing time, we obtain 
successively smoother surfaces with continuously sharpened edges. First, we derive a continuous model, 
which leads to a nonlin­ear system of parabolic partial differential equations for the coor­dinate mapping 
of the evolving surface. An anisotropic diffusion *Institute for Applied Mathematics, University of Bonn, 
Wegelerstraße 6, 53115 Bonn, Germany, [clarenz j diewald j rumpf ]@iam.uni-bonn.de Figure 1: A noisy 
initial surface (top left) is evolved by discrete mean curvature .ow (top right) and by the new anisotropic 
diffu­sion method (bottom right). Furthermore for the latter surface the dominant principal curvature 
-on which the diffusion tensor de­pends -is color coded (bottom left). The snapshots are taken at the 
same timesteps. tensor depending on the shape operator and thus on the principal curvatures and principal 
directions of curvature, is sensitive to the identi.cation of the important surface features and decreases 
the diffusivity in certain directions in close vicinity to edges or corners. Two parameters are at the 
disposal of the user to in.uence the performance of the method: -A threshold value Afor principal curvatures 
which are as­sumed to indicate an edge and thus require local sharpening and -a .lter width Ewhich controls 
the noise reduction on the actual surface before evaluating principal curvatures. Especially the latter 
is essential to make the proposed method ro­bust and mathematically well-posed. The method presented 
in this paper starts with the description of a continuous model, which has many nice qualitative properties. 
Then in a second step we seek a robust and ef.cient discretization. Hence, we derive an appropriate .nite 
element method with respect to a formulation of the continu­ous problem in variational form. The paper 
is organized as follows. First, in Section 2 we will discuss the background work on sur­face fairing 
by geometric smoothing and on image processing on planar images. In the following Section 3 we introduce 
neces­sary mathematical notation and discuss the basic type of geometric evolution problems. Then in 
Section 4 we present the continuous model of anisotropic diffusion, which afterwards, in Section 5, is 
discretized by .nite elements. The de.nition of a shape operator on triangulated surfaces is given in 
Section 6. Finally, Section 7 is concerned with the concrete implementation and in Section 8 we draw 
conclusions. 2 REVIEW OF RELATED WORK In physics, diffusion is known as a process that equilibrates 
spatial variations in concentration. If we consider some initial noisy con­centration or image intensity 
p0on a domain ncIR2and seek solutions of the linear heat equation @tp;tp=0 (1) with initial data p0and 
natural boundary conditions on @n,weob­tain a scale of successively smoothed concentrations fp(t)g t2IR+. 
For n=IR2the solution of this parabolic problem coin­cides with the .ltering of the initial data using 
a Gaussian .lter 2);1;x 2j(2,) G,(x)=(20e2of width or standard deviation 0, i. e. p(02/2)=G,*p0. If we 
discretize (1) and use an explicit Euler scheme we have to compute a sequence fpn gn=0,...with pn+1=(Id 
+Tth)pn where Tis the timestep, than approximation of the Laplacian and p0=p. Concerning the smoothing 
of disturbed surface geometries one may ask for analogues strategies. The counterpart of the Eu­clidian 
Laplacian ton smooth surfaces is the Laplace Beltrami operator tM[6, 3]. Thus, one obtains the geometric 
diffusion @tx=tM(t)xfor the coordinates xon the corresponding fam­ily of surfaces M(t). On triangulated 
surfaces as they frequently appear in computer graphics applications, several authors intro­duced appropriate 
discretized operators. Taubin [19] discussed this and related approaches in the context of generalized 
frequencies on meshes and Kobbelt [12] used interpolation schemes. Explicit time discretizations are 
known to have strong timestep restrictions to ensure stability [20]. Thus, many iterations are required 
to ob­tain appropriate results. Kobbelt et al. [13] introduced multilevel strategies in the context of 
multiresolutional editing to improve the ef.ciency of these methods. Guskov et al. [8] discussed relaxation 
schemes with weights depending on the local geometry. Rescently Desbrun et al. [5] considered an implicit 
discretization of geometric diffusion to obtain strongly stable numerical smooth­ing schemes. Furthermore 
they improved the consistency of the discrete operator on arbitrary meshes signi.cantly. The problem 
of tangential coordinate shifts on the surface could be avoided, which is a drawback of some explicit 
methods concerning the geometric positioning of an accompanying texture. The mathematical reason for 
this shifting problem in geometric diffusion is that the Laplace Beltrami operator depends on the metric 
(cf. Section 3), thus the metric of the discrete surface should be kept .xed during a single explicit 
or implicit smoothing iteration. From differential geometry [6] we know that the mean-curvature vector 
HNequals the Laplace Beltrami operator applied to the identity Id on a surface M: H(x)N(x)=;tMx: (2) 
Thus geometric diffusion is equivalent to mean curvature motion (MCM) @tx=;H(x)N(x)) (3) where H(x)is 
the corresponding mean curvature (here de.ned as the sum of the two principal curvatures), and N(x)is 
the normal on the surface at point x. Already in 91 Dziuk [7] presented a semi implicit .nite element 
scheme for MCMon triangulated surface. The mean curvature motion model is known as the natural local 
surface area decreasing .ow. I.e., we obtain for the area Ar(!(t)) of a subset !(t)of a smooth surface 
Mundergoing the MCM evolution (cf. [9]) Z dAr(!(t))=;H2dx: (4)dt !(t) This is one indication for the 
strong regularizing effect of MCM. Unfortunately MCMnot only decreases the geometric noise due to unprecise 
measurement but also smoothes out geometric fea­tures such as edges and corners on the surface. Hence, 
we seek models which improve a simple high pass .ltering. In image processing Perona and Malik [16] proposed 
a nonlinear diffusion method, which modi.es the diffusion coef.cient at edges. Edges are indicated by 
steep intensity gradients. For a given initial image p0they considered the evolution problem @tp;div(G(krpk)rp)=0: 
For increasing time t-the scale parameter -the original image at the initial time is now successfully 
smoothed and image patterns are coarsened. But simultaneously edges are enhanced if one chooses a diffusion 
coef.cient G(:)which suppresses diffusion in areas of high gradients . A suitable choice for gis .. ;1 
2 s G(s)=1+ (5) A2 for a positive constant A. Thus edges are classi.ed by A.I. e. sharpening by backward 
diffusion is invoked whenever krpk.A whereas the image is smoothed by forward diffusion for krpk;A. Kawohl 
and Kutev [11] gave a detailed analysis of the diffusion types in this method. Unfortunately the above 
original Perona and Malik model is still ill-posed because there is a true backward dif­fusion in areas 
of large gradients. Catt´e et al. [2] proposed a regula­rization method where the diffusion coef.cient 
is no longer eval­uated on the exact intensity gradient. Instead they suggested to consider the gradient 
evaluation on a pre.ltered image, i.e., they consider the equation @tp;div(G(krpck)rp)=0 (6) where pc=Gc*pwith 
a suitable local convolution kernel Gc.For instance we again take into accout the Gaussian .lter kernel. 
This model turns out to be well-posed, edges are still enhanced. The evolution and the pre.ltering avoid 
the detection and pronounc­ing of arti.cial edges, which are due to the initial noise. Weickert [22] 
improved this method taking into account anisotropic diffusion, where the Perona Malik type diffusion 
is con­centrated in one direction, for instance the gradient direction of a pre.ltered image. This leads 
to an additional tangential smooth­ing along edges and ampli.es intensity correlations along lines. Preußer 
and Rumpf [18] took up this idea for the construction of streamline type patterns in .ow .elds. Concerning 
the numerical implementation Weickert proposed .­nite difference schemes [21] and Ka.cur and Mikula [10] 
suggested a semi-implicit .nite element implementation for the isotropic model by Catt´e et al. Large 
stencils have to be considered in case of the implementation of anisotropic diffusion by .nite differences. 
This is a crucial shortcoming of such methods, especially if we consider a geometric counterpart on discrete 
surfaces. Preußer and Rumpf [17] discussed adaptive .nite element methods in 2D and 3D image processing 
by anisotropic nonlinear diffusion. In the axiomatic work by Alvarez et al. [1], general nonlinear diffusion 
problems were introduced. More precisely they derive parabolic equations with elliptic terms which are 
based on the cur­vature of isolines or isosurfaces in images. Sethian and Malladi [15] presented a numerical 
level set method which also considers the curvature of level lines. 3 NOTATION AND GEOMETRIC SETTING 
Before we develop our model of nonlinear geometric surface pro­cessing, let us .rst brie.y review the 
basic notation of manifolds, differential calculus and geometric diffusion. For a detailed intro­duction 
to geometry and differential calculus we refer to [6] and [3, Chapter 1]. For the sake of simplicity 
we assume our surfaces to be compact embedded manifolds without boundaries. Thus we consider a smooth 
manifold M, which we suppose to be embedded uu in IR3.By f(x)nwe denote a countable atlas of M, where 
u)gu ncIR2is an open reference domain and uuu x:n!M;eu7!x(eu) is the corresponding coordinate map. For 
each point xon Ma tangent space TxMis spanned by the basis f@ :)@ :g. We regard @ @ 12 tangent vectors 
as linear functionals on C1(M), i. e. for f2 @ @f(x) u C1(M)we de.ne :(x)f:=::(e)where x=x(e). @ @ ii 
@ Due to the embedding in IR3we identify @:with the tangent i : vector @@x:.By TMwe denote the tangent 
bundle. Integration on i Mrequires the de.nition of a metric g(.).):TxMTxM!IR) where g=(gij)ijis supposed 
to be a quadratic positive de.nite form. In our embedded case we obtain uu @@@x@xgij=g())=.) (7)@eu@eu@eu@eu 
ij ij where .indicates the scalar product in IR3 . The inverse of gis ;1 ij denoted by g=(g)ij. Now we 
can de.ne the integration of a function fon M. Let fTugube a .nite partition of unity on Mwith suppTucnu, 
then ZZ oXp u fdx:= Tuf(x)detgdeu: (8) : u M Note that this de.nition is independent of the choice of 
the partition of unity. Integrating either a product of two functions f, gon M or the product of two 
vector .elds v, won TMwe obtain the following scalar products on C0(M)and C0(TM)respectively: ZZ (f)g)M:=fgdx)(v)w)TM 
:=g(v)w)dx: MM In the following we use the sloppy notation dropping the index C. Next we proceed considering 
the fundamental differential operators on M. Suppose f2C1(M)then the total differential dfis a linear 
@@ functional on TM(df2TM0), i. e. h@)dfi:=@(e)(f)= ii @(f;x) @(e). The gradient rMfof fis de.ned as 
the representation i ; @.. @ . of dfwith respect to the metric g: grMf)@ =@)df. We obtain in coordinates 
ii X ij@(f0x)@ rMf=g: (9)@ej @ei i,j Furthermore, we de.ne the divergence divMvfor a vector .eld v2 TMas 
the dual operator of the gradient by ZZ divMvqdx:=;g(v)rMq)dx MM for all q2C1(M). 0 Once we have introduced 
the gradient of a function on M,we directly obtain the Dirichlet form on Mby Z (rMu)rMv)TM :=g(rMu)rMv)dx: 
M Furthermore, the Laplace Beltrami operator tMapplied to any function u2C2(M)is given by the duality 
(;tMu)q)M:=(rMu)rMq)M (10) T for all q2C1(M). A simple computation leads to the follow­ing representation 
of tMuin local coordinates : .. Xp 1@ij @u tMu=pgdetg: detg@ei @ej i,j In the anisotropic diffusion method 
to be presented in this paper we will make intensive use of some fundamental curvature quan­tities. We 
are now introducing the corresponding notation. Let us assume that Mis orientable; then we have a well 
de.ned nor­mal N:M!cIR3on M. The second fundamental form S2 II:TxMTxM!IRis locally given by X II(v)w):=v 
i wjN,i.x,j) i,j where the Gauss map N:n!S2is a representation of the normal with respect to a coordinate 
map x:n!Mand 1@ 2@ 1@ 2@ v=v+v, w=w+w, are two tangent @ @ @ @ 12 12 vectors in TxM. We point out that 
IIis well de.ned, i. e. it is invariant under reparametrization. Furthermore, IIis a symmet­ric bilinear 
form and therefore there is a symmetric endomorphism S:TxM!TxMwith g(Sv)w)=II(v)w);v)w2TxM: The endomorphism 
Sis called shape operator. Its eigenvalues are the principal curvatures of Mat the point xand the eigenvectors 
are the principal directions of curvature. Now, one can de.ne notions of curvature as the mean-curvature 
Hand the Gaussian curvature Kby H:=trS)K:=detS: (11) (Note that in our notation the mean-curvature His 
only the sum of the principal curvatures.) With the Laplace Beltrami operator at hand we can .nally de.ne 
a geometric diffusion problem in analogy to the linear diffusion problem in Euclidian space. We look 
for a solution u:IR+ M!IRof the parabolic equation @tu(t)x); 0 tMu(t)x)=0on IR+ Mfor given initial data 
u(0).)=u0. 0 Here, u0is some function on M. Furthermore, we can consider a diffusion of the manifold 
geometry itself (cf. Section 2). I. e., we seek an one parameter family of embedded manifolds fM(t)g 
t 0 and corresponding parametrizations x(t), such that @tx(t);tM(t)x(t)=0) (12) M(0)=M0: For the sake 
of simplicity we de.ne MCM(M0)t):= M(t), where M(t)is the solution surface at time t. Thus MCM(M)02/2)can 
be regarded as the application of a geo­metric Gaussian .lter of width 0to M. By integration by parts, 
we obtain (@tx)()M(t)+(rM(t)x)rM(t)()TM (t) =0: (13) This is the corresponding weak variational formulation 
which holds for all test functions (2C1(M(t)). The fundamental observa­tion is that this geometric diffusion 
on the coordinate mapping itself coincides with the motion by mean curvature (MCM); in fact for any manifold 
Mwe have tMx=;H(x)N(x)as already stated above in Section 2. 4 ANISOTROPIC GEOMETRIC DIFFU-SION We are 
now prepared to discuss the concept of anisotropic geomet­ric diffusion as a powerful multiscale method 
in surface processing. The aim is to appropriately carry over approved methodology from scale space theory 
in image processing. Let us .rst summarize the building blocks of the new method: We consider a noisy 
initial surface M0to be smoothed and re­place the linear diffusion from the Euclidian case of .at images 
by an appropriate diffusion of the surface geometry itself. The natural geometric diffusion process is 
curvature .ow, which leads to an al­ready nonlinear parabolic system of equations with initial data M0. 
Thereby a family of surfaces fM(t)g+is generated, where the t2IR 0 time tserves as the scale parameter. 
 In addition to the smoothing of the surface our aim is to main­tain or even enhance sharp edges on the 
surface. Gradients of a coordinate mapping are not intrinsic objects on manifolds. The canonical quantity 
is the curvature tensor, in the case of embedded surfaces represented by the shape operator S. An edge 
is indicated by a suf.ciently large eigenvalue. Hence we consider a diffusion tensor depending on S, 
which enables us to decrease diffusion sig­ni.cantly at edges indicated by S. Furthermore we will introduce 
a threshold parameter Aas in (5) for the identi.cation of edges.  The evaluation of the shape operator 
on a noisy surface might be misleading with respect to the original but unknown surface and its edges. 
Thus we pre.lter the current surface M(t)before we evaluate the shape operator. The straightforward geometric 
Gaus­sian .lter is a short timestep of mean curvature .ow. Hence, we compute a shape operator Scon the 
resulting pre.ltered surface Mc(t), where Eis the geometric Gaussian .lter. Let us em­phasize that this 
choice also leads to a mathematically well-posed parabolic problem. Hence we avoid ill-posed backward 
diffusion in our model.  With an appropriately chosen scalar diffusion coef.cient ade­  c pending on 
the eigenvalues "c,1)"c,2of Sc, which are the principal curvatures of Mc(t), it is already possible to 
smooth in approxi­mately .at surface areas and to enhance edges. Along these edges the surfaces M(t)still 
retains its noisy structure from M0(cf. color-page, Fig. 6).We incorporate anisotropic diffusion now 
based on a proper diffusion tensor acwhich enables tangential smoothing along edges. Thereby, the tangential 
edge direction on the tangent space TxM(t)is indicated by the principal direction of curvature corresponding 
to the subdominant principal curvature. The second, perpendicular direction is considered to be the actual 
sharpening di­rection. Color-page, Figure 6 clearly outlines the advantage of an anisotropic diffusion 
tensor. The resulting method leads to spatial displacement and the vol­ume enclosed by M(t)is changed 
in the evolution. Selecting either a retrieving force towards the initial surface M0or a constant forc­ing 
which leads to volume preservation, we can further improve our multiscale method. We end up with the 
following type of parabolic problem. Given an initial compact embedded manifold M0in IR3, we compute 
a one parameter family of manifolds fM(t)g+with correspon­ t2IR 0 ding coordinate mappings x(t)which 
solve the anisotropic geomet­ric evolution equation generalizing the system (12): @tx;divM(t)(ac)=fon 
IR+ M(t))(14) rM(t)x and satisfy the initial condition M(0)=M0. Here, for every point xon M(t)the diffusion 
tensor acis sup­posed to be a symmetric, positive de.nite, linear mapping on the tangent space TxM: ac(x):TxM!TxM: 
Furthermore, frepresents the forcing on the right-hand side that maintains certain geometric properties 
of M(t). Let us point out that an anisotropic timestep Tcorresponds to a nonlinear o-.ltering, where 
T=o2/2. The corresponding varia­tional formulation is given by (@tx)()M(t)+(acrM(t)x)rM(t)()TM (t) =(f)()TM 
(t))(15) for all (2C1(M(t)). We can express the above equation not only in the variational form but also 
in coordinates. This formula­tion is as follows (cf. equation (10)): . . Xp 1@ ij@x kl@tx;pdetggac,jkg 
=f detg@ei @e l i,j,k,l .. on IR+ M(t), where ac,jk =gac@)@ . We will never­ @ j @ k theless focus on 
the variational formulation -especially when we implement a suitable .nite element algorithm. In the 
simplest model we consider a scalar diffusion coef.cient and set .q. a c =G"2+"2 Id) c,1c,2 for a function 
Gsimilar to the one which was introduced for the nonlinear diffusion on planar images (see (5)). We slightly 
modify the original de.nition of Gfor the following reason. We already know that the fundamental MCMevolves 
the surface only in nor­mal direction (cf. equations (12) and (2) ). This is no longer true for an edge 
enhancing evolution as proposed here. It is a concentration effect in the coordinate mapping accompanied 
by some tangential displacement which allows the actual sharpening at an edge. Nev­ertheless we want 
to restrict any necessary tangential displacement in close vicinity to an edge and we intend to prescribe 
the standard MCMevolution outside this area. Thus we de.ne a generalization of (5) ( 1;jsj8A .. ;1 2 
G(s) = (jsj;8.): 1+;jsj>8A (1;8)2.2 Here Aserves as a threshold value for the identi.cation of edges. 
If one of the principal curvatures is larger than A, then we suppose there is an edge which we want to 
be sharpened. In the model with­out pre.ltering this shows up in the steepening behaviour of back­ward 
diffusion for jsj>A. Below a fraction 8of this threshold A we set fast MCMtype smoothing without tangential 
displacement and in between 8Aand Asome suitable transition is prescribed. In our applications we always 
consider 8=0:5. As already announced, an improved model integrates tangential smoothing along edges into 
the multiscale approach. Therefore we consider a true diffusion tensor acwhich is no longer restricted 
to multiples of the identity and which leads in such a way to a scalar diffusion coef.cient. We introduce 
the pre.ltering by mean­curvature .ow as follows: Mc(t):=MCM(M(t))E2/2).At any point xon the pre.ltered 
surface Mc(t)the shape operator Sc is a symmetric endomorphism TxMc!TxMc. Thus there is an orthonormal 
basis fw 1)w 2 gof TxMcsuch that Scis represented by .. S " c,1 0 c = :0" c,2 Now we consider a diffusion 
tensor in equation (14) which is de.ned with respect to the above orthonormal basis by .. a G(" c,1)0 
c =a(Sc)= (16)0G(" c,2) with the function Gfrom above. Hence, in a principal direction of curvature with 
curvature larger than Awe enforce a signal en­hancement. If the second principal curvature is smaller 
than Awe regard the .rst direction as an orthogonal direction of an important edge on the surface which 
has to be sharpened. Simultaneously, in the other direction -the tangent direction along the edge -we 
al­low smoothing. At corners both principal curvatures are large, thus sharpening takes place in both 
directions. Here, we again expect tangential shifting only if one of the principal curvatures is larger 
then 8A. In the simple case of ac =fId, where fis a smooth function, we can determine the tangential 
part of divM(t)(acrM(t)x)ex­plicitly. It is simply given by the differential df(x). Thus tangential displacement 
is just caused by the change of f. With respect to a concrete implementation let us remark that we can 
interprete acalso as a mapping on the product of the embed­ded tangent space and the one dimensional 
space spanned by the normal. In order to do this we decompose a vector z2IR3in the orthogonal basis fv 
1)v 2)Ng 11 22 z=(z.v)v+(z.v)v+(z.N)N where v 1 , v 2denote the embedded tangent vectors corresponding 
to w 1 , w 2(after projection and renormalization). Then using the de.nition of acin equation (16), we 
have 11 22 acz=G(" c,1)(z.v)v+G(" c,2)(z.v)v+(z.N)N:(17) Motivated by our de.nition of the diffusion 
tensor we de.ne as a generalization of the mean curvature (see (11)) Hac:=tr(ac0S) as a generalization 
of the mean curvature (see (11)). This we will call ac-mean curvature. Using this notion, we can express 
the changing-rate of the area Ar(M(t))and the volume Vol(M(t)) enclosed by the compact surface M(t). 
Here M(t)is assumed to be the solution of the homogenous evolution problem @tx;divM(t)(acrM(t)x)=0: Z 
d [Ar(M(t))]t=t0 =;HHacdx)dt M(t0) Z d [Vol(M(t))]t=t0 =;Hacdx: dt M(t0) The .rst equation expresses 
one aspect of smoothing in our model. There is a signi.cant regularization, indicated by the area mini­mization 
in areas which are expected to be .at with respect to the pre.ltering. The second equation leads to a 
formulation of a .ow which keeps the volume enclosed by the evolution surfaces M(t) constant (cf. Huisken 
[9] for the MCMcase). To achieve this we have to select a right-hand side which compensates the overall 
change in volume by a constant forcing in normal direction, i. e. we consider in equation (14) f(t)x)=h(t)N(x)) 
(18) R where h(t):= 1 Hacdx. Alternatively, we can select Ar(M(t)) M(t) a simple retrieving force f(t)x)=C(x0;x(t)) 
(19) where x0is the original point location on the initial surface M0. 5 FINITE ELEMENT DISCRETIZATION 
Up to now we have considered surfaces Mwhich have been con­tinuous manifolds. Concerning the implementation 
of the proposed multiscale method we now discretize our model. We use a .nite element discretization 
to avoid large stencils as they would appear in our problem using e.g. .nite difference schemes. Thus, 
we have to choose a spatial discretization and some timestepping scheme. To clarify the notation we will 
always denote discrete quantities with upper case letters to distinguish them from the corresponding 
continuous quantities in lower case letters. In the application sur­faces are typically represented by 
triangular meshes. Hence, we suppose our meshes to be triangulations as well. Let us denote such a discrete 
surface Mh. We are interested in a family of dis­crete successively smoothed and sharpened surfaces starting 
from some initially given noisy surface Mh,0. We suppose them all to be equivalent with respect to a 
unique topological triangulation T=fTiji2Ig) where Iis some index set. For the sake of convenience, we 
identify a discrete surface and its triangulation. Here the subscript hindi­cates the grid size, which 
we regard as a piecewise constant function on the current triangulation. Its value on a triangle is the 
length of the longest edge. On Tand therefore also on Mhwe de.ne the space of piecewise linear continuous 
functions Vh =f<2C0(Mh)j<jT2P8i2Ig)i 1 where P1is the space of linear polynomials. The identity Id(Mh) 
on the triangulation Mh, which coincides with the pointwise co­ordinate vector Xcan be regarded as a 
function in (Vh)3 . Here, we consider every reference map from a single reference triangle T^cIR2onto 
some Tion Mhas a coordinate map. Integration over Mhis de.ned in analogy to the continuous case (see 
de.ni­tion (8)), now summing over local contributions on the triangles of the mesh. The metric and the 
gradients of functions on Mhare evaluated accordingly on each triangle Twith respect to the refer­ ence 
triangle T^. Now we are able to formulate our discrete problem. Discretiz­ing .rst only in space we obtain 
a variational formulation (cf. for the continuous case (14)) of an evolution problem for a family fMh(t)gof 
discrete surfaces with coordinate maps X(t). In anal­ogy to (15) we obtain h (@tX(t))8)+ M(t) h h (AcrMh(t)X(t))rMh(t)8)TM 
h(t) =(f(t))8)M(t) h h)3 for all test functions 82(Vand Mh(0)=Mh,0. Here, we use the lumped mass scalar 
product (.).)h , which is the ge- M h ometric counterpart of the lumped masses for standard parabolic 
problems on domains in IR2. It replaces the scalar product from the variational formulation of our problem 
in the continuous case and is de.ned by Z X h (U)V)M:= Ih(UV)dx h TT2Mh for two discrete functions U)V2Vh(cf. 
[20]). Here, Ih : C0nh (Mh)!Vdenotes the nodal projection operator. As an immediate consequence the mass 
matrix is diagonal. This sim­pli.es the resulting scheme signi.cantly. Our discrete anisotropic diffusion 
tensor Ac, to be de.ned later, is supposed to be an endo­morphism on the discrete tangent space TMh(t)approximating 
ac from the continuous case. We end up with a system of ordinary differential equations for the three 
coordinates of all triangulation nodes. Next, we have to discretize in time, which includes the choice 
of some timestepping scheme and the decision which terms to be han­dled implicitly and which explicitly. 
Here we proceed in analogy to the approach presented by Dziuk [7] for the discretization of mean curvature 
motion. We expect Xnto be an approximation of X(nT) where Tis the selected timestep. Hence, the time 
derivative can be discretized applying a backward Euler scheme. Thus we obtain: Find a sequence of discrete 
coordinate maps fXn gn=0,... hwhich n de.nes a family of triangular surfaces fMhgn=0,... such that Xn+1 
;Xn h ( )8)Mn+ T h nn+1nh (AcrMnX)rMn8)TM n =(F)8)Mn: h hh h for all discrete test functions 82(Vh)3 
. In what follows we explain in detail the above notation and dis­cuss at which timestep to evaluate 
functions, metric and diffusion tensor. As the governing metric we always consider the one at the nn 
old timestep, here indicated by the subscript Mh, TMhrespec­tively. Thus, also the gradients rMare considered 
with respect n h to the metric on TMn Furthermore, the diffusion tensor Acis h. evaluated explicitly 
at time tn, which we indicate by an upper in­dex n. Concerning the right hand side, we evaluate fat the 
old time tnand de.ne Fn =f(tn). Finally, in each step of the discrete evolution we have to solve a single 
system of linear equations. In terms of nodal vectors, which we indicate by a bar on top of the corresponding 
discrete function we can rewrite the scheme and get n nnn+1 nn nn ... (M+TL(Ac))X=MX+TMF(20) Xn+1 for 
the new vertex positions .at time tn+1 =(n+1)T. Here, we assume the lumped mass matrix .. nhM=(<i)<j)n 
M h ij and the nonlinear stiffness matrix ;. nn n L(A)=(AcrMn<i)rMn<j)Tn hhhij cM to be applied simultaneously 
to each of the three coordinate compo­nents. If in addition a nonvanishing right-hand side is considered, 
n we have to evaluate the vector F.representing the right-hand side nn on each node X,i. e. (F.)i =F(Xin). 
Here, we either choose Figure 2: The noisy initial image and a timestep (t=0.0002) from the evolution 
of a venus head dataset (the diameter is scaled to 1). in case of the retrieving force Fn(X)=C(X0 ;X), 
which has to be evaluated only at the nodes of the current triangulation due to the selected lumped mass 
integration formula, or the constant force R S n Fn(X)= 1 tr(Anc)dxN(X)for an interpolated nor­ n h 
jMj n h M mal N(X), which corresponds to the area preserving evolution in the continuous model (compare 
the forces in (18) and (19)). The diffusion tensor Anis supposed to be piecewise constant on c the triangles 
of our mesh. As in the continuous model the evaluation of the diffusion tensor has to be based on a regularized, 
pre.ltered surface. Here we consider a single timestep of the discrete mean curvature evolution as a 
geometric appropriate regularization, i. e. we compute E2 n nnn .. X=(Id +ML(Id));1X(21) c 2 where Ln(Id)is 
the above stiffness matrix for the isotropic diffu­sion tensor Id. Then the corresponding coordinate 
map Xnde.nes c n a discrete surface Mh,c. Thus, we have .ltered the probably noisy initial coordinates 
with a geometric and discrete Gaussian .lter of width Ebefore we identify edges to be enhanced by our 
actual dis­crete evolution. Hence, high frequency noise is suppressed and we obtain well-posed discrete 
problems whose asymptotic behaviour is independent of the grid size. Let us emphasize that we apply this 
geometric .lter only to evaluate the diffusion tensor and not as an evolution step of the surface itself. 
The required solver for this smoothing problem is already available by a slight modi.cation of our original 
scheme for a single timestep. In the continuous model a suitable construction of a diffusion tensor, 
which incorporates edge sharpening and tangential smooth­ing along edges, involves the principal curvatures 
and curvature di­rections deduced from the shape operator. Now in the discrete case, we are interested 
in some discrete counterpart. At .rst, triangulated surfaces have no canonical curvature tensor. For 
every triangle T the curvature evaluation is based on local L2-projections of the tri­angulated and regularized 
surface Mn onto graphs of quadratic h,c polynomials over the tangent space. In our case the embedded 
tan­gent space coincides with the plane containing T. For these poly­nomials the corresponding shape 
operator Sncan be computed ex­ c plicitly. For details we refer to Section 6. Finally, we evaluate the 
required diffusion tensor Anon every triangle Tby (see (16)) c An jT =a(Sn))cc where we take up our original 
de.nition (cf. Section 4) for the con­tinuous problem and apply it now to the numerically approximated 
shape operator Sn . c Color-page, Figure 7 shows results from the semi-implicit algo­rithm for a venus 
head data set. The corresponding initial data is Figure 3: The discrete solutions at time t=0:00005are 
calculated for different values of the pre.lter width (E=0:005(left) and E= 0:08(right)).  Figure 4: 
For A=10(top left) and A=30(top right) the discrete solutions are shows at time t=0:0001(the dominant 
principal curvature is depicted in color, A=10(bottom left) and A=30 (bottom right)). displayed in Fig. 
2. Figure 3 gives a comparison of the evolution results at time t=0:0004for different pre.lter width 
E. Finally, we compare in Fig. 4 the dependance of the solution on the pa­rameter A. For smaller values 
of Amore and more feature edges are enhanced. Here we consider the data set from Fig. 1 (cf. also color-page), 
with initial diameter 1of the object. 6 CURVATURE ON A DISCRETE SUR-FACE Let Tbe an element of a triangulation 
Mh with vertices P1231 P3 )P )Pand barycenter CT =(P1+P2+). The nor­ 3 mal of Tis denoted by N. First 
we assume a normalized situation such that CT =0and N=(0)0)1), i.e. P1)P2)P32fz=0g, where points in IR3are 
denoted by (x)y)z). This can be obtained by a rotation with some matrix Q2SO(3)and a translation. In 
the following we will assume that !T = fT02MjT0\T6= gis given as a graph over the plane h fz=0g. The 
image of the projection of !T on fz=0gis denoted by ^. Then the graph !Tis represented by a piece­ !T 
wise linear function ':^!IR. Now we compute the ! T L2(^)-projection of 'onto the subspace Qof the space 
of !Tquadratic polynomials P2spanned by fx 2)xy)y 2 g. To this end, let p(x)y)=Cx2+jxy+ry 2be this P2-function, 
characterized by S=(C)j)r)2IR3and let ' 1 =x 2)' 2 =xy)' 3 =y 2be the canonical basis of Q. Then Sis 
given by the linear equation 01 Z Z X @A ' i ' jdxdySj='' idxdy)i=1)2)3: j !^T ^T ! The discrete principal 
curvatures " 1)"and the principal direc­ 2 tions of curvature of Mhon Twill be de.ned as the corresponding 
quantities for the smooth surface (x)y)p(x)y))in the origin 0. The matrix representing the shape operator 
S(0)in the basis f@)@ gis given by: @x@y .. 2Cj :j2r For the mean-curvature Hand the Gaussian curvature 
Kin the point 0we obtain H=2(C+r) 2 K=4Cr;j: This enables us to compute " 1)" 2as follows: r HH2 " 1,2 
=±;K: 24 Color-page, Figure 7 shows the numerically calculated dominant principal curvature for the timesteps 
of an anisotropic evolution. Then we easily obtain the embedded principal directions of curvature V1)V2.If 
C=rand j=0, one can choose as fV1)V2 gany orthonormal basis of the tangential space. Otherwise W11 W2 
W22 let W1 =(1)W2))=(1)W2)be non-zero solutions of . . p H2/4;11 C;r; KW1+jW2 =0 . . p C;r+H2/4;KW2 +jW2 
=0: 21 In a last step we normalize the vectors W1)W2and compute the embedded principal directions of 
curvature V1)V2by a push for­ward onto the embedded tangent space applying the inverse of the rotation 
Qfrom our normalization step above . W1! Q;11 1 W1V=p 2 ) (22) (W1)2+(W1)2 120 . W1! Q;11 V2 =p W1 : 
2 (W2)2+(W2)2 120 12 12 Note that V, Vare the discrete analogues of v, vin Section 4. In our considerations 
we obtain a regularization by pre.ltering the corresponding surface. We would like to point out that 
choosing larger stencils instead of !Tis a further possibility for a regulariza­tion. 7 ALGORITHM AND 
IMPLEMENTATION Based on our description of the method of anisotropic diffusion in surface processing 
let us now focus on the concrete implementation of the corresponding scheme for a single timestep of 
the discrete evolution problem. Due to the considered semi-implicit approach the algorithm is easy to 
code following the standard .nite element procedure. Here we will give a detailed explanation, especially 
to outline how the solution of the discrete problem breaks up into ele­mentary and mainly local calculation 
steps. Each timestep consists of the assembly of the matrices, the so­lution of the pre.ltering problem, 
the evaluation of the diffusion tensor and .nally the solution of the actual diffusion problem: timestep(Mn) 
f compute the pre.ltered surface Mn solving h,c 2 ncnnn ..n; (M+L(Id))Xc =MX 2 calculate Snand An; cc 
n+1 compute Mh solving for the nodal coordinates ..n; nnnn+1 n (M+TL(Ac))X=MX g nnn n The assembly 
of each matrix M, L(A)or L(Id)-here de­ c noted by B-is based on the standard Finite Element procedure. 
It consists of an initialization B=0followed by a traversal of all surface triangles T. On each Twith 
nodes P0)P1)P2, a corre­sponding local matrix (bT is computed .rst. It corresponds to ij)ij all pairings 
of local nodal basis functions. Then the matrix entries are added to the matching entries in the global 
matrix B, i. e. for Tevery pair i)jwe update Bu(i),u(j) =Bu(i),u(j)+bij. Here C(i) is de.ned as the global 
index of the node with local index i. Thus we can now focus on the computation of the local mass matrix 
m T and the local stiffness matrices lT(A)and lT(Id)respectively. Due to the applied lumped mass integration 
we immediately verify T 1 m=oijjTj ij 3 where jTjis the area of the triangle Tand oijthe usual Kronecker 
symbol. Next, let us consider for every triangle Tthe reference triangle T^cIR2with independent variables 
e1)e2and nodes e 0=(0)0), e 1 =(1)0), and e 2 =(0)1). Then an af.ne coordinate map X maps T^onto Tand 
its nodes e ionto the corresponding nodes Pi of Ton the discrete surface in IR3. Hence the corresponding 
metric tensor is as in the continuous case (7) given by @X@X gij=.) @ei @ej k i 0 where @X =P;P. Now 
we are able to evaluate the gradients kk@ i of the linear basis functions <lcorresponding to the nodes 
Plin 1020 the embedded tangent space spanned by P;Pand P;P, i. e. (cf. equation (9)) Xl l ij@<i 0rMn<=g(P;P)) 
h @ej i,j where we refer to the derivatives of <lwith respect to the reference coordinates e: .! ...... 
@.l ;110 1 @ = )): @.l ;101 @ 2 Thus for the linear stiffness matrix required in the presmoothing step 
we obtain lT =jTjrM<i .rn<j. If our actual diffusion n M ij hh Figure 5: The resulting surface mesh (top) 
from an adaptive al­gorithm is compared with the corresponding grid of an evolution with .xed triangulation 
(bottom). The areas of high curvature are clearly visible as re.nement regions. tensor Aon Tdiagonalizes 
with respect to an orthogonal basis c fV1)V2 gwith entries gon the diagonal in the corresponding 1, g2representation 
(see de.nition (16)), for the local nonlinear stiffness matrix we .nally obtain Ti 1j 1 l ij(A)=jTj[g1(rMn<.V)(rMn<.V)+ 
hh i 2j 2 g2(rMn<.V)(rMn<.V)]: hh Grid Adaptivity Due to the possible tangential displacement in the 
vicinity of edges the results of the evolution can be signi.cantly improved taking into account adaptive 
grid re.nement depending on the dominant principal curvature (cf. Fig. 5). Here, we apply a Delauney 
type re.nement. Iterative Solver The resulting systems of linear equations, which arise in each timestep 
of the discrete anisotropic curvature evolution are solved either by a preconditioned conjugate gradient 
method or by an al­gebraic multigrid method. For small timesteps and moderately .ne meshes the conjugate 
gradient method converges in several itera­tions in case of a diagonal preconditioning. For instance 
for the venus data set and timestep 5.10;5the relative residual in l2norm drops below 10;12after 4iterations. 
If we consider larger timesteps and .ne grids the condition of the matrix O(1+Th;2)becomes large. Thus 
the number of required iterations increases signi.cantly. Unfortunatly standard multigrid strategies 
are not available on arbitrary meshes. But applying an algebraic multigrid solver O(1)iterations are 
required to solve the system independent of the grid size and the timestep. In the appli­cation we obtain 
a reduction of the residual in each timestep by a factor of 0:5.  8 COMPARISON AND CONCLUSIONS We have 
presented a novel multiscale technique for surface fair­ing. It is able to successively smooth noisy 
initial surfaces while simultaneously enhancing edges and corners on the surface. The evolution time 
is the scale parameter. The method is based on an anisotropic curvature evolution prob­lem. The corresponding 
nonlinear partial differential equations have been discretized by .nite elements in space and a semi 
im­plicit backward Euler scheme in time. The user controls the surface evolution mainly by two parameters 
which have an intuitive mean­ing. A regularization parameter Ehas to be chosen to .lter out high frequency 
noise before the diffusion coef.cient is evaluated. Here a suitable choice in the application is E=Chwith 
C2[1)4]. Furthermore, Acan be regarded as a user given threshold for edge detecting, with the meaning 
that a principal curvature larger than A indicates an edge which is to be preserved by the fairing scheme. 
Previous work on surface fairing already involves the idea of cur­vature motion. Taubin [19] and Kobbelt 
[12] considered an um­brella operator, which is a spring force type implementation of the Laplace Beltrami 
operator. The shortcoming of tangential shifts in their work is mainly due to the successive local change 
of the metric in the interation scheme itself. Furthermore, due to the ex­plicit character of the scheme, 
timestep limitations show up. Des­burn et al. [5] avoided both shortcomings by considering an im­plicit 
scheme which holds the metric .xed and is unconditionally stable. Sharp edges on the surface are rapidly 
smoothed by all pre­vious approaches because of the high local curvature which leads to fast smoothing 
in these regions. Our method is able to detect such edges and their direction and incorporates appropriate 
direc­tion dependent smoothing only. Concerning multigrid methods for the smoothing, Kobbelt et al. [13] 
discuss a V cycle type smoothing with straightforward prolongation and restriction, where we pro­pose 
a true algebraic multigrid which involves appropriate matrix dependent prolongations and restrictions. 
Interesting future research directions are the combination of the presented multiscale method with mul­tiresolutional 
techniques, which should appropriately re.ect the continuous coarsening in the evolution,  further investigations 
on surface modeling concerning suitable choices of the diffusion tensor and the forcing on the right 
hand side of the parabolic system, and  the simultaneous processing of the geometry and the texture 
if such an additional texture is given on the surface.  Acknowledgement The authors thank Alexander 
Schweitzer from Bonn for helping with the test of the algebraic multigrid and offering his code.  References 
<RefA>[1] L. Alvarez, F. Guichard, P. L. Lions, and J. M. Morel. Axioms and fundamental equations of image 
processing. Arch. Ration. Mech. Anal., 123:199 257, 1993. [2] F. Catt´e, P. L. Lions, J. M. Morel, and 
T. Coll. Image selective smoothing and edge detection by nonlinear diffusion. SIAM J. Numer. Anal., 29:182 
193, 1992. [3] I. Chavel. Eigenvalues in Riemannian Geometry. Academic Press, 1984. [4] B. Curless and 
M. Levoy. A volumetric method for building complex models from range images. In Computer Graphics (SIGGRAPH 
96 Proceedings), pages 303 312, 1996. [5] M. Desbrun, M. Meyer, P. Schroeder, and A. Barr. Implicit fairing 
of irregular meshes using diffusion and curvature .ow. In Computer Graphics (SIGGRAPH 99 Proceedings), 
pages 317 324, 1999. [6] M. P. do Carmo. Riemannian Geometry. Birkh¨auser, Boston Basel Berlin, 1993. 
[7] G. Dziuk. An algorithm for evolutionary surfaces. Nu­mer. Math., 58:603 611, 1991. [8] I. Guskov, 
W. Sweldens, and P. Schroeder. Multiresolution signal processing for meshes. In Computer Graphics (SIG-GRAPH 
99 Proceedings), 1999. [9] G. Huisken. The volume preserving mean curvature .ow. J. Reine Angew. Math., 
382:35 48, 1987. [10] J. Ka.cur and K. Mikula. Solution of nonlinear diffusion ap­pearing in image smoothing 
and edge detection. Appl. Numer. Math., 17:47 59, 1995. [11] Kawohl, B. and Kutev, N. Maximum and comparison 
prin­ciple for one-dimensional anisotropic diffusion. Math. Ann., 311 (1):107 123, 1998. [12] L. Kobbelt. 
Discrete fairing. In Proceedings of the 7th IMA Conference on the Mathematics of Surfaces, pages 101 
131, 1997. [13] L. Kobbelt, S. Campagna, J. Vorsatz, and H.-P. Seidel. In­teractive multi-resolution 
modeling on arbitrary meshes. In Computer Graphics (SIGGRAPH 98 Proceedings), pages 105 114, 1998. [14] 
W. Lorensen and H. Cline. Marching cubes: A high resolu­tion 3d surface construction algorithm. Computer 
Graphics, 21(4):163 169, 1987. [15] R. Malladi and J. A. Sethian. Image processing via level set curvature 
.ow. Proc. Natl. Acad. Sci. USA, 92:7046 7050, 1995. [16] P. Perona and J. Malik. Scale space and edge 
detection using anisotropic diffusion. In IEEE Computer Society Workshop on Computer Vision, 1987. [17] 
T. Preußer and M. Rumpf. An adaptive .nite element method for large scale image processing. In Scale-Space 
Theories in Computer Vision, pages 232 234, 1999. [18] T. Preußer and M. Rumpf. Anisotropic nonlinear 
diffusion in .ow visualization. In Proceedings Visualization 1999, 1999. [19] G. Taubin. A signal processing 
approach to fair surface de­sign. In Computer Graphics (SIGGRAPH 95 Proceedings), pages 351 358, 1995. 
[20] V. Thom´ee. Galerkin -Finite Element Methods for Parabolic Problems. Springer, 1984. [21] J. Weickert. 
Anisotropic diffusion in image processing. Teub­ner, 1998. [22] Weickert, J. Foundations and applications 
of nonlinear anisotropic diffusion .ltering. Z. Angew. Math. Mech., 76:283 286, 1996.  </RefA>
			
