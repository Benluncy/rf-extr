
 Product Growth and Mixing in Finite Groups L´aszl´o Babai* Nikolay Nikolov L´aszl´o Pyber Abstract 
We prove the following inequality on the convolution of distributions over a .nite group G: (0.1) X 
* Y - U =n/m X - U Y - U , where X, Y are probability distributions over G, the * denotes convolution, 
U the uniform distribution over G, and . the g2-norm; n is the order of G, and m denotes the minimum 
dimension of nontrivial real representations of G. This inequality can be viewed as a new expansion property 
of a large class of groups, including all Lie-type simple groups of bounded rank, all of which satisfy 
m > cnß (where c> 0 is an absolute constant and ß> 0 depends on the rank bound only). Best among them 
are the groups G = SL2(q) (2 × 2 matrices with determinant 1 over Fq) where m ~ n1/3/2. We derive applications 
of the convolution inequal­ity (0.1) to a variety of areas, ranging from stochastic processes to additive 
combinatorics to group theory. An immediate consequence is a product growth inequality for subsets of 
G: if A, B . G then |AB| > n/(1+.) where . = n2/(m|A||B|). On the one hand, this corollary strengthens 
a recent result of Gowers which served as the inspiration to the present work; on the other hand, it 
gives a strong (and best possible) a.rmative answer to a problem regarding the product growth of subsets 
of SL2(q) recently posed by Venkatesh and Green at a conference in the newly .ourishing area of additive 
combinatorics. Another corollary to the main inequality shows that for groups with large m, mixing in 
the strongest sense (g8-norm) occurs more rapidly than expected; we prove that if X, Y, Z are distributions 
over G then n (0.2) X * Y * Z - U 8 < X Y Z . m *University of Chicago. Email: laci@cs.uchicago.edu. 
Part of this work was done at the R´enyi Mathematical Institute, Budapest, and at the Centre Interfacultaire 
Bernoulli, Lausanne. Imperial College London. Email: n.nikolov@imperial.ac.uk. R´enyi Mathematical Institute, 
Budapest. Email: pyber@renyi.hu. This generalizes a result of Gowers. By easy induction, our main inequality 
generalizes to the convolution of multiple terms and thereby results in rapid mixing estimates for time-inhomogeneous 
Cay­ley walks on G. It also gives estimates for the size of the product of several subsets, resulting 
in diameter es­timates for Cayley graphs and tying in with the broad subject of bounded generation in 
group theory. An illustration of the connection to diameters: for 2/3+E G = SL2(q) it follows that if 
A . G and |A|= nthen At = G where t = O(1/E); we also show that the elements of G are represented nearly 
uniformly as words of length t over A. The connection to bounded generation is illus­trated by one of 
the main applications of our results: every .nite simple group of Lie type of characteristic p is the 
product of 5 Sylow p-subgroups. Results of this type are among the ingredients of the recent breakthrough 
result that all .nite simple groups have bounded degree expander Cayley graphs [KLN]; our results improve 
and greatly simplify these ingredients. The results and techniques used in this paper were inspired by 
a link between quasirandomness and group representation theory recently found by Gowers [Go]. 1 Introduction 
1.1 Expansion of .nite groups. Expansion prop­erties of graphs have been of great interest to the theory 
of computing for decades, and every new technique in­troduced in the area promises new applications. 
Many of the best expanders are linked to groups and speci.­cally to the group SL2(q) of 2 × 2 matrices 
with deter­minant 1 over the .eld Fq (q a prime power). In partic­ular, the Ramanujan graphs constructed 
by Lubotzky, Phillips, Sarnak [LuPS] and by Margulis [Ma] are Cay­ley graphs of this group. A belief 
in a certain degree of expansion of .nite simple groups is expressed in the conjecture [BaSe] that all 
Cayley graphs of such groups have polylogarithmic diameter (and therefore even for the worst generators, 
the random walks con­verge rapidly). In a recent breakthrough, Helfgott [He] con.rmed this conjecture 
for the groups SL2(p)(p prime), by proving a powerful product growth estimate for sets of generators 
of SL2(p) (see Theorem 4.2).  1.2 Time-inhomogeneous Cayley walks. In the present paper we give yet 
another type of expansion result for a large class of groups. Expansion has been known to be related 
to rapid mixing of random walks; here we consider time-inhomogeneous Cayley walks on the .nite group 
G. In a single step, a Cayley walk moves according to a probability distribution on G; the transition 
matrix is the G-circulant generated by the distribution (see Section 5.2 for the de.nitions). In a time-inhomogeneous 
Cayley walk we permit a di.er­ent distribution at each time step. We consider Cay­ley walks where each 
step is moderately random, as measured by an upper bound on the g2-norm of the corresponding distribution. 
This initial randomness requirement will be de.ned in terms of the parameter m, the minimum dimension 
of nontrivial real represen­tations of G (the larger the dimension, the less initial randomness is required). 
Our central result estimates the g2-distance to the uniform distribution of a 2-step time-inhomogeneous 
Cayley walk. In other words, we estimate how far the G-convolution of two distributions over G is from 
uniform. By easy induction, the result extends to time­inhomogeneous Cayley walks of any length. We note 
that our Cayley walks are not necessarily symmetric, i. e., the measure assigned to g . G and to g-1 
may be di.erent. From the convolution bound we infer an unexpect­edly strong bound on mixing time in 
the g8 norm. In particular for G = SL2(q) (of order n = q(q2 - 1)) we show that if each distribution 
involved has g2 ­norm =vEn-4/9 then in three steps, the distribution is within 2E3/n of uniform in g8 
norm. More generally, if each probability distribution involved has g2-norm <n-1/3-E then in 5/(3E) 
steps the distribution will be nearly uniform in g8 norm. 1.3 Applications. This type of estimate reduces 
the task of estimating the mixing time of Cayley walks on G = SL2(q) to analyzing an initial phase where 
the walk spreads to an n2/3+E portion of the space. It combines well with results obtained from sum-product 
estimates [BoKT] which work up to n1-c [He]. Indeed, such estimates can replace the (easier) second phase 
of Helfgott s analysis of the worst case diameter and mixing rate of SL2(p) [He]. A number of corollaries 
regarding the product growth of subsets of G follow. We show that subsets of size just above n2/3 have 
rapid product growth, i. e., for two such subsets A, B . SL2(q), the set AB is much larger than max{|A|, 
|B|}. We also infer that a 2/3+E product of t 1/(3E) subsets of G of size = nis the entire group and 
the elements of the group are nearly uniformly represented as products of length t from these sets. We 
obtain a similar result, with n2/3 replaced by n1-c, for all other classes of (quasi)simple groups of 
Lie type of bounded rank. (A quasisimple group G is a simple group with possibly a small center tucked 
underneath; G has to be perfect, i. e., G = G. where G. is the commutator subgroup. An example is SL2(q) 
which has a center of order 2 if q is odd; and the quotient by the center is the simple group PSL2(q).) 
Our results have already found a number of ap­plications in the area of bounded generation. Typ­ical 
results in this area state that most .nite simple groups are the product of a bounded number of sub­sets 
of a certain type such as abelian subgroups, Sy­low subgroups, certain conjugacy classes, commutators 
and more complex words [LP, Shv, Shm, NS, Ni, NP, APPS]. Bounded generation results for .nite groups 
are motivated by a multitude of application to major problems in the theory of in.nite groups (Serre 
s con­jecture on the topology of pro.nite groups via word width of .nite groups [NS], model theoretic 
character­ization of simple pseudo.nite groups via commutator width [Wil], pro.nite completions of arithmetic 
groups via Sylow width [LP, HruP], expansion/Kazhdan con­stants of certain in.nite matrix groups via 
product de­composition into elementary subgroups [Shm], etc.) Because of the technical nature of the 
consequences of our work to bounded generation, we do not go into the details here but mention one of 
the main applications which will appear in the journal version of this paper. Application 1.1. Every 
.nite simple group of Lie type de.ned over a .eld of characteristic p can be written as a product of 
at most 5 of its Sylow p­subgroups. It was previously known that a bounded number of Sylow p-subgroups 
su.ce; the previous bound was 25 [NP]. The proof was based on detailed structural arguments. For the 
most part we can argue by the size of certain subsets, ignoring the structure and thus greatly simplifying 
the proofs and at the same time obtaining considerably better, nearly optimal bounds. This result has 
an important connection to a recent major result, the proof that all .nite simple groups have expander 
Cayley graphs (Kassabov, Lubotzky, Nikolov [KLN]). Bounded Sylow-width is an ingredi­ent; this ingredient 
has now been greatly improved and simpli.ed.  1.4 Methods. Our main convolution estimate (Theorem 2.1), 
of which all other result proved in this paper are corollaries, is proved by invoking the repre­sentation 
theory of .nite groups to estimate the second eigenvalue that is the key to expansion and mixing, in 
the spirit of a recent paper by Gowers [Gow2] (which incidentally was motivated by giving a strong negative 
answer to a question stated in [BaSo]). Speci.cally, the key parameter of the group G that plays a role 
in this connection is the minimum degree m of nontrivial representations of G, i. e., the minimum dimension 
of complex vector spaces on which the group can act nontrivially. For instance, the order of the group 
G = SL2(q) is n = q(q2 - 1) and the minimum degree of its nontrivial representations is m =(q - 1)/2 
~ n1/3/2. The connection between the parameter m and eigenvalue estimation has previously been used by 
sev­eral authors in a similar fashion [SarX, BoG]. Re­cently Bourgain and Gamburd [BoG] used it to ob­tain 
uniform and almost sure expansion bounds for SL2(q). In the sweet 2003 monograph by Davido., Sarnak, 
and Valette, this method is used to give an elementary proof of a strong but not optimal estimate of 
the second eigenvalue of the LPS/Margulis Ramanu­jan graphs [DSV, pp. 124 128]. Because of the magnitude 
of the parameter m for the groups SL2(q), these groups were the primary targets in each case mentioned. 
Gowers made the relation between the magnitude of m and quasirandomness properties of the group we derive 
all the corollaries from the Main Convolution Bound(Theorem2.1).Applicationstodiameterisdis-g cussed 
in Section 4. Section 5 is devoted to proving Theorem 2.1. 2 The main results Throughout this paper we 
use the following notation: G is a .nite group of order n and m denotes the min­imum dimension of its 
nontrivial real representations. (A trivial representation represents every group ele­ment by the identity 
transformation of the representa­ tionspace.) denotesthe denotescon-*-norm, g. 2g volution, and U the 
uniform distribution over G. To put the results in a more concrete perspective, it may be helpful to 
keep the most important special case of G = SL2(q) in mind; in this case, m ~ n1/3/2. 2.1 Convolutions. 
This paper has one new theo­rem and countless corollaries. We start with the theo­rem. Theorem 2.1. (Main 
Convolution Bound) Let X and Y be two probability distributions over G. Then (2.3) X * Y - U = n/m X 
- UY - U, A generalization to multiple terms is immediate. Corollary 2.2. (Multi-term Convolution Bound) 
Let X1,...,Xt (t = 1) be probability distributions over G. Then tt i=1 i=1 (t-1)/2 (2.4) * Xi - Un = 
Xi - U m explicit, an insight that has guided our work although  n the quasirandomness philosophy [Th, 
CGW] (cf. [AS, Gow1]) is no longer present and is subsumed by the linear algebra machinery of mixing. 
1.5 Outline of the paper. In Section 2.1 we de­scribe the mixing results, starting with the Main Con­volution 
Bound (Theorem 2.1), the main result of this paper. In Section 2.2 we state the applications to arithmetic 
combinatorics (product growth of sets, Gowers original context). Section 2.3 describes the g g * wheredenotes 
convolution. Near uniformity in the strongest sense, i. e., in g8 norm, sets in much sooner than predicted 
by Corollary 2.2. Corollary 2.3. (Max-Norm Uniformity) If X1,...,Xt (t = 2) are distributions over G 
then tt  t/2-1 resulting tight solution to Venkatesh s problem on the (2.5) * Xi - U<Xi . product growth 
of subsets of SL2(q). In Section 2.4 we m i=1 i=1 8 take a look at the key parameter m (minimum degree 
of irreducible representations) for .nite simple groups. 2.2 Product Growth. In this section we consider 
We review the main result of Gowers paper [Gow2] and results on product growth of subsets of G. Recall 
its connection to our work in Section 2.5. In Section 3 that for A, B . G we de.ne the set AB . G as 
AB = {ab : a . A, b . B}.  Corollary 2.4. (Multistep Product Growth) Corollary 2.7. (Product Decomposition 
2) Let Let A1,...,At (t = 1) be nonempty subsets of G. Then A1,...,At (t = 2) be nonempty subsets of 
G. Assume tti=1 i=1 g g nt-1(n -|At|) mt-2 n , (2.12) (2.6) |Ai|= Ai> . 1+. where t n (2.7) . = . 
t mt-1 |Ai| i=1 We especially highlight the case t = 2 because (a) it solves a published open problem; 
and (b) it directly improves over Gowers result (see Section 2.5). Corollary 2.5. (2-Step Product Growth) 
Let A, B be nonempty subsets of G. Then Then the conclusions of Corollary 2.6 follow. If the condition 
of Corollary 2.6 is amply satis.ed then the elements of G are nearly uniformly repre­ t sented as products 
where ai . Ai. This is i=1 ai formalized in the next statement. Corollary 2.8. (Uniform Decomposition) 
Let A1,...,At (t = 2) be nonempty subsets of G. For g . G, let Ng = Ng(A1,...,At) denote the number of 
solutions to the equation g = x1 ...xt where xi . Ai g and let N = N(A1,...,At) denote the number of 
solu­ ti=1 . n nm|A||B| 2 = min, 2n tions to the equation x1 ...xt-1 = xt where xi . Ai. If (2.8) |AB| 
> 2 n 1+ ant m|A||B| a> 0 and then for all g . G, |Ai|= mt-2 Note that the second inequality can be rephrased 
as follows: t t 1 |Ai| |Ai| , If |B|= an/m then i=1 i=1 (2.13) v Ng - < ann (2.9) |AB| > min {n/2, (a/2)|A|} 
. Next we state a particularly important corollary which is the basis of all our applications to the 
theory of bounded generation as well as to diameter bounds. g Corollary 2.6. (Product Decomposition 1) 
Let A1,...,At (t = 2) be nonempty subsets of G. Assume t i=1 (2.10) |Ai|= . mt-2 and the same inequality 
holds for N in place of Ng. The t = 3 cases of Corollaries 2.6 and 2.8 are equivalent to results of Gowers 
(see Section 2.5). 2.3 Product growth in SL2. The following ques­tion, posed by A. Venkatesh, was communicated 
by Ben Green at the 2004 AIM Workshop on Additive t nCombinatorics, an emerging .eld best de.ned by 
the beautiful 2006 monograph by Tao and Vu [TaV]1 . Problem 2.9. [CL, Problem 3.4]. Let X . SL2(p) satisfy 
|A|~ p5/2; does this imply |A2| >p5/2+d? We con.rm this in a strong form. The following Then each of 
the following holds: t-1 (a) At n Ai = Ø. i=1 g t is an immediate consequence of Corollary 2.5 and the 
(b) Ai = G. i=1 fact that for G = SL2(q) we have m =(q - 1)/2. In fact, as we shall see from the proof 
in Section 3, Corollary 2.10. If A . SL2(q) and A ~ q5/2 then this result already follows from the inequality 
ti=1 |A2| 2 p3/3 ~ n/3 (A2 takes up at least about one third the group). Here the asymptotic notation 
refers to the  (2.11) >n(1 - .) limit q .8. Ai In fact, the desired kind of expansion already starts 
2+d in Corollary 2.4, a considerable weakening of inequal-at |A| 2 p. ity (2.6). If we use the full 
strength of inequality (2.6), we obtain the following weaker su.cient condition for 1The .eld has been 
renamed arithmetic combinatorics in a the conclusions of Corollary 2.6. Fall 2007 IAS semester.  Corollary 
2.11. Assume the subset A . SL2(q) 2+d satis.es |A|~ qwhere 0 <d< 1/2. Then |A2| 2 2+2d q. (Here d is 
.xed while q .8.) Remark 2.12. This result is best possible in the sense 2 that |A|~ qwould not imply 
any growth. Indeed we could then choose A to be a subgroup of order q(q - 1) (upper triangular matrices). 
Therefore in the range |A|= q(q - 1), Gowers-type arguments cannot seem to replace Helfgott s result 
about triple products, |AAA|=|A|1+d, where A generates SL2(q). Remark 2.13. Corollary 2.11 is in a somewhat 
sur­prising contrast with the following result of Ked­laya [Ke] which was also part of Gowers motiva­tion: 
SL2(q) has a subset A of size = cq5/2 such that v AA n A = Ø (where c =1/ 31). The question arises whether 
the exponent 5/2 is best possible in this result. v 8/3 According to Gowers, |A| < 3 2q(Theorem 2.14, 
part (b)). 2.4 Minimum degree of irreducible represen­tations for .nite simple groups. The usefulness 
of our bounds depends heavily on the value of the param­eter m. Let m. denote the minimum degree of the 
non­ trivial complex representations of G. Trivially, m = m(in fact either m = m. or m =2m.), so our 
bounds re­main valid with m. in the place of m. We mentioned the 1896 result of Frobenius [Fr] that for 
SL2(q) we have m=(q - 1)/2 ~ n1/3/2. A proof can be found e. g. in [DSV, p. 102]. Landazuri and Seitz 
[LanS] obtained strong lower bounds for the value of mfor all .nite (quasi)simple groups of Lie type; 
with some slight errors corrected, the results can be found in [KL, p. 188]. Comparing these with the 
table of the orders of the .nite simple groups [KL, p. 170], we can infer lower bounds of the form m>cnß 
where c is a positive absolute constant and ß> 0 only depends on to which of the families of Lie type 
(quasi)simple groups G belongs. For the special linear groups and the unitary groups, ß(SLr)= ß(Ur)=1/(r+1); 
for the symplectic groups, ß(Sp2r)= (r - 1)/(2r2 + r) (the bound is (2r - 1)/(2r2 + r) in characteristic 
2); for the even dimensional orthogonal groups ß(P O± ) = (2r - 3)/(2r2 - r), and for the odd 2r dimensional 
orthogonal groups ß(P O2r+1)= (2r - 2 2)/(2r+ r). This takes care of the six series of classical simple 
groups. The remaining 10 families of exceptional simple groups all have bounded rank and satisfy the 
absolute bound ß = 29/248 0.1169. The remaining .nite simple groups are either spo­radic or alternating. 
The sporadic .nite simple groups, being .nite in number, have no asymptotic signi.cance. The alternating 
groups Ar are notable exceptions on our list: Ar has order n = r!/2, yet the corresponding value of m. 
is r - 1, so in this case, m~ log n/ log log n. This may be one explanation why the alternating groups 
do not expand so rapidly. 2.5 Comparison with Gowers results. The main result of Gowers paper, [Gow2, 
Theorem 3.3], can be stated as follows. Theorem 2.14. (Gowers) Let A, B, C . G and let N = N(A, B, C) 
denote the number of solutions to the equation xy = z where x . A, y . B, z . C. (a) If a> 0 and |A||B||C|= 
an3/m then |A||B||C| 1 |A||B||C| (2.14) N - < v . n an (b) In particular, if |A||B||C|= n3/m then N> 
0, i. e., a solution exists. Statement (b) is equivalent to saying that under the condition |A||B||C|= 
n3/m, we have |AB| >n-|C|. In other words, statement (b) is equivalent to the bound 3 n (2.15) |AB| >n 
- m|A||B| for any pair of nonempty subsets A, B of G. This can be written as (2.16) |AB| >n(1 - .), 2 
n where . = . In Corollary 2.5, we state that in m|A||B| fact, n (2.17) |AB| > 1+. , a uniformly stronger 
bound which gives valuable infor­mation even when . is large (the sets A, B are rel­atively small) whereas 
inequality (2.16) becomes vac­uous when . = 1. To get a sense of the di.erence, assume |A| = |B| = k. 
Then the condition . < 1 v means k>n/ m. In contrast, we obtain fast product growth as soon as k is large 
compared to n/m. Indeed, if k = an/m then inequality (2.17) implies |AB| 2 ak v for k = o(n/ m) and |AB| 
> min {n/2, ak/2} always. This di.erence is critical to our solution to Venkatesh s product growth problem 
in SL2(p) (Problem 2.9). The size of the subsets of SL2(p) for which the the ques­tion was asked corresponds 
precisely to the threshold at which the Gowers bound ceases to be useful.  Statement (a) of Gowers theorem 
(Theorem 2.14) For the proof of Corollary 2.4, we need the follow­ is identical with the special case 
t = 3 of Corollary 2.8. It is possible to generalize Gowers proof directly to obtain Corollary 2.8; this 
indeed was how we .rst proved this result. This, however, did not yield the important corollary about 
2-term products (Corol­lary 2.5). So we discarded our initial approach and were led, via a deeper analysis 
of Gowers ideas, to our central result, Theorem 2.1, from which we were able derive all the intended 
results as simple corollar­ies (including the mentioned generalization of Gowers uniformity result (part 
(a) of Theorem 2.14)). All this told, we are happy to acknowledge the guidance we received from reading 
some of the .ne details of Gowers paper. 3 Deriving the corollaries In this section we derive the stated 
corollaries from the Main Convolution Bound, Theorem 2.1. The proof of Corollary 2.2 is straightforward 
in­duction. For the proof of Corollary 2.3, we need the follow­ing two observations. Observation 3.1. 
If X is a probability distribution over a set of n elements then 2 1 (3.18) X - U = X 2 - . n Observation 
3.2. Let W and Z be probability distri­butions over the .nite group G. Then W *Z -U 8 = W - U Z. Proof. 
Let h . G and let us choose w, z . G independently according to the distributions W and Z, respectively. 
Now, by Cauchy-Schwarz, |P (wz = h) - (1/n)| =(W (g) - (1/n))Z(g -1h) g.G = W - U Z. * t-1 Proof of 
Corollary 2.3. Let W = and i=1 Xi Z = Xt. By Observation 3.2, we have W *Z -U 8 = W -U Z. Now plug in 
the bound of Corollary 2.2 for W - U (changing t to t - 1). Remark 3.3. Note that in fact we proved the 
slightly stronger statement (3.19) tt-1 gt/2-1 g n * Xi - U< Xt Xi - U. m i=1 i=1 8 ing observation. 
Observation 3.4. Let A be a nonempty subset of the .nite set O and let X be a probability distribution 
over O, concentrated on A. Then X = 1/ |A|, and equality holds if and only if X is uniform over A. Proof 
of Corollary 2.4. Let Xi be the uniform proba­bility measure on Ai viewed as a measures on G. So t * 
t Xi =1/ |Ai|. Let Ai = C and Z = Xi; i=1 i=1 so Z is concentrated on C. By Observation 3.4, we -2 have 
|C|= Z . Therefore, by Corollary 2.2 and Observation 3.1 we obtain 1 2 1 2 = Z =+ Z - U |C| n t g 1 n 
t-1 < + Xi 2 nm i=1 1 nt-1 =+ . t nmt-1 |Ai| i=1 By rearranging, we obtain the inequality stated in Corollary 
2.4. Proof of Corollary 2.5. The .rst inequality is a special case of Cor. 2.4. The second inequality 
is obvious. Proof of Corollary 2.6. We show that inequality (2.10) implies that t-1 g (3.20) |At| + Ai 
> n. i=1 This will clearly imply statement (a). To see that it also implies (b), note that for g . G, 
the statement t g . Ai is equivalent to saying that gA-1 n i=1 t t-1 = Ø, and this follows from part 
(a) given that i=1 Ai |gA-1| = |At|. t t-1 t-1 Set P = Ai and Q = |Ai|. Set i=1 i=1 t-1 n .= . We need 
to show that P >n -|At|. mt-2Q By Corollary 2.4 we have n (3.21) P> >n(1 - .) = n - n., 1+. so we only 
need to show n. =|At|. Substituting the values of . and Q we see that this inequality is exactly the 
same as the assumption, inequality (2.10). Proof of Corollary 2.7. We use the notation of the proof of 
Corollary 2.6. Like in that proof, we need to show that P >n -|At|. By Corollary 2.4, we have P >n/(1 
+ .), so it su.ces to show that n = (1+.)(n-|At|), or equivalently (1+1/.)|At|= n,  i. e., |At|= .(n 
-|At|). Substituting the values of . and Q we see that this inequality is exactly the same as the assumption, 
inequality (2.12). Proof of Corollary 2.8. We derive this result from Corollary 2.3. As in the proof 
of Corollary 2.4, let Xi be the uniform distribution over Ai, viewed t as a distribution over G. Let 
Q = |Ai|; so i=1 t * t Q-1/2 Xi = . Let W = Xi. Then, i=1 i=1 for g . G, we have W (g)= Ng/Q. Therefore 
inequality (2.5) asserts that Ng 1 n t/2-1 1 (3.22) - < v . Qnm Q Multiplying by Q and using the de.nition 
of a, inequal­ity (2.13) follows. 4 Applications 4.1 Diameter of Cayley graphs. In this section we comment 
on the relation of Helfgott s recent poly­logarithmic bound on the diameter of SL2(p) and Gow­ers result, 
deduce a general upper bound on the diam­eter from our main results, and as an application indi­cate 
a new worst-case polylogarithmic upper bound on the diameter of a certain class of groups. For a group 
G and a set S of generators, the Cayley graph G(G, S) is de.ned as the directed graph on vertex set G 
where there is an edge from g . G to gs . G for all s . S. This graph is undirected if S = S-1 . For 
a group G and a set S of generators, let diam(G, S) denote the diameter of the (undirected) Cayley graph 
G(G, S . S-1). The following conjecture appears in [BaSe] (1992). Conjecture 4.1. For every .nite simple 
group G and every set S of generators, diam(G, S) is polylogarith­mic (in terms of n = |G|). In a recent 
breakthrough, Helfgott [He] con.rmed this conjecture for the groups (P)SL(p). This remains the 2 only 
class of groups for which the conjecture has been con.rmed. Helfgott s proof proceeds in two phases. 
The .rst (more di.cult) phase is based on the following remark­able lemma, derived using recent estimates 
on the sum­product growth of .nite .elds of prime order [BoKT]. We continue to use the notation n = |G|. 
Theorem 4.2. (Helfgott) To every E> 0 there exists d> 0 such that if S is a set of generators of G = 
(P)SL(p) and |S|= n1-E then |S3|=|S|1+d . 2 This result implies that for every set S of genera­ tors, 
|S£|= n1-E where g is polylogarithmic (in terms of n): g< (ln n)ln 3/d . The second phase takes us from 
a subset of size 1-E nto all of G. This phase, admittedly the easier part of Helfgott s argument, can 
be entirely replaced by Gowers result: if |S£| 2 2n8/9 then by the product­decomposition version of Theorem 
2.14 (the t = 3 case of Corollary 2.6) it follows that diam(G, S) = 3g. One can generalize this argument, 
and go even slightly below the n/m threshold. Theorem 4.3. Let G be a .nite group and S a set of generators. 
Suppose a> 0 and |S£|= an/m where, as before, m is the smallest dimension of nontrivial real representations 
of G. Then diam(G, S) = tg where (a) if a = e then t = i2 log m/ log al; (b) if a< e then t = i2e/al·i2 
ln ml.  Note that part (b) breaks the n/m barrier; we achieve this by appealing to a noncommuta­tive 
Cauchy-Davenport theorem, proved by Hami­doune [Ha] and Olson [Ol], for an initial modest but unconditional 
growth, before a phase of rapid growth starts. It follows from this result that to prove Conjec­ture 
4.1, it would su.ce to prove that there exists a polylogarithmic value g such that |S£|= cn/m for any 
constant c> 0 (in fact c could even go to zero at an inverse polylogarithmic rate). We note that while 
Helfgott s .rst phase does not require inversion of the generators, the second phase does. The application 
of Gowers result eliminates this need. In fact, the proof of Theorem 4.3 does not require inversions, 
so the bounds stated there remain valid for diam+(G, S), de.ned as the directed diameter of the directed 
Cayley graph G(G, S). It should be mentioned, however, that inversion can always be avoided at the cost 
of a modest increase in the diameter [Ba]. In the journal version of this paper we give an ap­plication 
of Theorem 4.3 where case (b) is required (we do need to go slightly below the n/m). Combining Helfgott 
s result with the Gowers idea, we obtain a polylogarithmic bound on the diameter of an interest­ing extension 
of SL2(p) ( symplectic normalizers, of signi.cance to the structure theory of simple groups of Lie type, 
cf. [KL]). 4.2 Sylow width. This application, along with its signi.cance, in particular to expander constructions, 
has been highlighted in the introduction (Applica­tion 1.1). It will constitute a major technical section 
of the journal version of this paper.  5 Proof of the main result 5.1 Preliminary observations. For 
a symmetric real matrix M, let .1(M) = .2(M) = ... denote the eigenvalues. We call a (not necessarily 
square) matrix biregular if all of its row sums are equal and all of its colum sums are equal. Let sr(A) 
denote the sum of each row of a biregular matrix A; and sc(A)= sr(AT ) denote the sum of each column. 
Note that the product of biregular matrices (if de.ned) is biregular and the quantities sr and sc are 
multiplicative. The following propositions are easy to verify. Proposition 5.1. Let B be a (not necessarily 
sym­metric) nonnegative real n × n matrix with an all­positive eigenvector corresponding to eigenvalue 
.. Then for all (complex) eigenvalues . of B we have . =|.|. Let 1n . Rn denote the all-ones vector 1n 
= (1,..., 1)T . Proposition 5.2. Let A be a nonnegative biregular k×n matrix with row sum sr and column 
sum sc. Then .1(AT A)= srsc and a corresponding eigenvector is 1n. Proposition 5.3. Let A be a k × n 
biregular matrix. If u . Rn and u . 1n then Au . 1k. The next lemma was an ingredient in our original 
proof of the t-step extension of Gowers result (Corol­laries 2.6 and 2.8). We still need its .rst (trivial) 
part; the second part is stated as a hint for the alternative proof. Lemma 5.4. Let A1,...,A£ be nonnegative 
biregular matrices such that the product A = A1 ...A£ is de.ned. Then £ g (5.23) .1(AT A)= .1(AiT Ai) 
i=1 and £ g (5.24) .2(AT A) = .2(ATi Ai). i=1 Proof. A is nonnegative biregular and sr(A)= £ £ (Ai) and 
sc(A)= (Ai). Combining i=1 sr i=1 sc these with Proposition 5.2 yields equation (5.23). Inequality (5.24) 
is not needed in this paper so we omit its proof. 5.2 Time-inhomogeneous Cayley walks and G­circulants. 
A probability distribution over the set O of n = 1 states is a function X :O . R such that X(i) = 0 for 
all i . O and X(i) = 1. i.O An n × n real matrix labeled by O × O is stochas­tic if its rows are probability 
distributions over O. Such a matrix can be viewed as the transition ma­trix for a random step on the 
state space. A time­inhomogeneous Markov Chain on O is described by a sequence B1,B2,... of stochastic 
matrices; the tran­sition at time i is governed by Bi. So the combined transition probabilities from 
time i to j are described by the product j-1 Bi. This matrix is also stochastic. k=i Let us say that 
a matrix is a permutant if every row is a permutation of the .rst row. Let the .rst row of a permutant 
B be X; then obviously 2 1 (5.25) X = Tr(BT B). n Let O = G be a .nite group. A matrix B, labeled by 
G × G, is a G-circulant if for every g, h . G we have B(g, h)= B(1,g-1h). We note that (a) a G-circulant 
is a permutant; (b) the transpose of a G-circulant is again a G-circulant; (c) the product of G-circulants 
is a G-circulant; (d) a G-circulant is biregular; (e) a G­circulant is determined ( generated ) by its 
.rst row. If X is the .rst row then B(g, h)= X(g-1h). A time-inhomogeneous Cayley walk on G is a time­inhomogeneous 
Markov Chain described by a sequence of stochastic G-circulants B1,B2,... generated by the probability 
distributions X1,X2,... . The convolution X * Y of two distributions X and Y over G is de.ned as (X * 
Y )(h)= g.G X(g)Y (g-1h). Observation 5.5. If A and B are the G-circulants generated by X and Y , respectively, 
then the G­circulant generated by X * Y is AB. Combining this observation with equation (5.25) we obtain 
the following identity. Proposition 5.6. Let X, Y be two distributions over G and let A and B be the 
corresponding stochastic G­circulants. Then 2 1 (5.26) X * Y = Tr(BT AT AB). n 5.3 Symmetry implies degeneracy. 
If A, B are two commuting n × n matrices then it is easy to see that the eigensubspaces of A are invariant 
under B. Therefore if A commutes with a group of matrices Bg (g . G) which constitute a representation 
of the group G (i. e., Bg-1h = B-1Bh), then each eigensubspace g  U. of A is invariant under the Bg 
and therefore it contains a G-irreducible subspace. Let m denote the minimum dimension of irreducible 
representations of G over the appropriate .eld (containing the eigenvalue .) and let m. be the multiplicity 
of the eigenvalue .. We conclude that unless the G-action on U. is trivial, we have (5.27) m. = m. This 
simple observation was made by physicist Eugene Wigner around 1930 [Wig] who used it to great ad­vantage 
in classifying the eigenvibrations of physical systems according to the irreducible representations of 
their group of symmetries. ( Multiplicity is regarded degeneracy by physicists.) G-circulants are linear 
combinations of the per­mutation matrices describing the right translations Rg : h . hg and therefore 
they commute with the matrices Lg : h . g-1h of left translations. The ma­trices Lg constitute the left 
regular representation of G. We can now state the key tool that connects eigenvalue estimation to representation 
theory of .nite groups. Lemma 5.7. Let m be the minimum degree of nontriv­ial real representations of 
G. If A is a nonnegative G-circulant then Tr(AT A) - .1(AT A) (5.28) .2(AT A) = . m Proof. Write C = 
AT A. Then C is positive semidef­inite, so .1(C) = .2(C) = ··· = .n(C) = 0. Since C is stochastic, the 
all-ones vector e is an eigenvec­tor. Moreover, it corresponds to .1(C) according to Proposition 5.1 
(since C is nonnegative). Let U denote the orthogonal complement of e in the real euclidean space RG 
(under the standard dot product). This subspace is then invariant both under C and under the left regular 
representation of G. Moreover, no nonzero vector in U is .xed under the left regular G-action (because 
the sum of coordinates of each vector in U is zero and G permutes the coordinates transitively). It follows 
by inequality (5.27) that the multiplicity of every eigenvalue of the restriction of C to U is = m; this 
in particular applies to the multiplicity of .2 on U. But the trace of C restricted to U is Tr(C) - .1(C), 
hence this quantity is = m.2(C). Note that this proof works even when .2 = .1; we did not use any irreducibility 
assumption on C. 5.4 The convolution bound. In this section we conclude the proof of our main result 
(Theorem 2.1). We need the following linear algebra lemma. Lemma 5.8. Let A and B be nonnegative biregular 
matrices such that the product AB is de.ned. Then Tr(BT AT AB) = .1(AT A).1(BT B) + .2(AT A)Tr(BT B) 
- .1(BT B). Proof. Let e1,..., en be an orthonormal eigenbasis for BT B. Assuming B is k × n, by Proposition 
5.2 we can v take e1 = 1n/n. We have 2 T (5.29) Bei = ei BT Bei = .i(BT B). Let C = BT AT AB =(AB)T (AB). 
Then nn T 2 (5.30) Tr(C)= ei Cei = ABei . i=1 i=1 According to equation (5.23) in Lemma 5.4 we have 2 
(5.31) ABe1 = .1(C)= .1(BT B).1(AT A). We need to prove (5.32) n ABei 2 = .2(AT A)Tr(BT B) - .1(BT B). 
i=2 But for i = 2, Bei is perpendicular to 1k (by Proposi­tion 5.3) and therefore, for i = 2, 2 (5.33) 
ABei 2 = .2(AT A) Bei by the Rayleigh principle. We conclude that n n ABei 2 = .2(AT A) Bei 2 i=2 i=2 
= .2(AT A) Tr(BT B) - .1(BT B) . This completes the proof. Proof of Theorem 2.1. Let A and B be the 
stochastic G­circulants generated by the distributions X and Y , re­spectively. Combining Proposition 
5.6 and Lemma 5.8 we obtain 1 X * Y 2 = .1(AT A).1(BT B) n 1 + .2(AT A)Tr(BT B) - .1(BT B). n Now .1(AT 
A)= .1(BT B) = 1 (because both matrices are stochastic), therefore the .rst term on the right­hand side 
is 1/n. By Observation 3.1 and Lemma 5.7  we obtain 1  X * Y - U 2 = .2(AT A) Tr(BT B) - 1 n 1 = (Tr(AT 
A) - 1)(Tr(BT B) - 1) nm n = X - U 2 Y - U 2 . m References [APPS] M. Ab´alfy, L. Pyber, B. Szegedy: 
ert, P. P. P´Groups of .nite abelian or solvable width. In prepara­tion [AS] N. Alon, J. H. Spencer: 
The Probabilistic Method. Wiley, 1992. [Ba] L. Babai: On the diameter of Eulerian orientations of a graph. 
In: Proc. 17th Ann. Symp. on Discr. Alg. (SODA 06), ACM SIAM 2006, pp. 822-831. ´ [BaSe] L. Babai, A. 
Seress: On the diameter of permu­tation groups. Europ. J. Comb. 13 (1992), 231 243. [BaSo] L. Babai, 
V. T. S´ os: Sidon sets in groups and in­duced subgraphs of Cayley graphs. Europ. J. Combi­natorcs 6 
(1985), 101 114. [BoG] J. Bourgain, A. Gamburd: Uniform expansion bound for Cayley graphs of SL2(Z/pZ). 
Ann. Math. to appear. [BoKT] J. Bourgain, N. Katz, T. Tao: A sum-product estimate in .nite .elds and 
applications. Geom. and Funct. Anal. 14 (2004), 27 57. [Ca] R. Carter: Simple groups of Lie type. Pure 
and Applied Mathematics, Vol. 28. John Wiley &#38; Sons, London-New York-Sydney, 1972. [CGW] F. R. K. 
Chung, R. L. Graham, R. M. Wilson: Quasi-random graphs. Combinatorica 9 (1989), 345 362. [CL] Problems 
presented at the workshop on Re­cent Trends in Additive Combinatorics, col­lected by E. Croot and V. 
F. Lev. American Institute of Mathematics, Palo Alto, 2004. http://www.aimath.org/WWW/additivecomb/ additivecomb.pdf 
[DSV] G. Davidoff, P. Sarnak, A. Valette: Elemen­tary Number Theory, Group Theory, and Ramanujan Graphs. 
Cambridge U. Press, 2003. ¨ [Fr] G. Frobenius: Uber Gruppencharactere. Sitzungs­ber. K¨onigl. Preuß. 
Akad. Wiss. Berlin (1896), 985 1021. [Gow1] W. T. Gowers: Quasirandomness, counting, and regularity for 
3-uniform hypergraphs. Combinatorics, Probability, and Computing 15 (2006), 143 184. [Gow2] W. T. Gowers: 
Quasirandom groups. Manuscript, 2006. [Ha] Y. O. Hamidoune: An application of connectivity theory in 
graphs to factorizations of elements in groups. Eur. J. Comb. 2 (1981) 349 355. [He] H. A. Helfgott: 
Growth and generation in SL2(Z/pZ). Ann. Math. to appear. [HruP] E. Hrushovski, A. Pillay: De.nable subgroups 
of algebraic groups over .nite .elds. J. Reine Angew. Math. 462 (1995), 69 91. [KLN] M. Kassabov, A. 
Lubotzky, N. Nikolov: Finite simple groups as expanders. Proc. Nat. Acad. USA 103 (2006), 6116 6119. 
[Ke] K. S. Kedlaya: Large product-free subsets of .nite groups. J. Combin. Theory -A 77 (1997), 339 343. 
[LanS] V. Landazuri, G. Seitz: On the minimal degrees of projective representations of the .nite Chevalley 
groups. J. Algebra 32 (1974), 418-443. [LP] M. W. Liebeck, L. Pyber: Finite linear groups and bounded 
generation. Duke Math. J. 107 (2001), 159 171. [LuPS] A. Lubotzky, R. Phillips, P. Sarnak: Ramanu­jan 
graphs. Combinatorica 8 (1988), 261 277. [KL] P. Kleidman, M. Liebeck: The subgroup structure of the 
.nite classical groups. LMS Lecture Notes 129, Cambridge Univ. Press 1990. [Ma] G. Margulis: Explicit 
group-theoretical construc­tions of combinatorial schemes and their applications to the design of expanders 
and concentrators. J. Prob­lems Info. Transmission 24/1 (1988), 39 46. [Ni] N. Nikolov: A product decomposition 
for classical quasisimple groups. J. Group Th. 10 (2007), 43 53. [NP] N. Nikolov, L. Pyber: Product decomposition 
of quasirandom groups and a Jordan type theorem. Manuscript. arXiv:math/0703343 (March 2007) [NS] N. 
Nikolov, D. Segal: On .nitely generated pro.­nite groups II. Products in quasisimple groups. Ann. Math. 
165 (2007), 239 273. [Ol] J. E. Olson: On the sum of two sets in a group. J. Number Theory 18 (1984), 
110-120. [SarX] P. Sarnak, X. Xue: Bounds for multiplicities of automorphic representations. Duke Math. 
J. 64 (1991), 207-227. [Shv] A. Shalev: Word maps, conjugacy classes, and a non-commutative Waring-type 
theorem. Ann. Math. to appear [Shm] Y. Shalom: Bounded generation and Kazhdan s property (T). Publ. Math. 
IHES 90 (1999/2001) 145 168. [TaV] T. Tao, Van H. Vu: Additive Combinatorics. Cambridge University Press, 
2006. [Th] A. Thomason: Pseudo-random graphs. In: Proc. Conf. on Random Graphs, Pozna´n 1985. (M. Karo´nski, 
ed.) Annals of Discrete Math. 33 (North Holland 1987), 307 331. ¨ [Wig] E. P. Wigner: Uber die elastischen 
Eigen­schwingungen symmetrischer Systeme. Nachr. der Ges. der Wiss. zu G¨ottingen. Math-Phys. Kl. (1930) 
133 146. [Wil] J. S. Wilson: On simple pseudo.nite groups. J. London Math. Soc. 51 (1995), 471 490. 
 
			