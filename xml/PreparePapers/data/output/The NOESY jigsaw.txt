
 The NOESY Jigsaw: Automated Protein Secondary Structure and Main-Chain Assignment from Sparse, Unassigned 
NMR Data* Chris Bailey-Kellogg t Alik Widge t John J. Kelley, III t¢ Marcelo J. Berardi$ John H. Bushweller§ 
Bruce Randall Donald t¶ Abstract High-throughput, data-directed computational proto- cols for Structural 
Genom~cs (or Proteomzcs) are re-quired in order to evaluate the protein products of genes for structure 
and function at rates comparable to cur- rent gene-sequencing technology. This paper presents the JIGSAW 
algorithm, a novel high-throughput, auto- mated approach to protein structure characterization with nuclear 
magnetic resonance (NMR). JIGSAW ap- plies graph algorithms and probabilistic reasoning tech- niques, 
enforcing first-principles consistency rules in or- der to overcome a 5-10% signal-to-noise ratio. It 
con- sists of two main components: (1) graph-based sec-ondary structure pattern identification in unassigned 
heteronuclear NMR data., and (2) assignment of spec- tral peaks by probabilistic alignment of identified 
sec- ondary structure elements against the primary sequence. JIGSAW's deferment of assignment until after 
secondary structure identification differs greatly from traditional approaches, which begin by correlating 
peaks among dozens of experiments. By deferring assignment, JIG- SAW not only eliminates this bottleneck, 
it also allows the number of experiments to be reduced from dozens to four, none of which requires 13C-labeled 
protein. This in turn dramatically reduces the amount and expense *TAm research ~s supported by the following 
grants to B R D from the Natmnal Setenee Foundatmn NSF [I-9906790, NSF EIA- 9901407, NSF 9802068, NSF 
CDA-9726389, NSF EIA-9818299, NSF CISE/CDA-9805548, NSF IRI-9896020, NSF IRI-9530785, and by an eqmpment 
grant from Microsoft Research tDartmouth Computer Scmnce Department, Hanover, NH 03755, USA tDartmouth 
Chemtstry Department, Hanover, NH 03755, USA §Molecular Physmlogy and Biologmal Physms, Umverslty of 
V~r- gram, Charlottesville, VA 22906, USA ~Corresponding author 6211 Sudlkoff Laboratory, Dartmouth Computer 
Scmnce Department, Hanover, NH 03755, USA emazl brd@cs, dartmouth, edu Pemllssmn to make dlgltal or hard 
copra.,, of all or part oflhls x~olk for personal or clagsroom use ~s granted without lee p~o',~(lcd 
that cop~cs are not made or distributed for profit ol commclclal ad,,antage and that copies bear this 
notice and the full cltahon on the first page 1 o copy otherwise, to repubhsh, to post on seJa, ers o~ 
to redistribute to lists. of wet lab molecular biology for protein expression and purification, as well 
as the total spectrometer time to collect data. Our results for three test proteins demonstrate that 
we are able to identify and align approximately 80 per- cent of a-helical and 60 percent of ~-sheet structure. 
JIGSAW is very fast, running in minutes on a Pentium- class Linux workstation. This approach yields quick 
and reasonably accurate (as opposed to the traditional slow and extremely accurate) structure calculations, 
utiliz- ing a suite of graph analysis algorithms to compensate for the data sparseness. JIGSAW could 
be used for quick structural assays to speed data to the biologist early in the process of investigation, 
and could in principle be applied in an automation-like fashion to a large fraction of the proteome. 
 1 Introduction Modern automated techniques are revolutionizing many aspects of biology, for example, 
supporting extremely fast gene sequencing and massively parallel gene expres- sion testing (e.g. [4, 
14, 17]). Protein structure deter- mination, however, remains a long, hard, and expensive task. High-throughput 
structural genomics is required in order to apply modern techniques such as computer- aided drug design 
on a much larger scale. In particular, a key bottleneck in structure determination by nuclear magnetic 
resonance (NMR) is the resonance asszgnment problem --the mapping of spectral peaks to tuples of interacting 
atoms in a protein. For example, spectral peaks in a 3D nuclear Overhauser enhancement spec- troscopy 
(NOESY) experiment establish distance re-stramts on a protein's structure by identifying pairs of protons 
interacting through space. Assignment is also directly useful in techniques such as structure-activity 
relation (SAR) by NMR [27, 12], which compares NMR spectra for an isolated protein and protein-ligand 
com- plex. JtGSAW is a novel algorithm for automated secondary leqmres prior spcclt~c permission and,'or 
a lee structure and main-chain assignment. It has been suc- RECOMB 2000 Tokyo Japan USA Copyright ACM 
2000 1-58113-186-0/00/04 $5 00 33 cessfully applied to experimental spectra for three dif- ferent proteins: 
Human Glutaredoxin [29], Core Bind- ing Factor-Beta [15], and Vaccinia Glutaredoxin-1 [16] In order to 
enable high-throughput data collection, JIG- SAW utilizes only four NMR experiments: heteronuclear single 
quantum coherence spectroscopy (HSQC), H N- Ha-correlation spectroscopy (HNHA), 80 ms total cor- relation 
spectroscopy (TOCSY), and NOESY. This set of experiments requires only days of spectrometer time, rather 
than the months required for the traditional set of dozens of experiments. Furthermore, JIGSAW only requires 
a protein to be ~N-labeled, a much cheaper and easier process than 13C labeling. From a compu- tational 
standpoint, JIGSAW adopts a minimalist ap- proach, demonstrating the large amount of information available 
in a few key spectra. JIGSAW relies on two key insights: graph-based sec- ondary structure pattern discovery, 
and assignment by alzgnment. Atoms in regular secondary structure inter- act in prototypical patterns 
experimentally observable in a NOESY spectrum. Traditional NMR techniques determine residue sequentiality 
from a set of through- bond experiments, and then use NOE connectivities to test the secondary structure 
type of the residues. JIG- SAW, on the other hand, starts by looking for these pat- terns, and uses their 
existence as evidence of residue sequentiality. JIGSAW applies a set of first-principles constraints 
on valid groups of NOE interactions to man- age the large search space of possible secondary struc- ture 
patterns. Subsequently, JIGSAW assigns spectral peaks by aligning identified residue sequences to the 
protein's primary sequence. To do this, JIGSAW uses side-chain peaks identified in a TOCSY spectrum to 
estimate probable amino acid types for the residue se- quence. It finds such a sequence in the protein's 
primary sequence, and assigns the spectral data accordingly. In its philosophy of starting with NOESY 
connec-tivities, JIGSAW is in the same spirit as the partially automated Main-Chain Directed (MCD) approach 
of Wand and co-workers (e.g. [28, 8, 23]). MCD was de- veloped for homonuclear spectra, and was applied 
to experimental data for only one small protein, human Ubiquitin [28]. JIGSAW, in comparison, is fully 
auto- mated and has been successfully applied to experimen- tal heteronuclear spectra for three different 
larger pro- teins (for example, CBF-]~ is nearly twice the size of Ubiquitin). JIGSAW takes the steps 
necessary to deal with the significant amount of degeneracy in spectra for large proteins; it also provides 
a formal graph-theoretic framework for understanding and analyzing the algo- rithm. Finally, JIGSAW utilizes 
a novel TOCSY-based method for aligning residue sequences to the primary sequence. The JIGSAW and MCD 
approaches differ greatly from other (automated and partially automated) assignment protocols used today 
in the NMR community. Most modern approaches rely on a large suite of 13C-labeled triple resonance NMR 
spectra (e.g. HNCA, HNCACB, HN(CO)CACB, ... ), either to establish sequential con- nectivities by through-bond 
experiments (e.g. AUTOAS- SIGN [34] and PASTA [19]), or to match chemical shift patterns (e.g. [20] and 
[5]). 13C-labeling of a protein is an expensive and time-consuming task, making these approaches unsuitable 
for high-throughput structural studies. As discussed above, JIGSAW uses only four ex- periments and requires 
only 15N-labeling of a protein, a much cheaper process. In contrast, many modern automated assignment 
packages boot-strap the assignment process. For ex- ample, NOAH [21, 22] uses assignments from through- 
bond spectra to assign the NOESY. GARANT [1] corre- lates observed peaks across multiple spectra with 
peaks predicted by a sophisticated model. Partially-computed structures can be used to refine peak predictions 
(e.g. [13], [22], [24]). Solving the NMR jigsaw puzzle raises a number of interesting algorithmic pattern-matching 
and combina- torial issues. This paper presents an analysis of the problem, algorithms to solve it, and 
experimental re- sults. Section 2 reviews the information content avail- able in the NMR spectra used 
by JIGSAW. Section 3 presents the graph-based formalism and algorithm for finding secondary structure 
elements in NOESY spec- tra. Section 4 discusses the alignment process. Sec-tions 3.3 and 4.1 and Appendix 
A provide results on experimental data from three different proteins. 2 NMR Data NMR spectra capture 
interactions between atoms as peaks in ~2 or ~3, where the axes indicate resonance frequencies (chemical 
shifts) of atoms. In the 15N spec- tra used by JIGSAW, peaks correspond to an 15N atom, an H N atom, 
and possibly another 1H atom, of par- ticular resonance frequencies. JIGSAW takes as input, in addition 
to a protein primary sequence, lists of peak maxima and intensities, correlated across spectra. 1 Fig- 
ure 1 illustrates the experiments utilized by the JIGSAW algorithm: I-ISQC: An HSQC spectrum [3, pp. 
411-447] iden- tifies unique pairs of through-bond correlated I~N and H N atoms. Every residue has a 
unique such 15N-HN pair on the protein backbone; the coordinates for the pair are shared by all interactions 
within that residue and serve to reference interactions across all spectra. 2 1Automated peak picking 
is an interesting and well-studied s~gnal processing problem (e g AUTOPSY [18}) 2Some side chains, such 
as Gln, have their own lSN-HN pairs as well These can be removed m preprocessmg, or detected and handled 
specially W3 ...... I   C~:! H N H a (a) C 15r~ (b) Figure 1: Atom nomenclature and interactions 
in a pro- tein. (a) Through-bond interactions shown with dotted lines (HSQC: 15N-HN; HNHA: 15N-HN-Ha; 
TOCSY: tSN-HN-Ha-H~-...). (b) Through-space interactions in NOESY shown with wavy lines (daN solid and 
dNN dashed). HNHA: An HNHA spectrum [3, pp. 524-528] cap- tures interacting intraresidue through-bond 
t5N-HN-Ha; peak intensities estimate the J coupling constant 3JHNH, which is correlated with the ¢ bond 
angle of a residue. Since this angle is characteristically different for a-helices and/~-sheets, JIGSAW 
uses it as an estimator of the sec- ondary structure type.  TOCSY: A TOCSY spectrum [10] includes through- 
bond interactions with iH atoms on a residue's side chain; the 80 ms TOCSY in particular reaches many 
atoms on a residue's side chain. Since the chemical shifts of 1H atoms for different amino acid types 
are characteristically different, JIGSAW uses the shifts of a TOCSY as a "fingerprint" of the amino acid 
type.  NOESY: The 3D 15N-edited NOESY experiment [10] correlates an amide proton H N and its 15N with 
a second proton that interacts through space at a distance less than 6 ~, via the Nuclear Overhauser 
Effect (NOE). In the terminology of [31], a dNN interaction represents an HN-HNpair, while a dan interaction 
represents an H a- HNpair (see Figure l(b)); these can be distinguished by the characteristically different 
chemical shifts of H a and HTMatoms.  The main JIGSAW data structure, the NOESY zn-teraction graph, 
is an abstraction of a NOESY spec-trum that indicates potential residue interactions that could explain 
the peaks in a spectrum. Each 3D inter- residue NOE peak has the 15N and H N coordinates of one residue 
and the 1H coordinate of the H a or H N pro-ton of another residue. The HSQC indicates which is the first 
residue by its unique 15N and H N coordinates. The TOCSY and HNHA indicate residues whose H a or H N 
has the given 1H coordinate. Unfortunately, pro- jection onto the 1H dimension yields a large amount 
of spectral overlap --many protons have the same chemi- cal shift, within a tolerance. For example, there 
are 10- 20 possible explanations for each peak in the NOESY spectrum of CBF-f~ (see Section 3.3), yielding 
a 5-10% signal-to-noise ratio. This spectral overlap is the ma-jor source of complexity in the JIGSAW 
approach. The NOESY interaction graph captures the complete set of possible explanations for the peaks; 
the JIGSAW search algorithm then determines the correct ones. Definition 1 (NOESY Interaction Graph) 
A NOESY interaction graph G = (V, E) is a labeled, d~- rected multigraph w~th vert, ces V for residues 
and edges E C V × V × {dNN, daN} × ]~+ × ]~+ such that e = (vl,v2,t,m,d) E E ~ff there is a NOESY interactwn 
between a proton of Vl and a proton of v2 as follows: Interaction type t indicates a dan or dNN mterac-tzon. 
 Match score m is the 1H frequency d~fference be-tween the observed peak and the shift of the correlated 
 H a or H N. Atom distance d, computed from the NOE peak m- tensity, estzmates the proximity of the 
correlated atoms. A high match score suggests that a given edge, rather than one of its competitors, 
is the correct one. In practice, the NOESY interaction graph only includes edges for which the match 
score is below some threshold (e.g. 0.05 ppm). Different atom distances are expected for atom pairs in 
different conformations; (e.g. a pair of H N atoms in an a-helix is expected to be quite close). This 
data structure provides a more abstract view of the NOESY information than typical atom-based rep- resentations 
[31, 28], and is more amenable to search and analysis. 3 Graph-Based Secondary Structure Pattern Dis-covery 
In order to find the correct secondary structure of a protein from the highly ambiguous NOESY interaction 
graph, JIGSAW employs a multi-stage search algorithm that enforces a set of consistency rules in potential 
groups of edges The following subsections detail these consis- tency rules and the JIGSAW graph search 
algorithm.  3.1 NOESY Interaction Graph Constraints Figure 2 shows some prototypical NOE interactions 
in (a) an a-helix and (b) an anti-parallel fLsheet (after [31]). 3 3parallel ~-sheets have similar interactions, 
we illustrate JIGSAW'S approach by concentrating on anti-parallel B-sheets  35  -T-!- ~e . .... ,_, 
+-,° (a) V15 N ]~Zx /C a 15N ](~x /C __ + .k .t .t Cb) Figure 2: NOESY daN (solid) and dNN (dotted) 
inter- actions in (a) a-helices and (b) ~-sheets. Due to the way a helix is twisted, the H N of one residue 
is close to the H N residue of the next, and the H a of one residue is close to the H N of the residue 
one complete turn up the helix. Since a /3-sheet is more stretched out, only the Ha-H N sequential interactions 
are exper- imentally visible in the NOESY, but a rich pattern of cross-strand interactions are possible. 
Figure 3 repre- sents these patterns in NOESY interaction graphs, and enumerates the interactwn graph 
constraints imposed on these graphs by the geometry of helices and sheets. 4 While a NOESY interaction 
graph from experimen- tal data contains many false edges (and some miss-ing edges as well), the interaction 
graph constraints strongly limit how the correct edges fit together. For example, it is likely that a 
vertex will have several dNN edges to vertices that could follow it sequentially in an a-helix. However 
(see Figure 3), it is less likely that an incorrect next vertex also has a symmetric dNN edge, or that 
an incorrect sequence of vertices is also connected by an additional h+ -4 h~+3 daN edge, or that multi- 
ple such sequences adjoin each other. This insight of mutually inconsistent incorrect hypotheses is repeatedly 
utilized in the JIGSAW algorithm. 3.2 NOESY Interaction Graph Search The JIGSAW NOESY graph search uncovers 
secondary structure in an interaction graph G as a subgraph G* of G consistent with the interaction graph 
constraints. Since a globally consistent graph consists of repeating, locally consistent subgraphs, each 
of constant size, JIG- SAW does not have to solve a large subgraph isomor- phism problem for the entire 
secondary structure. Figure 4 illustrates the key steps of the JIGSAW graph 4Note that since the 12C~ 
is not NMR-active, d~N interactions are asymmetric 0 i ~ ~ 2 4 6 dNN hi J~t ht+:l  daN h, -'+ h,+3 
 (a) o i 2 ~ a a I~. 7¢ [" *' [" b ~: ¢¢ +'N '- {  dan a,---+a,+l, bt--+b.-1, c,--'~C,+l  daN. a2.--4b2,, 
b2t+l--~a2.+l, b2t--+ c2+, c21+l-"~ b2++l  dNN a2.+1 ++b2,, a21+l ++b2.+2, b2z+l +Zte2,, b2++1 ¢:'+e2t+2 
 (b) Figure 3: Interaction graphs (daN edges solid and dNN dotted) and constraints for (a) a-helices 
and (b) ~-sheets. This figure shows perfect patterns. Interac-tion graphs in experimental NMR data contain 
signifi- cant noise, manifested as some missing and many extra graph edges. search algorithm. Given an 
interaction graph, JIGSAW identifies small fragment subgraphs ("jigsaw pieces") satisfying the interaction 
graph constraints, merges them into a-helices and pairs of adjacent fl-strands, and col- lects the sequences 
into entire secondary structure rep- resentations. In practice, there are many incorrect frag- ments 
among the correct ones, but mutual inconsis- tencies generally keep them from merging into larger graphs. 
A final step is to rank the best solved jigsaws. The following subsections detail these steps. 3.2.1 
Identify Fragments The first step of JIGSAW is to find small, consistent subgraphs of an interaction 
graph. JIGSAW searches for fragment instances of a set of ]ragment patterns evident in canonical interaction 
graphs (Figure 3). Figure 5 illustrates some such fragment patterns. These patterns constrain the interaction 
type, match score, and atom distance for a set of edges, along with the ¢ bond angle (and thus secondary 
structure type) indicated by the HNHA for the vertices. Fragment patterns allow the possibility of missing 
edges in experimental data. The directions of the miss- ing edges are, however, determined by those of 
the other edges. For example, in Figure 5(b), patterns 3 and 4 are similar to patterns 1 and 2, respectively; 
the direc- tion of the missing vertical edge can be inferred from the correspondence. Fragments are identified 
by a straightforward graph search: for a pattern involving p edges, search from each r., (a) (b) (c) 
Figure 4: JIGSAW algorithm overview: (a) identify graph fragments, (b) merge them sequentially, and (c) 
collect them into complete secondary structure graphs. Only correct fragments are shown here. Graphs 
from experimental data also generate a large number of in- correct fragments, but mutual inconsistencies 
prevent them from forming either long sequences or large sec- ondary structure graphs. (a) (D/ .4 (~) 
(b) Figure 5: Interaction graph fragment patterns in (a) a-helices and (b) /~-sheets. node to depth 
p along paths that remain consistent with the pattern. Claim 1 (Computational Complexity of Fragment 
Pattern Identification) Given an interaction graph with n edges and maximum degree d, instances of a 
frag- ment pattern znvolving p edges can be identified zn tzme O(ndP). In practice (as demonstrated in 
Table 2 below), the in- teraction graph constraints greatly restrict the search, pruning most paths before 
they reach a depth of p. We assume that the fragment patterns generate a complete set of fragments. That 
is, any secondary struc- ture graph G* for a given interaction graph G can be formed from a union of 
the fragments identified in G. Due to the large number of incorrect edges, there can also be many incorrect 
fragments. It remains for the subsequent processing stages (below) to eliminate them. 3.2.2 Merge Sequentially-Consistent 
Fragments Given a set of fragment "jigsaw pieces" f, J;GSAW starts solving the puzzle of secondary structure 
by find- ing sequences of consistent fragments that together de- fine either an a-helix or two neighboring 
strands of a /~-sheet. To reduce the computational cost, it is pos- sible to identify a set of root fragments 
7 C_ ~- that satisfy stronger constraints, and to root the sequences at these fragments. Definition 2 
(Rooted Fragment Sequence) Gwen a set of fragments :7: for an interactzon graph G and a set of root fragments 
J:~ C ~, a rooted fragment se- quence F is a subgraph of G conszstent wzth the mter- actwn graph constraints 
for either a single a-hehx or a paw of adjacent/~-strands, and formed from the unzon of a set ofn fragments 
F = {fl, f2,.--, fn} C J:, where fl E 7. Fragment sequences are computed by a straightfor- ward exhaustive 
search from the root fragments. In the worst case there are an exponential number of se- quences --if 
any fragment can connect to any other, then there are [~'[! possible such sequences. However, as with 
fragment pattern identification, the interaction graph constraints strongly limit the possible sequences, 
and in practice (supported by Table 2) each initial frag- ment generates a fairly small number of sequences. 
The completeness of fragment sequences follows im- mediately from the assumed completeness of fragments, 
if there is at least one root fragment per helix or strand pair. Claim 2 (Completeness of Fragment Sequences) 
Any secondary structure graph G* for a given znterac- tion graph G zs a union of the fragment sequences 
for the fragments J: ~n G. 3.2.3 Collect Consistent Sequences To obtain an entire, consistent secondary 
structure graph for the protein, JIGSAW forms unions of consistent frag- ment sequences. Imposing directionality 
--first iden- tifying sequences and then joining them --greatly re- duces the size and redundancy of 
the search space. While the merging step is worst-case exponential in the num- ber of fragment sequences, 
the interaction graph con-straints again bring the search space down to a man- ageable size (see Table 
2). Since a secondary structure graph is computed as the union of fragment sequences, the completeness 
result follows immediately from Claim 2. Claim 3 (Completeness of Secondary Structure Graphs) JIGSAW 
finds all consistent secondary struc- ture graphs G* for a gzven mteraetwn graph G. 3.2.4 Identify Best 
Secondary Structure Graphs The final step in the JIGSAW graph search is to iden- tify the best secondary 
structure graphs from the set of collected possibilities. Intuitively, the algorithm should produce a 
large graph, reaching all the vertices expected to belong to the given secondary structure type. Smaller 
graphs probably were not expanded due to inconsis-tencies. Furthermore, as many of the expected edges 
as possible should belong to the graph (vertices should have high degree), and should have good match 
scores. This intuition is formalized with a probabilistic mea- sure of a graph's correctness. For simplicity, 
we assume a Gaussian a prwri probability that an edge e indicates the correct interaction represented 
by a spectral peak, based on comparison of 1H chemical shifts (recall that the match score re(e) encodes 
the difference --see Defi- nition 1); it remains interesting future work to incorpo- rate actual spectral 
"line shapes" [18] into this analysis. Normalization over all edges for a peak yields the prob- ability 
that a particular edge is a good explanation for the peak. This yields a higher probability when a peak 
closely matches, and when it doesn't have many good competitors. P(interaction(e)) = Ga(m(e)) (1) P(interaction(e)) 
P(good(e)) = ~e,¢a P(interacti°n(e~)) (2) The correctness probability for a secondary structure graph 
G* depends the goodness of its edges: P(correct(G*)) = 1 - H (1 - P(good(e))) (3) e6G* The correctness 
probability can be applied during fragment sequence enumeration (Section 3.2.2) and sec- ondary structure 
graph construction (Section 3.2.3), in order to prune graphs with too little support (correct-ness probability 
too low for the graph size). 3.3 Experimental Results JIGSAW was tested on experimental data for Human 
Glutaredoxin (huGrx) [29], Core Binding Factor-Beta (CBF-~) [15], and Vaccinia Glutaredoxin-1 (vacGrx) 
[16]. 5 15N-edited HSQC, HNHA, 80 ms TOCSY, and NOESY spectra were collected on a 500MHz spectrometer 
and processed with the program PROSA [11]. Peaks were picked manually and in a semi-automated fashion 
with the program XEASY [2]. JIGSAW was invoked with the appropriate primary sequences and ASCII peak 
lists, referenced across spectra. 6 In order to distinguish the dependence on HNHA from the dependence 
on NOESY, JIGSAW was run with two spectral suites: the first with simulated J-coupling constants indicative 
of the known secondary structure, and the second with J-coupling constants computed from the experimental 
HNHA data; all other spectra were the same in the two suites. JIG-SAW used the patterns of Figure 3 with 
a set of generic constraints on match score and atom distance. Com-putation took about one to ten minutes, 
depending on the protein. As an illustration, Figure 6 depicts the ~-sheets JIG- SAW uncovered for CBF-/3, 
a 141-residue protein. (An optional appendix for the interested reader depicts the c~-helix results for 
all three proteins and the ~-sheet re- sults for the other two proteins.) JIGSAW correctly un- covers 
a significant portion of the B structure, particu- larly in well-connected portions of the graph. Note 
that ~-sheets are tertiary structure, indicating more than just the sequentiality of their strands. Table 
1 summarizes the results for all three proteins in terms of the number of correct, extra (but still se- 
quential), and incorrect edges discovered by JIGSAW, compared to the actual edges known from the litera- 
ture. Recall that edges correspond to NOESY peaks, and thus represent interpretations of portions of 
the spectrum. With spectral suite 2, JIGSAW is less ac-curate about the extent of a helix or strand; 
however, the actual extent is ambiguous, and extending to ad- ditional sequentially-connected residues 
can be benefi- cial by providing additional assignments. The/3-sheet peaks for both huGrx and vacGrx 
are so sparse (see the appendix for illustrations) that JIGSAW identifies little to no /3 structure. 
In general, it is much harder to uncover /%sheets than (~-helices, since ~-strand se-quentiality is specified 
by the much noisier H a region of the spectrum. We expect proteins with significant ~-sheet content, 
such as CBF-B, to have enough con-nectivity to support the mutually confirming JIGSAW graph patterns. 
Table 2 demonstrates that, due to the interaction 5Wh~le huGrx and vacGrx have simxlar structures, their 
expem- mental spectra have slgmficant &#38;fferences 6For CBF-B, JIGSAW uses manually-computed J-constants, 
follow- mg the NMR protocol of [15] C 71 ,-o 104 II- ~" 108 ~I, 130 55 O~. "~.. -~ 60 68"~" *" ~" 
65 Figure 6: 3-sheets of CBF-~ computed by JIGSAW. Edges: solid=correct; dotted=false negative; X=false 
positive. II huGrx 3. CBF-B 80 Correct 70, 65 72, 62 63, 63 % Correct 85%, 79% 100%, 86% 79%; 79% Extra 
seq 0, 0 0, 12 0, 8 Incorrect 0, 0 0, 4 (a) 0, 0 L [[ huGrx CBF-3 89 Actual I 28 Correct ] 3, 13 58; 
54 % Correct 46%, 46% 05%, 60% Extra seq 0, 0 0, 0 Incorrect 0, 0 0, 2 (b) Table 1: Summary of results 
for JIGSAW secondary structure discovery ((a) (~-helices and (b) 3-sheets), for spectral suites 1 (first) 
and 2 (second). huGrx CBF-3 vacGrx L Edges Fragments Root fragments Fragment sequences 2cry structure 
graphs (a) huGrx CBF-3 ments t fragments ment sequences structure graphs (b) Table 2: Combinatorics 
of JIGSAW secondary structure discovery for (a) c~-hehces and (b) 3-sheets. graph constraints, the actual 
combinatorics of JIGSAW are much better than the worst-case exponential pos- sibility. Notice that JIGSAW 
efficiently explores one to two thousand edges ( Table 2, line 1) to find less than one hundred correct 
ones (Table 1, lines 1-2). 4 Fingerprint-Based Sequence Alignment Fingerprint-based sequence alignment 
finds sets of se- quential residues in the protein sequence correspond- ing to the vertex sequences identified 
by the JIGSAW graph search algorithm. This process utilizes the 80 ms TOCSY (refer again to Section 2), 
which identifies a "fingerprint" of ~H atoms7 Definition 3 (Fingerprint) A fingerprint is a set of 1H 
chemical shzfts from a residue. Note that fingerprints are of small, fixed size. The BioMagResBank (BMRB) 
has collected statis- tics from a large database of observed chemical shifts [26]. Figure 7 shows the 
mean chemical shifts for the pro- tons of the 20 different amino acid types. The chemical shifts are 
affected by local chemical environment, which includes amino acid type and secondary structure. The chemical 
shift index (CSI) has successfully used this information to predict secondary structure type given chemical 
shift and amino acid type [30]. JIGSAW takes a different approach: it "inverts" the BMRB to pre- dict 
amino acid type given chemical shift and secondary structure type. The first step in alignment is to 
match each vertex's fingerprint with the canonical BMRB fingerprints. Due to extra and missing peaks, 
only a partial match might be possible. Definition 4 (Partial Fingerprint Match) A partial fingerprint 
match between vertex fingerpmnt Sv and BMRB 7The mare-chain 15N chemmal shift can also be included m 
the fingerprint 39 O 'VV. '°I o  0 ! 't I e 0 o eee ~$ o e  ° o O :ol 8 o o H Figure 7: BMRB 1H mean 
chemical shifts over differ- ent amino acid types. These shifts define "fingerprints" for the expected 
TOCSY peaks of different amino acid types; the fingerprint for His is isolated as an example. am,no aczd 
fingerprint Sa (a E A = {hla, hrg,...}), zs a bzjectzon m : Sv' -4 S a~ between subsets Sv ~ C Sv and 
S~' C_ Sa. Partial fingerprint matches are scored based on how well corresponding points match, together 
with penal- ties for extra and missing points. Assuming Gaussian noise around the expected chemical shift, 
with standard deviation a~ for amino acid type a, the match score is defined as follows: partial(Sv',Sa') 
= CoJSv - Sv'l + Cl[Sa -Sa'l "t-c2 H Ga.(P-ra(p)) (4) pES. ~ where Co, cl, c2 are weighting factors. 
The match score for a vertex and amino acid type is defined as the best partial fingerprint match score; 
normalization yields the probability that a vertex is of a given amino acid type. match(Sv, Sa) = max 
partial(S~', S~') (5) SJ CS~,SJ CS~ P(type(v,a)) = match(Sv,Sa) (6) ~beA match(S~, Sb) Then the probability 
that a sequence of vertices V = (vl,v2,...vn) aligns at position r in the primary se-quence L (where 
r _< ILl - IVI) is the joint type proba- bility over corresponding vertices and amino acid types. The 
best alignment for a sequence of vertices V relative to a primary sequence s is the position r maximizing 
the probability. P(align(Y, s, r)) = HP(type(%'sr+~-l)) (7) alignment(V, s) = max P(align(V, s, r)) (8) 
r<ILI-WI Sequence Snnulated Exper|mental Rank I P Rank I P (~1 10-16 1 9 10 a 1 3 10 z (~2 18-23 1 2 
104 17 4 10 -6 (~3"34-36 1 4 101 3 7 10 -2 c~4 43-52 1 1 1013 1 2 104 a5 131-140 1 7 1014 1 1.101° /~1A:27-31 
1 4 103 5 3 10 -2 (~1,2.55-60 1 2 106 1 2 104 /31,3 65-68 1 2 101 1 1 103 ~2,1 96-104 1 2 - 101 1 7 102 
2,2 108-117 1 4 101° 11 3 10 -5 fi32,3,122-130 1 3 104 5 1 10 -1 Table 3: Fingerprint-based alignment 
results for a-helices and ~-strands of CBF-fl, with both simulated and experimental TOCSY data. p indicates 
the rela- tive score of the alignment -- relative to either the best alignment, if the correct one is 
not best, or else to the second-best alignment. [ II huGrx I CBF-/~ I vaeGrx I I Correct (simulated TOCSY) 
8/9 11/11 8/9 Table 4: Fingerprint-based alignment results summary for both simulated and experimental 
TOCSY data. 4.1 Experimental Results Table 3 details the results of fingerprint-based align- ment for 
the TOCSY shifts of known a-helices and ~-strands in CBF-f~ (the appendix provides details for huGrx 
and vacGrx). Table 4 summarizes the number of correct alignments for all three proteins. The sim- ulated 
TOCSY is produced from the known chemical shifts of the side-chain protons (correlated among many other 
spectra). While experimental TOCSY yields good alignment results, the simulated results demonstrate that 
as pulse sequences improve (see e.g. [32, 33]), the experimental results should get even better. In general, 
long sequences align better than short ones, although unusually noisy data can disrupt the alignment. 
5 Conclusions and Future Work This paper has described the JIGSAW algorithm for au- tomated high-throughput 
protein structure structure de- termination. JIGSAW uses a novel graph formalization and new probabilistic 
methods to find and align sec- ondary structure fragments in protein data from a few key fast and cheap 
NMR spectra. A set of first-principles graph consistency rules allow JIGSAW to manage the search space 
and prevent combinatorial explosion. JIG- SAW has proven successful in structure discovery and alignment 
with experimental data for three different proteins. One avenue of future work is a random graph analy- 
sis of JIGSAW using a statistical model of the noise in an interaction graph to compute the probable 
correctness and completeness of secondary structure graphs. An- other avenue is to apply iterative deepening 
[25, pp. 70- 71] to generate additional fragments, for example, due to suggestions by a statistical secondary 
structure pre- dictor (e.g. [7, 6]), circular dichroism data [9], or feed- back from fingerprint-based 
alignment. JIGSAW has only been run on the three proteins reported above. We plan to apply JIGSAW to 
experimental data for ad- ditional proteins, and to extend the techniques to anal- ysis of DNA NMR data. 
We invite structural biologists desiring a fast structural assay to contact us if they wish to run JIGSAW. 
Finally, the JIGSAW technique could be extended to assign side chains and to compute the global fold 
of a protein. Spectral referencing be- tween TOCSY and NOESY gives an indication of which NOESY peaks 
belong to a given residue; additional in- terresidue interactions could then be identified in the NOESY 
and used to constrain the global geometry of a-helices and ~-sheets. Acknowledgments We are very grateful 
to Xuemei Huang and Chaohong Sun for contributing their NMR data on huGrx and CBF-~ to this project, 
for many helpful discussions and suggestions, and to Xuemei for running an invaluable new I~N-TOCSY experiment 
for us. We would also like to thank Cliff Stein, Tom£s Lozano-P~rez, Chris Langmead, Ryan Lilien, and 
all members of Donald Lab for their comments and suggestions. References [1] C. Bartels, P. Giintert, 
M. Bileter, and K. Wiithrich. GARANT--a general algorithm for resonance assignment of multidimensional 
nuclear magnetic resonance spectra. Journal of Computatwnal Chemistry, 18:139-149, 1997. [2] C. Bartels, 
T.-H. Xia, M. Billeter, P. Giintert, and K. Wiithrich. The program XEASY for computer-supported NMR spectral 
analysis of bi- ological macromolecules Journal of Bzomolecular NMR, 5:1-10, 1995. [3] J. Cavanagh, W.J. 
Fairbrother, A.G. Palmer III, and N.J. Skelton. Protein NMR Spectroscopy: Pmnczples and Practzce. Academic 
Press Inc., 1996. [4] T. Chen, V. Filkov, mid S. Skiena. Identifying gene regulatory networks from experimental 
data. In Proc. RECOMB, pages 94-103, 1999. [5] D. Croft, J. Kemmink, K.-P. Neidig, and H. Os- chkinat. 
Tools for the automated assignment high- resolution three-dimensional protein NMR spectra based on pattern 
recognition techniques. Journal of Biomolecular NMR, 10:207-219, 1997. [6] J.A. Cuff, M.E. Clamp, A.S. 
Siddiqui, M. Fin-lay, and G.J. Barton. JPRED: A consensus sec- ondary structure prediction server. Bwmformatzcs, 
14:892-893, 1998. [7] G. Dealeage, B. Tinland, and B. Roux. A comput- erized version of the Chou and 
Fasman method for predicting the secondary structure of proteins. An-alytzcal Bzochemzstry, 163(2):292-297, 
June 1987. [8] S.W. Englander and A.J. Wand. Main-chain di- rected strategy for the assignment of 1H 
NMR spec- tra of proteins. Biochemistry, 26:5953-5958, 1987. [9] A. Galat. A note on circular-dichroic-constrained 
prediction of protein secondary structure. Euro-pean Journal of Biochemzstry, 236:428-435, 1996. [10] 
A.M Gronenborn, A. Bax, P.T. Wingfield, and G.M. Clore. A powerful method of sequential pro- ton resonance 
assignment in proteins using relayed 15N-1H multiple quantum coherence spectroscopy. FEBS Letters, 243:93-98, 
1989. [11] P. Giintert, V. DStsch, G. Wider, and K. Wiithrich Processing of multi-dimensional NMR data 
with the new software PROSA. Journal of Biomolecular NMR, 2:619-629, 1992. [12] P.J. Hajduk, R.P. Meadows, 
and S.W. Fesik. Drug design: Discovering high-affinity ligands for pro- teins. Science, 278:497-499, 
1997. [13] B.J. Hare and G. Wagner. Application of auto- mated NOE assignment to three-dimensional struc- 
ture refinement of a 28 kD single-chain T cell re- ceptor. Journal of Biomolecular NMR, 15:103-113, 1999. 
[14] E. Hartuv, A. Schmitt, J. Lange, S. Meier-Ewert, H. Lehrach, and R. Shamir. An algorithm for clus- 
tering cDNAs for gene expression analysis. In Proc. RECOMB, pages 188-197, 1999. [15] X. Huang, N.A. 
Speck, and J.H. Bushweller. Com- plete heteronuclear NMR resonance assignments and secondary structure 
of core binding factor (1-141). Journal of Biomolecular NMR, 12:459-46O, 1998. [16] J.J. Kelley III and 
J.H. Bushweller. 1H, 13C, and 15N NMR resonance assignments of vaccinia glutaredoxin-1 in the fully reduced 
form. Journal of Bzomolecular NMR, 12:353-355, 1998. [17] R.M. Karp, R. Stoughton, and K.Y. Yeung. Al-gorithms 
for choosing differential gene expression experiments. In Proc. RECOMB, pages 208-217, 1999. [18] R. 
Koradi, M. Billeter, M. Engeli, P. Giintert, and K. Wiithrich Automated peak picking and peak integration 
in macromolecular NMR spectra us-ing AUTOPSY. Journal of Magnetic Resonance, 135:288-297, 1998. [19] 
M. Leutner, R. Gschwind, Jens Liermann, C. Schwarz, G. Gemmecker, and H. Kessler Au-tomated backbone 
assignment of labeled proteins using the threshold accepting algorithm. Journal of Bwmolecular NMR, 11:31-43, 
1998. [20] J.A. Lukin, A.P. Gove, S.N. Talukdar, and C. Ho. Automated probabilistic method for assigning 
backbone resonances of (13C, 15N)-labeled pro-teins. Journal of B,omolecular NMR, 9"151-166, 1997. [21] 
C. Mumenthaler and W. Braun. Automated as-signment of simulated and experimental NOESY spectra of proteins 
by feedback filtering and self- correcting distance geometry. Journal of Molecular Bzology, 254:465-480, 
1995. [22] C. Mumenthaler, P. Giintert, W. Braun, and K. Wiithrich. Automated combined assignment of 
NOESY spectra and three-dimensional protein structure determination. Journal of Bwmolecular NMR, 10:351-362, 
1997. [23] S. Nelson, D. Schneider, and A.J. Wand. Imple-mentation of the main chain directed assignment 
strategy. Bwphys. J., 59:1113-1122, 1991. [24] D. Pearlman. Automated detection of problem re- straints 
in NMR data sets using the FINGAR ge- netic algorithm method. Journal of Bwmolecular NMR, 13:325-335, 
1999. [25] S. Russell and P. Norvig. Artificial mteU~gence: a modern approach. Prentice-Hall, 1995. [26] 
B.R. Seavey, E.A. Farr, W.M. Westler, and J.L. Markley. A relational database for sequence-specific protein 
NMR data. Journal of B, olmolec- ular NMR, pages 217-236, 1991. [27] S.B. Shuker, P.J. Hajduk, R.P. Meadows, 
and S.W. Fesik. Discovering high-affinity ligands for proteins: SAR by NMR. Sczence, 274:1531-1534, 1996. 
[28] D.L. Di Stefano and A.J. Wand. Two-dimensional 1H NMR study of human ubiquitin: a main-chain directed 
assignment and structure analysis. Bw-chemistry, 26:7272-7281, 1987. [29] C. Sun, A. Holmgren, and J. 
Bushweller. Complete 1H, 13C, and I~N NMR resonance assignments and secondary structure of human glutaredoxin 
in the fully reduced form. Protein Science, 6:383-390, 1997. [30] D.S Wishart, B.D. Sykes, and F.M. 
Richards. The chemical shift index: a fast and simple method for the assignment of protein secondary 
struc-ture through NMR spectroscopy. Bzochemzstrg, 31(6):1647-1651, February 1992. [31] K. Wiithrich. 
NMR of Proteins and Nucleic Acids. John Wiley &#38; Sons, 1986. [32] G. Zhu, X.M. Kong, and K.H. Sze. 
Gradient and sensitivity enhancement of 2D TROSY-based ex- periments. Journal of Bwmolecular NMR, 13:3-10, 
1999. [33] G. Zhu, Y. Xia, K.H. Sze, and X. Yan. 2D and 3D TROSY-enhanced NO ESY of 15 N-labeled proteins. 
Journal of Bwmolecular NMR, 14:377-381, 1999. [34] D.E. Zimmerman, C.A. Kulikowsi, Y. Huang, W. Feng, 
M. Tashiro, S. Shimotakahara, C. Chien, R. Powers, and G. Montelione. Automated analysis of protein NMR 
assignments using methods from artificial intelligence. Journal of Molecular Biology, 269:592-610, 1997. 
 A Additional Details for Experimental Results A.1 Secondary Structure Graphs This section details the 
a-helices and/%sheets uncov-ered by JIGSAW as summarized in Table 1. Figures 8, 9, and 10 depict the 
a-helices uncovered by JIGSAW in CBF-~, huGrx, and vacGrx, respectively, with both suites of spectra. 
The results are similar for both suites, except that a-helices in suite 2 sometimes extend past or fail 
to reach the end of an a-helix or/%strand, due to misleading J constants. In vacGrx under suite 2, an 
additional potential rigid piece of secondary structure is uncovered, extending from residue 48 to residue 
51. Figure 11 shows the E-sheets uncovered by JIGSAW in huGrx with suite 2. The results with suite 1 
are identical; in both cases, connectivity in the lower two strands is too sparse for JIGSAW. The /~-sheet 
results for CBF-/~ with suite 1 are the same as in Figure 6, but with the correct edges to residue 100 
rather than the incorrect edges to 101 and 71. Figure 12 shows that the NOESY connectivities for /%sheets 
in vacGrx are too sparse for general-purpose JIGSAWpatterns to detect. A.2 Fingerprint-Based Alignment 
This section details the fingerprint-based alignment re- sults of huGrx and vacGrx that contributed to 
Table 4. Tables 5 and 6 list the fingerprint-based alignment re-sults for huGrx and vacGrx, respectively. 
As with CBF- /~, simulated TOCSY data yields almost perfect results, while experimental TOCSY data results 
are somewhat degraded. 10 o e~~o~o~o-"~o 16 10 ~o-"~'-"o--:"'~"o o "O : -.,'0: -¢ "4, 16 73 74 18" 
" -'" 18 e. " "c~ 24 34 e= " " -"Q 36 34 . " * o ". " o 37 43 o ~ ~ e ~ o 52 40 o. "o-"('-"*----L"-''-~--2-'-'-----'------'--e=----'L-------O=---~O~ 
53 131 " ~7~~'~ 140 131 ~ o ~, " :. % -~'o 140 (2/ Figure 8: a-helices of CBF-# computed by JIGSAW, 
using spectral suites 1 and 2. Edges: solid=correct; dotted=false negative; X=false positive. Vertices: 
solid=correct; empty=sequentially correct but not in a-helix. 4 ~ ' : "'-"e 9 25 "- "'~ -'~. ", ., ".~___..__.Z_..___.._.Z_o 
34 25 o. " -"-~...----...--Z..~....__.~ ~ 34 54 o. o. ~v "o 65 54 ~'- J. " "e 65 83  e. ~ . ~ ~o 
91 83  ~: ~'-~o "o 91 ,, '~~ u 94 e. " ~t "~* 100 94 ": " " =~ :~'~ --~' 103 (1) (2) Figure 9: a-helices 
of huGrx computed by JIGSAW, using spectral suites 1 and 2. Edges: solid=correct; dotted=false negative. 
Vertices: solid=correct; empty=sequentially correct but not in a-helix. " = ° . 3 e. . ~ "o,, "o 8 3 
 o.  ".. "o 8 " ~a_.__~.~..~, ~ ~ 25 0- -L " -35 " o~o~.~, 25 o:. -- 34 54 ~ ~4~~~o 63 54 e. "e~'/~~~~o 
63 83 o. "o~~o 91 83 o. - . ~'.. "~o 91 94 o. " "~~e "e. 101 94 @. " . ...-"~" ~o. "o I01 48 u. 
'~. ~o 51 (1) (2) Figure 10: a-helices of w~cGrx computed by JIGSAW, using spectral suites 1 and 2. 
Edges: solid=correct; dot- ted=false negative. Vertices: solid=correct; empty=sequentially correct but 
not in a-helix. 43 "~-i ~ ~ -/ 47 15~ --19 75,o-"o--q~" ~# 72 78o" '~ "~' 80 Figure 11: E-sheets of 
huGrx computed by JIGSAW, us- ing spectral suite 2. Edges: solid=correct; dotted=false negative. 43__7 
 = =~ 20 78 74~~80 ~ 72 Figure 12: Known /%sheet connectivities in vacGrx. The connectivities axe too 
sparse for the generic JIG- SAW algorithm to uncover much structure. Simulated Experimental Rank ] p 
Rank [ p Sequence i 31:4-9 1 7 10 7 1 1 l0 b c~2:25-34 1 5 10 IT 1 8 10 6 or3 "54-65 1 1 10 le 1 9 
 10 TM c~4 "83-91 1 4 10 5 1 2 10 4 c~5 94-100 1 2 l0 T 2 2 10 -1 /~1,1 43-47 1 1 . 103 3 7 - 10 -3 
B1,2 15-19 1 2.10 3 1 3 -10 3 Bi.3 72-75 1 1 10 s 4 2 10 -2 /~1,4 78-80 2 2 10 -1 4 4 - 10 -2 Table 
5: Fingerprint-based alignment results for c~-helices and E-strands of huGrx, with both simulated and 
experimental TOCSY data. p indicates the rela- tive score of the alignment -- relative to either the 
best alignment, if the correct one is not best, or else to the second-best alignment. Sequence Simulated 
Experimental Rank I P Rank I p or1 3-8 1 2 10 x° 5 3 10 -z c~2 25-34 1 1 1011 2 3 10 -1 c~3 54-63 1 1 
 1032 1 2 IO 3 oz4 83-91 1 7 1013 4 5 10 -3 or5 94-101 1 1 105 3 2 - 10 -2 J31,1 42-47 1 4 101 1 2 
101 /~1,2"14-20 1 3 103 15 3 10 -8 /31,3 72-74 1 4 102 10 5 10 -4 ]~1,4 78--80 12 2 10 -3 1 1 " 103 Table 
6: Fingerprint-based alignment results for a-helices and B-strands of vacGrx, with both simulated and 
experimental TOCSY data. p indicates the rela- tive score of the alignment -- relative to either the 
best alignment, if the correct one is not best, or else to the second-best alignment.  
			