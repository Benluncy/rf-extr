
 Abstract ew ybe­ eev ew ec ew ,ho  Num. Topics queries uniquequery   8143(7703) 412 percentagesofqueriesthattoptopicsaccountfor 
   100 200 500 2000 21.2% 41.5% 54.1%   Num. Topics Num. unique occurringmorethanmorethanone  
 queries queries once 499836(444899) 365276(320987) 249405 52733(21%) percentagesofqueriesthattoptopicsaccountfor 
500 1000 5000 10000 20000 12.3% 16.0% 27.9% 34.4% 42.0% (b)QuerylocalityintheExcitelog. Table1:QuerylocalityinTHOMASandExcitelogs 
Theclosestworktoselectingarelevantpartialreplicawhich andshowthatitisefectiveandimprovesperformance. 
isasubsetoftheoriginalcollectioniscollectionselection,i.e., 3AccessCharacteristicsinRealSystems locatingthemostrelevantcollections[6,8,10,13,15,21], 
ThemostoftenusedqueriesforevaluatingIRsystemsarewherecollectionsaredisjointed.Replicaselectiondifersalso 
theTRECqueries[16].However,eachqueryinTRECis becauseitdirectsasmanyqueriesaspossibletorelevant unique.Toevaluatepartialcollectionreplication,wein­ 
replicasinordertoobtainperformanceimprovements. steadneedtypicalsetsofquerylocalitypatterns.Other Danzigetal.[10]useahierarchyofbrokerstomaintain 
researchershaveexaminedquerylocalityinthecontextofindicesfordocumentabstractsasarepresentationofthe theWeb[9,17],butcurrentlythereexistsnowidelyavailable 
contentsofprimarycollections,andsupportBooleankey­orstandardsetofquerieswithlocalityproperties.Wethere­ 
wordmatchingtolocatetheprimarycollections.Ifusers' foreobtainedourownsetofserverlogsfromTHOMAS[18], queriesdonotusekeywordsinthebrokers,theyhavedif­andExcite[12].TheTHOMASsystemisalegislativein­ 
cultyfndingtherightprimarycollections. formationserviceoftheU.S.CongressthroughtheLibrary Voorheesetal.exploitsimilaritybetweenanewquery 
ofCongress.THOMAScontainsthefulltextcongressional andrelevancejudgmentsforpreviousqueriestocomputethe 
recordsandintroducedtheto numberofdocumentstoretrievefromeachcollection[21]. billsfrom101stCongress 105thCongress.WeanalyzetheTHOMASlogsbetween 
Netserfextractsstructured,disambiguatedrepresentations July14andSeptember13,1998.Weobtainedfulldaylogs 
fromthequeriesandmatchesthesequeryrepresentationsto for40days,andpartiallogsforremaining22daysduetoin­hand-codedrepresentations[8].Voorheesetal.andNetserf 
sufcientdiskspaceinthemaileratthelibraryofCongress. requiremanualinterventionwhichlimitsthemtorelatively 
TheExcitesystemprovidesonlinesearchformorethan50staticandsmallcollections. millionWebpages,andweobtainedonedayofloginforma­Fuhrproposesadecision-theoreticapproachtosolvecol­tionforSeptember16,1997. 
lectionselectionproblem[13].Hemakesdecisionsbyusing Sincethelogsdonotcontaindocumentidentifersre­theexpectedrecall-precisioncurve,expectednumberofrel­turnedfromqueryevaluation,webuiltourowntestdatabases. 
evantdocuments,andcostfactorsforqueryprocessingand Wedefneatopicasallquerieswhosetop20documents documentdelivery.Hedoesnotreportonefectiveness. 
completelyoverlap.ForqueriesfromtheTHOMASlog,we GLOSSusesdocumentfrequencyinformationforeach reranallqueriesagainstatestdatabasethatusestheCon­collectiontoestimatewhether,andhowmany,potentially 
gressionalRecordsforthe103rdCongress(235MB,27992relevantdocumentsareinacollection[14,15].Theap­ documents,asubsetoftherealdatabase).Forqueriesfrom 
proachiseasilyappliedtolargenumbersofcollections,since theExcitelog,wereranallqueriesagainstatestdatabaseitstoresonlydocumentfrequencyandtotalweightinforma­usingdownloadsofthewebsitesoperatedbytenAustraliantionforeachtermineachcollection.Howeveritsefective­ 
Universities(725MB,81334documents). nessremainsunknownduetolimitedevaluation. Table1showsthestatisticsonquerylocalityintheCallanetal.adaptthedocumentinferencenetworkto 
THOMASandExcitelogs.Wecollecttheaveragenumber rankingcollectionsbyreplacingthedocumentnodewith ofqueries,uniquequeries,topics,topicsoccurringonce,top-thecollectionnode[6].SimilartoGLOSS,theinformation 
icsoccurringmorethanonce,andtopicsthatcontainmorestoredinthecollectionrankinginferencenetworkisdocu­thanoneuniquequery.Wealsopresentthepercentagesof 
mentfrequenciesandtermfrequenciesforeachtermineach queriesthatcorrespondtothetoptopics.Table1(a)shows 
collection.ExperimentsusingtheInQueryretrievalsystem theaveragenumbersintheTHOMASlogsover40days andthe3GBTREC1+2+3collectionshowthatusingthis 
withfulldaylogs.Thenumbersofqueriesthatactually methodtoselectthetop50%ofsubcollectionsattainssimi­fnddocumentsfromourtestdatabaseareinparentheses 
larefectivenesstosearchingallsubcollections. incolumns1and2.Somequeriesdonotfndanydocu- Noneoftheabovecollectionselectionalgorithmsconsider 
ments,duetomisspelling,orbecausequerytermsdonotreplicasandpartialreplicas.Amongtheapproachesforcol­ existinthetestdatabase.Thestatisticsshowthatonthe 
lectionselection,thecollectioninferencenetworkmodel[6] average,71%oftopicsoccuronce,andtheremaining29%isthemostthoroughlytestedandefective.Inthispaper,we 
oftopicsaccountfor63%ofqueries.Amongthetopicsthat modifythistechniquetorankpartialreplicasandtheorigi­occurmorethanonce,35%(412)containsmorethanonenalcollection,proposeanewalgorithmforreplicaselection, 
 uniquequery,whichindicatesthatexactlymatchingqueries wouldnotfndthisoverlap,andcachingqueriesmaymiss 
queriesthatusediferenttermsbutinfactreturnthesame topdocuments. TheExcitelogonSeptember16,1997,showninTa­ble1(b),demonstratesthattheExcitequeriesalsohavehigh 
querylocality:79%oftopicsoccuronce,andtheremaining 21%oftopicsaccountfor56%ofqueries;amongthetopics thatoccurmorethanonce,62%(32750)containmorethan 
oneuniquequery,whichistheoverlapmissedbyexactly matchingqueries. WealsoexaminetheTHOMASlogsfortheratioofquery 
processingtodocumentaccess.Foreachquery,ontheav­erage,theuserviews1.9documents.Sincewedonothave systemmeasurementsoftheTHOMASsystem,weestimate 
thepercentageoftimeusedforqueryanddocumentprocess­ingbysimulatingtheratioofqueriestodocumentsobtained 
fromthelogs,andrerunningthetop1000uniquequeriesis­suedonJuly14,1998againstthetestdatabase.Thesystem measurementsshowthatthequeryprocessingaccountsfor 
44%oftotalprocessingtime,anddocumentaccess(retriev­ingsummariesanddocuments)accountsfor56%. Thesestatisticsandotherstudies[9,17]suggestthat 
thereissufcientlocalitytojustifypartialcollectionreplica-tionforinformationretrieval.Ourpartialcollectionreplica 
shouldbeasearchablepartialcollectionwithreplicateddoc­umentsandtheirindicestospeedupbothqueryprocessing 
anddocumentaccess. 4ReplicationArchitecture Wedeterminewhichdocumentstoreplicateasfollows:fora givenquery,wetagalltopndocumentsreturnedbyquery 
processingas"accessed"andcounttheiraccessfrequencies, regardlessofwhethertheuserrequeststhetextofthesedoc­uments.Wekeeptheaccessfrequencyofeachdocument 
withinaperiodoftime,suchasaweekoramonth,and thenreplicatedocumentsbasedontheiraccessfrequencies. Weorganizereplicasasahierarchy,illustratedinFig­ure1.Thetopnoderepresentsanoriginalcollectionthat 
couldbeanactualcollectionresidingonanetworknodeora virtualcollectionconsistingofseveralcollectionsdistributed 
overanetwork.Thebottomnodesrepresentusers.Wemay divideusersintodiferentclusters,eachofwhichcorresponds 
toagroupofusersthatresidewithinthesamedomain,such asaninstitution,orgeographicalarea.Theinnernodes representpartialreplicas.Thereplicainalowerlayeris 
asubsetofthereplicasinupperlayers,i.e.,Replica1-1C Replica1COriginalCollection.Thereplicathatisclosest 
toauserclustercontainsthesetofdocumentsthataremost frequentlyusedbytheusercluster.Anupperlayerreplica 
couldcontainfrequentlyuseddocumentsformorethanone Query c1 c2 c3 .. .. .. c m Network Figure2:Thecollectionretrievalinferencenetwork 
usercluster. Thesolidlinesillustratedatafowsdisseminatedfrom theoriginalcollectiontoreplicas.Alongthearcsfromthe 
originalcollection,themostfrequentlyuseddocumentsare replicatedmanytimes.Thereplicaselectiondatabasedi­rectsqueriestoarelevantpartialreplica.Userrequestsmay 
gotoanyreplicaortheoriginalcollectionalongthearcs fromthetopnodedependingonrelevanceandothercri­teria,suchasserverload.Thedottedlinesillustratethe 
interactionbetweenusersanddata.Ifwedonotdividethe usersintodiferentgroups,thehierarchyissimplyalinear 
hierarchy.Inthisarchitecture,replicaselectionisatwo-step process:rankingreplicasandtheoriginalcollectionbasedon 
relevance,andthenselectingoneofthemostrelevantrepli­casortheoriginalcollectionbasedonload. 5RankingReplicaswiththeInferenceNetwork 
Model Weadaptthecollectionretrievalinferencenetworksthat Callanetal.proposedtorankcollections[6]torankpar­tialreplicasandtheoriginalcollection.Thecollectionre­trievalinferencenetworkmodelconsistsoftwocomponent 
networks:acollectionandquerynetwork,illustratedinFig­ure2.TheDinodesarecollections,andtherjnodesare conceptsinthecollections.ThequerynodeQconsistsofci, 
theconceptnodesfromthequery.Byusingthecollectionre­trievalinferencenetwork,collectionrankingbecomesanesti­mateofP(QjDi)fromcombiningtheconditionalprobabili­tiesthroughthenetwork.Whenrankingreplicas,weuseDn 
torepresenttheoriginalcollection,andDi;i1;2;:::n,1to representpartialreplicas.Wecallthisinferencenetworkthe 
replicaselectioninferencenetwork.Asinthecollectionre­trievalinferencenetworkmodel,P(ckjrj)issetto1:0.The 
centralworkofreplicaselectionistodevelopanefective replicaselectionfunctiontoestimateP(rjjDi). Adocument/collectionrankingfunctionisbetterthan 
othersifandonlyifitcanproducehigherprecisionatthe selectednumbersofdocuments/collectionsoratalllevelsof 
recall.Thereplicaselectionfunctionalsoneedstodirect asmanyqueriesaspossibletorelevantreplicasinorderto 
obtainthelargestperformanceimprovement,butthismay degradeprecision.Wecompareprecisionoffunctionswhen 
theydirectatleast80%ofreplicatedqueriestothereplicas. WefrstconsidertheInQuerycollectionrankingfunction, 
illustrateinFigure3[6],butitdirectstoomanyreplicated queriestotheoriginalcollection(>70%),becauseitusesdf 
(thedocumentfrequencyofeachterm)asthebasicmetric, andthusfavorstheoriginalcollectionwithlargedf.Sincea 
partialreplicacontainsthetopdocumentsofthemostfre­quentlyusedqueries,byexaminingthedocumentranking function,weknowthatthetopdocumentsarerankedasthe 
m Network  dfij T= cwidfij+k ((1,b)+b avecw jNj log(+0:5) cf I= log(jNj+1:0) P(rjjDi)=a+(1,a) T I where 
dfijnumberofdocumentsthatcontain termrjincollectionDi, cwinumber ofwordsinDi, avecwaveragenumberofwords, 
Nnumberofcollections, cfnumberofcollectionsthatcontainrj. kconstantthatcontrolsthemagnitudeofdf (defaultis200), 
bconstantvaryingfrom0to1whichcontrols thesensitivityofthefunctiontocw (defaultis0.75),and adefaultbelief(setto0.4). 
Figure3:TheCollectionRankingFunctioninInQuery ctfij avetf= dfij log(DNi) log(DN cutofi=cutof1 1) avetf 
ifdfij>cutofi AT=dfij avetf otherwise cutofi AT T= avedocleni AT+k ((1,b)+b aveavedoclen jNj log(+0:5) 
rf I= log(jNj+1:0) P(rjjDi)=a+(1,a) T I where ctfij numberofoccurrencesof termrjin replica/collectionDi, 
dfij numberofdocumentsthat containtermrjinDi, DNi numberofdocumentsinDi, cutof1 cutofvalueforthesmallest 
replicaD1,whichwesetasthe numberoftopdocumentsforeach query, cutofi cutofnumberofdocuments inDi, N numberofreplicasplus 
theoriginalcollection, rf numberofreplicasand thecollectionthatcontainrj, avedocleniaveragedocumentlengthinDi, 
aveavedoclenaverageavedocleni, k constantthatcontrolsthe magnitudeofAT, b constantvaryingfrom0to1 usedtocontrolthesensitivityof 
thefunctiontoavedoclen,and a defaultbelief(setto0.4). Figure4:Thereplicaselectionfunction top,justbecausetheycontainthesequerytermsmoreoften 
thantheothers.Ifareplicacontainsthetopdocumentsfor aquery,theaveragetermfrequencyofeachquerytermin thereplicashouldbehigherthanintheoriginalcollection. 
Basedonthisheuristic,weconstructareplicaselectionfunc­tionthatusestheaveragetermfrequencyandpenalizesthe 
termsthatoccurintoofewdocuments,asshowninFigure4. Weimplementthereplicaselectioninferencenetworkas apseudoInQuerydatabase,whereeachpseudodocument 
correspondstoareplicaorcollection,itsindexstoresthedf (documentfrequency)andctf(replica/collectiontermfre­quency)foreachterm. 
6EfectivenessofPartialReplicaSelection Inthissection,weevaluatetheefectivenessofourreplica selectionapproachusingtheInQueryretrievalsystem[5], 
andthe2GBTRECvolumes2+3collectionandthe20 GBTRECVLCcollection.Weusequeriesdevelopedfor TRECtopics51-350inourexperiments.Wecompareour 
proposedreplicaselectionfunctionwiththecollectionrank­ingfunction.Wemeasuretheirabilitytopicktherelevant 
partialreplica,andtheprecisionoftheresultingresponseas comparedwithsearchingtheoriginalcollection. 6.1ExperimentalSettings 
Weusethe2GBcollectiontocomparetheefectivenessof ourreplicaselectionfunctionwiththeInQuerycollection rankingfunctionusingshortqueries,anddemonstratetheef­fectivenessofourreplicaselectionfunctionusingbothshort 
queriesandlongqueries.Ashortqueryissimplyasum ofthetermsinthecorrespondingdescriptionfeldofthe topic.LongqueriesareautomaticallycreatedfromTREC 
topicsusingInQueryquerygenerationtechniques[5],which consistofterms,phrasesandproximityoperators.Gener­ally,alongqueryforatopicismoreefectivethantheshort 
query[5].Theaveragenumberoftermsperqueryis8for shortqueriesand120forlongqueriesafterremovingthe stopwords.Wefurtherdividequeriesintoreplicatedand 
unreplicatedqueries,wherethereplicatedqueriesarethose whosetopdocumentsareusedtobuildthereplicas.Since 
onlytopics51-150and202-250haverelevancejudgmentfles forthe2GBTRECcollection,weusethemtotestprecision. 
Weusethe20GBcollectiontoexaminehowthecol­lectionsizeafectstheefectivenessofourreplicaranking function.Sincewedonothaverelevancejudgmentsfortop­icsf51-150,202-250gagainstthe20GBcollection,butthe2 
GBcollectionisasubsetofthe20GBcollection,weusethe relevancejudgmentsforthe2GBcollectiontoproducethe precisionfgures. 
Ourexperimentsrepeatthefollowingprocedure5times: eachtrialusesadiferentnumberastheseedtoproduceran­domnumbers,andthuspicksdiferentqueriesforaqueryset, 
inordertobreakthepossiblecorrelationsbetweenqueries. Ineachtrial,werandomlychoose50queriesfromqueries 
f51-150,202-250gasourunreplicatedquerysetT,andran­domlydividetheremaining250queriesinto5setssuchthat 
eachsetcontains50queries,fQi;i1;2;3;4;5;jQij50g. Thesequeriesarethereplicatedqueries.Wethenbuild a6-layerreplicationhierarchyfromtheoriginalcollection. 
ForeachqueryinQi,wecollecttheresultingtopndocu­mentsfromtheoriginalcollectiontobuild5partialreplicas 
fDi;i1;2;3;4;5g,whereDicontainsatmostn*idocu­ments,consistingofthetopndocumentsforeachqueryin querysetsfQj;j1;:::;ig.Clearly,theD1CD2CD3C 
D4CD5Ctheoriginalcollection. replica %toreplicas   Expected 18 16 0% 0% Random 17       InQuery200,0.25 
I1 0 0 0 0 99 0% Collection200,0.75 I2 0 4 5 20 69 16% Ranking 200,1 28 14 22 14 65% 11% 28 15 22 14 
65% 10% 29 14 23 14 64% 11% 22 12 1012 59% R2 20 17 24 12 57% 9% 22% Ranking2,0.8 R3 6 15% Func. 1,0.2 
R4 17 47% 27% 4,0.2 R5 21 10 10 54% 21% (a)Numberofreplicatedqueriesreplicaselectionsendstoreplicas(99queries). 
   atm PrecisionofUnreplicatedQueries(%) docs CrandomI3I4I5R1R2 1039.8 24.6(-38.2) 30.0(-24.6) 29.4(-26.1) 
30.0(-24.6) 33.6(-15.6) 35.9(-9.6) 2036.8 23.7(-35.6) 27.2(-26.1) 26.6(-27.7) 27.3(-25.8) 32.3(-12.2) 
34.4(-7.9) 3033.4 22.3(-33.1) 24.9(-25.4) 24.3(-27.2) 24.9(-25.4) 30.8(-7.8) 31.9(-4.6) 10026.4 15.0(-43.1) 
16.9(-35.9) 16.2(-38.7) 16.9(-35.9) 22.8(-13.6) 23.5(-10.8) 20021.1 10.4(-50.5) 11.7(-44.7) 11.1(-47.3) 
11.7(-44.7) 17.1(-19.2) 18.1(-14.5)    (b)Precisionof50unreplicatedqueries Table2:Comparingrankingfunctionsusingshortqueriesonthe2GBTRECvolumes2+3collection 
Whenwereplicatethetop200documentsforeachquery, thereplicasizerangesfrom2%to10%,andfrom0.2%to1% oftheoriginalcollectionforthe2GBand20GBcollections, 
respectively.Webuildareplicaselectioninferencenetwork torankthesefvereplicasandtheoriginalcollection. 
Forthe20GBcollection,wealsousequeries301-350as ourunreplicatedqueryset,sincethese50topicsaremore thoroughlyjudgedagainstthe20GBcollectionthantopics 
f51-150,202-250g.Weusequeries51-100asQ1,101-150as Q2,151-200asQ3,202-250asQ4,and251-300asQ5. Forbothreplicatedandunreplicatedqueries,weexpect 
wewillhavetotoleratesomelossinprecisioninorderto avoidsearchingtheentirecollection.Wechooseadropin precisionbetween0%and10%foraqueryasouraccept­ablerange,i.e.,searchingtheselectedreplicaretrievesat 
mostonelessrelevantdocumentforevery10documentsas comparedwithsearchingtheoriginalcollection. 6.2ComparingRankingFunctions 
Inthissection,wecompareourreplicaselectionfunction (Figure4)andtheInQuerycollectionrankingfunction(Fig­ure3)byvaryingkandbforshortqueriesintesttrial1when 
wereplicatethetop200documentsforeachquery.Weshow thatourreplicaselectionfunctioniscomparableinprecision 
andabilitytopicktheexpectedreplicawithsomeconfgura­tionsofthecollectionrankingfunctionforreplicatedqueries, 
butthatitsignifcantlyimprovesprecisionforunreplicated queries. Table2liststheresultsofreplicaselectionusingdifer­entrankingfunctions.Table2(a)liststhethenumberof 
replicatedqueriesandtowhichreplicaorcollectioneach functiondirectsthequeries,whentheparameters,kandb, 
vary.Columns1through3listthenameoffunctions,the valuesofparameterskandb,andthefunctionabbrevia­tions.Columns4through9containthenumberofqueries 
thatthereplicaselectorsendstoeachofthereplicas(Di) aswellastheoriginalcollection(C);columns10through13 
containthepercentagesofqueriesthataredirectedtothe expectedreplica(right),smallerreplica,largerreplica,and 
theoriginalcollection.Theexpectedreplicaforareplicated queryisthesmallestreplicathatisbuiltwiththetopdocu­mentsofthequery.Noteitispossibleforareplicasmaller 
thantheexpectedtocontainalltopdocumentsforagiven query,sincethetopdocumentsofotherqueriescouldinclude 
thetopdocumentsforthisquery.The"expected"(E)row liststhenumberofjudgedqueriesthatwewouldexpectthe replicaselectortodirecttoeachreplicaandtotheoriginal 
collection,ifitwereperfectwithrespecttothequeriesused tobuildthereplicas. FortheInQuerycollectionrankingfunction,varyingk 
from100to400doesnotsignifcantlychangeperformance (compareI3-I5).Whenwesetkto200(thedefaultofthe InQuerycollectionrankingfunction)andincreasethevalue 
ofb,thereplicaselectordirectsmorequeriestothereplicas. Forthereplicatedqueries,thedefaultInQuerycollection 
rankingfunction(k 200,b 0.75)directs70%ofqueriesto theoriginalcollection,whichisnotourchoice. Forthereplicaselectionfunction,k2getsbetterre­sultsthank1andk4(comparethefunctionsR3-R5). 
Whenwedecreasethevalueofb,thereplicaselectordirects morequeriestothereplicas.Amongthefunctionslistedin 
Table2(a),sixfunctionsrandom,I3,I4,I5,R1,andR2di­rectmorethan80%ofreplicatedqueriestothereplicas.We needtocomparetheirprecisiontodeterminewhichoneis 
bestforreplicaselection. Wecomparetheprecisionofthefunctionsforbothrepli­catedqueriesandunreplicatedqueries.Whenweexamine 
theprecisionforreplicatedqueries,allthesefunctionsexcept randomselectionareacceptable,sincetheprecisionresulting 
fromthesefunctionsdropswithin8.7%.However,whenwe examinetheprecisionforunreplicatedquerieslistedinTa­ble2(b),theprecisiondiferenceissignifcant.InTable2(b), 
thefrstcolumnliststheaveragenumberofdocumentsat whichwepresenttheprecision.Column2liststheprecision whenallqueriesgototheoriginalcollection,i.e.,whatper­centisrelevanttothetopmdocumentswhensearchingthe 
originalcollection.Columns3through8listtheresultsusing randomselection,andeachrankingfunction.Thenumbers 
inparenthesesshowtheprecisionpercentagediferenceas comparedwithsearchingtheoriginalcollection. Itisnotsurprisingthatrandomselectionperformspoorly, 
becauseithashighprobabilityofpickingareplicawithfew Avg.QueriestoReplica %toReplica Expected21.6 16.6 
21.4 20.6 18.8 0 100% 0% 0% 0% 2GBshort 20.0 13.2 14.2 17.0 21.0 13.6 59.8% 8.1% 18.4% 13.7% 2GBlong 
18.0 17.4 12.6 14.4 28.2 8.4 57.0% 8.7% 25.8% 8.5% 20GBshort 15.4 13.2 12.0 15.4 24.6 18.4 56.5% 4.2% 
20.4% 18.6%          Table3:Averagenumberofreplicatedqueriesreplicaselectionsendstoreplicas(replicasbuiltwiththetop200documents) 
 atm 2GB+short 2GB+long 20GB+short 20GB+301-350 docsCReplica CReplica CReplica CReplica  1042.8 
39.4(-8.0) 55.3 52.0(-6.0) 12.8 12.6(-1.6) 40.4 36.2(-10.4) 2039.4 36.1(-8.4) 52.7 48.6(-7.8) 12.3 11.9(-3.1) 
35.4 30.7(-13.3) 3035.5 32.7(-7.8) 50.0 45.7(-8.7) 11.8 11.9(+0.8) 31.3 26.9(-14.2) 10027.2 24.0(-11.6) 
40.4 35.1(-13.2) 10.0 9.6(-4.2) 20.2 17.8(-11.9) 20021.8 18.3(-16.5) 33.1 27.3(-17.4) 8.4 7.7(-7.9) 14.4 
12.8(-10.9)   Table4:Averageprecisionofunreplicatedqueries(eachtrial relevantdocuments.Forunreplicatedqueries,itcausespre­cisionpercentagelossesrangingfrom38:0%to50%com­paredwithsearchingtheoriginalcollection,C. 
UsingInQuerycollectionrankingfunctionI3wherewe setk200andb1,theprecisionlossesofunreplicated queriesrangefrom24.6%to44.7%.Wegetourbestresult 
usingourreplicaselectionfunctionR2withk2andb 0:2.Theprecisionlossesofunreplicatedqueriesrangefrom 4:8%to14:5%.Forthetop30documents,theprecision 
lossesofunreplicatedqueriesrangefrom4:8%to9:6%.In theremainingexperiments,wesetk2andb0:2. 6.3EfectivenesswithReplicatedQueries 
Thissectionevaluatesourproposedreplicaselectionfunc­tionforreplicatedqueriesonawiderrangeofqueriesand 
collections.Wewanttotestwhetherthereplicaselectordi­rectsmostofreplicatedqueriestoanexpectedreplica.Al­thoughweuse250queriestobuildreplicas,weonlypresent 
theresultsforthe99replicatedquerieswhichhaverelevance judgmentflesinthissection. Wecounttheaveragenumberofreplicatedqueriesthat 
thereplicaselectordirectstoeachofthereplicasandthe originalcollectionover5trails,asshowninTable3.In Table3,columns1and2indicatetheoriginalcollectionsize 
andthequerytype.Columns3through8ontherowof "Expected"listtheaveragenumberofjudgedqueriesthat areusedtobuildareplica,butnotusedinasmalleroneover 
5trials.Columns3through8onotherrowslisttheaverage numberofqueriesthereplicaselectorsendstoeachreplica 
andtheoriginalcollection.Columns9through12contain theaveragenumberofqueriesthattheselectordirectsto theexpectedreplicas(right),smallerreplicas,largerreplicas, 
andtheoriginalcollection(C). Forshortqueriesonthe2GBcollection,ontheaverage, ourreplicaselectordirects86:3%(59.8%+8.1%+18.4%)of 
replicatedqueriestothereplicas,and67:9%ofqueriesto theexpectedreplicaorareplicasmallerthanweexpect. Forlongqueriesonthe2GBcollection,ontheaverage, 
ourreplicaselectordirects91:5%(57.0%+8.7%+25.8%)of replicatedqueriestothereplicas,and65:7%ofqueriestothe 
expectedorasmallerreplica.Forshortqueriesonthe20GB collection,ontheaverage,ourreplicaselectordirects81:4% 
(56.5%+4.2%+20.4%)ofreplicatedqueriestothereplicas, and60:7%ofqueriestotheexpectedorasmallerreplica. 
Wealsocomparetheprecisionofexecutingqueriesresult­ingfromreplicaselectionwithsearchingtheoriginalcollec­tion.Eventhoughsomequeriesgotosmallerreplicasthan 
expected,precisionisnotcompromised.Replicaselection has50queriesandreplicasbuiltwiththetop200documents) 
resultsinprecisionpercentagelosswithin3:0%ascompared withsearchingtheoriginalcollectionwhenweuseshortand 
longquerieson2and20GBcollections. 6.4EfectivenesswithUnreplicatedQueries Thissectionevaluatesthereplicaselectionfunctionforun­replicatedqueries.Forthe2GBcollection,ontheaverage 
over5trials(eachtrialhas50queries),15.4shortqueriesand 16.6longquerieshaveareplicathatcausestheprecisionloss 
within5%ascomparedtosearchingtheoriginalcollection, andthereplicaselectordirects84:7%and86:9%ofthese 
queriestothereplicas,respectively.Table4comparesthe retrievalprecisionofexecutingunreplicatedqueriesagainst 
replicasortheoriginalcollectionselectedbyourreplicase­lectorwithonlysearchingtheoriginalcollection.Column1 
liststhenumberofdocumentsatwhichwepresentthepreci­sionfgures.Columns2,4,6,and8listtheprecisionfgures 
whenallqueriesgototheoriginalcollection.Columns3,5, 7,and9listtheaverageprecisionofreplicaselectionover5 
testtrials.Thenumbersintheparenthesesshowthepreci­sionpercentagediference. Forthe2GBcollection,usingshortandlongqueries 
causeaprecisionlossrangingfrom7:8%to16:5%,andfrom 6:0%to17:4%,respectively.Forthetop30retrieveddocu­ments,whichisaretrievallevelthatconcernsmanyonline 
users,ourreplicaselectorcausesaverageprecisionpercent­agelosswithin8:7%ofsearchingtheoriginalcollection. 
Forthe20GBcollectionusingshortqueries,whenwe usetherelevanceflesforthe2GBcollection,theprecision rangesfromimprovingby0.8%toalossof7.9%.Whenwe 
useshortqueries301-350asourunreplicatedqueries,the precisiondropforiswithin14.2%.Topics301-350weremuch 
morethoroughlyjudgedthantopicsf51-150,202-250gfor the20GBVLCcollection.Althoughadditionaljudgments arestillunderway,wethinktheresultsusingtopics301­350aremoreaccurate,whichmeansourreplicaselection 
performsslightlyworseonthe20GBcollectionthanonthe 2GBcollection.However,theprecisionpercentagelossof 
14.2%inourcontextonlymeansthatweretrieveoneless relevantdocumentforthetop30documents. 7PerformanceofPartialCollectionReplication 
Inthissection,wecomparetheperformanceofpartialrepli­cationtocollectionpartitioningonthesameserver,and 
showthatreplicationissuperioratimprovingperformance evengivensmallpercentagesofquerylocality.Wedoamore 
thoroughevaluationelsewhere[19].Theseresultsdemon­stratethepotentialforalotofperformanceimprovement. 
WesimulateperformanceofaparallelIRserverusingasym­metricmultiprocessor.Inpreviouswork,wevalidatedthis 
simulatoragainstanimplementationofInQueryrunningon amultiprocessorAlpha,anddemonstratedthatthesimula­torisaccuratewithrespecttotheimplementation[19]. 
Forthisexperiment,wemodelthecommandarrivalasa Poissonprocess,useshortquerieswithanaverageof2terms perquery,andissuequery,summary,anddocumentcom­mandswitharatioof1:1.5:2,aswefoundintheTHOMAS 
logs.WevarythenumberofCPUsfrom1to4.Thebase confgurationhas4diskstowhichallCPUshaveaccess. Eachdiskstoresuptoa4GBcollectionanditsassociated 
indices.Theoriginalcollectioninthiscaseis16GB,we thereforeneedatleast4disks.Inthebaseconfguration, foraquerycommand,theserverassigns4threads,eachof 
whichexecutesthequeryagainstacollectionpartitionon adiskinparallel,andthenmergestheresultsreturnedby 
Average Query Response Time (Seconds) Average Query Response Time (Seconds)Average Query Response Time 
(Seconds) 120 100 80 60 40 20 0 Distracting Percentage (%) (a)NCPU =1 eachthread;forasummarycommand,theserverassigns 
120 n(:4)threadstoexecuteandthenmergestheresults;fora documentcommand,theserverassignsonethreadtofetch 
100 thethedocument.Westudytheefectsofanadditional disk,askingthefollowingquestion:shouldwepartitionthe 
80 collectiononthe5disks,orshouldwepartiallyreplicatethe topqueryresultsonthe5thdisk? 60 Ifwebuildapartialreplicausingtheadditionaldisk,the 
replicacanbeaslargeas4GB,whichis25%oftheoriginal40 collection.Ifquerylocalityishigh,thereplicaselectormay 
sendmorequeriestothereplicathantheoriginalcollection, 20 whichmayresultinloadimbalance.Weload-balancebypre­ 
0 dictingtheresponsetimeofthereplica(R)andtheoriginal collection(C)usingtheaverageresponsetimeandthenum­beroftheoutstandingcommands.Whenthereplicaselec- 
 Distracting Percentage (%) (b)NCPU =2 torchoosesthereplica,wecalculatethepredictedresponse timeprespi;ifR;Cgusingaverespi.numwaitmesi, 
whereaverespiistheaverageresponsetimeforlast200re­sponsesforeitherthereplicaortheoriginalcollection,and 
numwaitmesiisthenumberoftheoutstandingcommands towhicheitherthecollectionorthereplicahasnotyetre­sponded.WhenprespCislessthanprespR,thecommand 
issenttotheoriginalcollection. Figure5showstheaverageresponsetimeversusthedis­tractingpercentagethatrepresentsthepercentageofthe 
queriesthereplicaselectorsendstothereplica,whencom­mandsarriveat10persecondfor1,2,and4CPUs,each withdiferentperformancebottlenecks.InFigure5(d),the 
rowsof"CPU"listtheaverageutilizationoftheCPUs,the rowsof"DISK"listtheaverageutilizationoverthedisks thatstoretheoriginalcollection;therowsof"Drepl"lists 
theutilizationofthediskthatstoresthepartialreplica. InFigure5(a),whereoneCPUisalreadyoverutilized for4diskswhenthecommandsarriveat10persecond, 
partitioningthecollectionover5disksisactuallyworsethan over4disks,becauseitexacerbatestheCPUbottleneck;i.e., 
partitioningaddsalittlemoreCPUoverheadtomergethe resultsanddiskdelayoftheslowestdiskisexaggeratedwhen 
theCPUisbusy.Theperformanceofpartialreplicationis muchbetter(usuallyafactorof2)thanpartitioningatall 
datapointsofthedistractingpercentage,becausesearching thereplicathatusesonediskneedslessCPUtimethan searchingtheoriginalcollectionwhichisdistributedover4 
disks,andthusshortensthewaitingtimefortheCPU.For thesamereason,theimprovementincreasesasthereplica distractsincreasinglymanycommandsuntilthediskload 
getstoohigh.Atthatpoint,loadbalancingisnecessary. For2and4CPUsasshowninFigure5(b)and(c),the     
 120 100 80 60 40 20 0 Distracting Percentage (%) (c)NCPU =4 partitioningpartialreplication Num. CPUs 
Res. 4disks 5disks nobal. with bal. CPU 99.3% 99.5% 99.0% 99.4% 1 DISK 48.1% 36.0% 35.6% 38.2% D-repl 
CPU 85.3% 95.1% 78.5%81.0% 53.3% 88.9% 2 DISK 84.1% 68.7% 64.4% 70.8% 4 D-repl CPUDISKD-repl 46.9%90.6% 
62.6%89.5% 97.0%40.0%50.1%99.2% 85.1% 48.0% 71.5% 86.6% (d)hardwareutilizationwhendp=50% Figure5:PartitioningversusPartialReplicationfora16 
GBcollectionwhencommandsarriveat10perseconds CPUanddiskutilizationsarebetterbalanced.However, theCPUsareabottleneckfor2CPUsand5disks,andthe 
disksareabottleneckfor4CPUs.Forpartitioningover5 disks,using2CPUslimitsitsimprovementduetotheCPU bottleneck,andusing4CPUsreachesthelargestimprove­mentforpartitioningoveronemoredisk.Partialreplication 
performsbetterthancollectionpartitioningwhenthereplica distractsmorethan5%and12%ofcommandsusing2CPUs 
and4CPUs,respectively.Systemimprovementsduetopar­tialcollectionreplicationaredeterminedbyquerylocality 
andincreaseasthequerylocalityincreasesuntilthereplica isoverloaded.Replicationwithloadbalancingimprovesthe 
queryresponsetimebyafactorrangingfrom2to4ascom­paredtopartitioningover5disks,whenthereplicadistracts 
morethan20%ofcommands. 8Conclusion Inthispaper,weinvestigatehowtoselectarelevantpar­tialreplicausingtheinferencenetwork,whichisthefrst 
steptowardstodevelopingreplicationandpartialreplication strategiestoimproveIRsystemperformancewhilemaintain­ingtheretrievalaccuracy.Ourapproachenablesasystemto 
rankpartialreplicasforrelevancetoaquery,andautomati­callyselectsareplicabasedonbothrelevanceandload.We 
examinerealIRsystemlogsandfndthatthereissufcient querylocalityinrealIRsystemstojustifypartialcollec­tionreplicationforinformationretrieval.Wedemonstrate 
theefectivenessofourapproachusingtheInQueryretrieval systemandTRECcollectionsandshowthattheinference 
networkmodelisaverypromisingapproachforrankingpar­tialreplicas.Byusingournewreplicaselectionfunction, 
ourreplicaselectorcandirectmorethan85%ofreplicated queriestoarelevantpartialreplicaratherthantheoriginal 
collection,anditachievesaprecisionpercentagelosswithin 8:7%and14.2%forthetop30retrieveddocumentsforthose 
unreplicatedqueries,whensizesofreplicasrangefrom2%to 10%forthe2GBcollection,and0.2%to1%forthe20GB collection,respectively.Ourperformanceexperimentsshow 
thatpartialcollectionreplicationsignifcantlyimprovesper­formanceovercollectionpartitioningforthesamenumberof 
diskswhenthereplicasatisfesamodestnumberofrequests. Acknowledgments Thismaterialisbasedonworksupportedinpartbythe 
NationalScienceFoundation,LibraryofCongressandDe­partmentofCommerceundercooperativeagreementnum­berEEC-9209623,andinpartbyDefenseAdvancedRe­searchProjectsAgency/ITOunderARPAordernumber 
D468,issuedbyESC/AXScontractnumberF19628-95-C-0235.KathrynS.McKinleyissupportedbyanNSFCA-REERawardCCR-9624209.WethankBenMealeyand 
LibraryofCongressforprovidingtheTHOMASlog.We thankDougCuttingandExciteforprovidingtheExcite log.Anyopinions,fndingsandconclusionsorrecommenda­tionsexpressedinthismaterialaretheauthorsanddonot 
necessarilyrefectthoseofthesponsors. References [1]M.AhamadandM.H.Ammar.Performancecharacterization ofquorum-consensusalgorithmsforreplicateddata.IEEE 
TransactionofSoftwareEngineering,15(4),April1989. [2]M.Baentsch,G.Molter,andP.Sturm.Introducing application-levelreplicationandnamingintotoday'sWeb. 
InProceedingsof5thWWWConference,Paris,France,May 1996. [3]A.Bestavros.Demand-baseddocumentdisseminationtore­ducetrafcandbalanceloadindistributedinformationsys­tems.InProceedingsofSPDP'95,SanAnotonio,Texas,Oc­tober1995. 
[4]S.Bhattacharjee,M.H.Ammar,E.W.Zegura,V.Shah,and Z.Fei.Application-layeranycasting.InProceedingsofIN­FOCOM97,1997. 
[5]J.P.Callan,W.B.Croft,andS.M.Harding.TheINQUERY retrievalsystem.InProceedingsofthe3rdInternationalCon­ferenceonDatabaseandExpertSystemApplications,Valen­cia,Spain,September1992. 
[6]J.P.Callan,Z.Lu,andW.B.Croft.Searchingdistributed collectionswithinferencenetworks.InProceedingsofthe 
18thACMSIGIR,Seattle,WA,July1995. [7]R.L.CarterandM.E.Crovella.Dynamicserverselection usingbandwidthprobinginwide-areanetworks.Technical 
ReportBU-CS-96-007,BostonUniversity,March1996. [8]A.S.ChakravarthyandK.B.Haase.Netserf:Usingsemantic 
knowledgetofndinternetinformationarchives.InProceed­ingsofthe18thACMSIGIR,pages4-11,Seattle,WA,July 1995. 
[9]W.B.Croft,R.Cook,andD.Wilder.Providinggovernment informationontheInternet:ExperienceswithTHOMAS. InTheSecondInternationalConferenceontheTheoryand 
PracticeofDigitalLibraries,Austin,TX,June1995. [10]P.B.Danzig,J.Ahn,J.Noll,andK.Obraczka.Distributed 
indexing:Ascalablemechanismfordistributedinformation retrieval.InProceedingsofthe14thACMSIGIR,pages221­229,Chicago,IL,1991. 
[11]D.DowdyandD.Foster.Comparativemodelsofthefle assignmentproblem.ComputingSurveys,14(2),June1982. [12]Excite.http://www.excite.com. 
[13]N.Fuhr.Adecision-theoreticapproachtodatabaseselection innetworkedir.InWorkshoponDistributedIR,Germany, 
1996. [14]L.GravanoandH.Garcia-Molina.Generalizingglossto vector-spacedatabasesandbrokerhierarchies.InProceedings 
ofthe21stVLDBConference,Zurich,Switchland,1995. [15]L.Gravano,H.Garcia-Molina,andA.Tomasic.Theefec­tivenessofglossforthetextdatabasediscoveryproblem.In 
ProceedingsoftheSIGMOD94,pages126-137,September 1994. [16]D.Harman,editor.TheFourthTextREtrievalConference 
(TREC-4).NationalInstituteofStandardsandTechnology SpecialPublication,Gaithersburg,MD,1995. [17]VegardHolmedahl,BenSmaith,andTaoYu.Cooperative 
cachingofdynamiccontentonadistributedwebserver.In ProceedingsofHPDC-7,pages235-242,Chicago,IL,1998. [18]THOMASlegislativeInformationontheInternet. 
http://thomas.loc.gov. [19]Z.Lu.ScalableDistributedArchitecturesForInforma­tionRetrieval.PhDthesis,UniversityofMassachusettsat 
Amherst,May1999. [20]OracleCompany.StrategiesandtechniquesforusingOr­acle7replication.http://www.oracle.com/products/servers/ 
replication/html/collateral.html,May1995. [21]E.M.Voorhees,N.K.Gupta,andB.Johnson-Laird.Learn­ingcollectionfusionstrategies.InProceedingsofthe18th 
ACMSIGIR,Seattle,WA,1995. [22]O.WolfsonandS.Jajodia.Analgorithmfordynamicrepli-cationofdata.InProceedingsof11thACMSymposiumon 
thePrinciplesofDatabaseSystems,SanDiego,California, June1992.
			