
 Graph decomposition is NPC -A :omplete proof of Holyer s conjecture Dorit Dor Computer Science Dept. 
Tel Aviv University Tel Aviv 69978 Israel Abstract An H-decomposition of a graph G = (V, E) is a partition 
of E into subgraphs isomorphic to H. Given a fixed graph H, the H-decomposition problem is to determine 
whether an input graph G admits an H­decomposition. 1. Holyer (1980) conjectured that H-decomposition 
is NP-complete whenever If is connected and has at least 3 edges. Some partial results have been obtained 
during the last decade. A complete proof for Holyer s conjecture is the content of this paper. Introduction 
The H-decomposition problem, for a fixed graph H, is stated as follows: Can the edge set of an input 
graph G be partitioned into subgraphs, isomorphic to H? The existence and structure of graph decompositions 
for various pairs (G, H) is a well established branch of classical ( graph theory (see e.g. [2] for 
a partial review of references). However, the complexity status of the above problem was a long time 
standing open question. I. Holyer [10] conjectured NP-Completeneas of that problem whenever H consists 
of at least 3 edges. This general conjecture was known false (assuming P # NP) even before being stated. 
Brouwer and Wilson [4] presented polynomial time algorithm for the case where i? is the union of t disjoint 
edges (H = tK2). Other polynomial algorithms for specific graphs H were presented by N. Alon [1], Bialostocki 
and Rodit y [3], Preisler and Tarsi [13] and Favaron, Lone and Truszczynski [7]. In all the above, polynomial 
algorithms were found for H-decomposition where each connected component Permission to copy without fee 
all or part of this material ia granted providad that the copies are not made or distributed for direct 
commercial advantage, the ACM copyright notice and the title of the publication end its date appear, 
and notice ia given that copying ia by permiaaion of the Association for Computing Machinery. To copy 
otherwise, or to republieh, requiras a fea and/or epecific permission. 24th ANNUAL ACM STOC -5/92/VICTORIA, 
B. C., CANADA G J 992 ACM 0.8979J-~J 2-7 J9210004J0252...$J .50 Michael Tarsi Computer Science Dept. 
Tel Aviv University Tel Aviv 69978 Israel of H is either a single edge or a path of two edges. This leads 
to a relaxed version of Holyer s conjecture, restricted to graphs H which contain a connected component 
with at least 3 edges. Several partial results in that direction have been obtained during the last decade. 
Holyer himself [1O], [9] proved his conjecture for (H =) complete graphs, for simple paths and for simple 
circuits. D. Leven (unpublished) presented a proof for the case where H is a star (a complete bipartite 
graph Kl,n). Cohen and Tarsi [6] generalized those results to a family of graphs which contains all trees, 
and recently Masuyama and Hakimi [12] proved NP-completeness for all graphs which contain a vertex of 
degree 1. A related topic is the factorization problem which is the analogous problem for vertex-partition: 
Determine for a fixed graph H, whether an input graph G = (V, E) contains vertex-disjoint subgraphs, 
isomorphic to H, such that the union of their vertex sets is V. Kirkpatrick and Hell [11] proved that 
this problem is NPC if and only if H contains at least 3 vertices in a connected component. The content 
of this paper is a complete proof of Holyer s conjecture, that is, a proof ofi Theorem 1.1 H-decomposition 
is NPC whenever H contains a connected component with at least 3 edges. One major difficulty faced in 
any attempt to prove Theorem 1.1 lies in the fact that it states NP complete­ness of infinitely many 
decision problems. The schemes developed in previous research, each fitted only to a lim­ited class of 
graphs H. The starting point of our proof is the following classical theorem by R. M. Wilson [15], which 
can be considered as the key theorem of graph decomposition theory: Wilson s theorem For every graph 
H = (V, E) Mere exists an integer no such that for every n > no the complete graph Kn is H-decomposable 
if and only if IE{ divides ~) and g(H), the greatest common divisor of the vertez degrees in H, divides 
(n 1). Another tool on which we strongly rely is the results and methods presented by Holyer in [10]. 
Some resemblance can also be found to the scheme presented by Kirkpatrick and Hell in [11]. There are 
several versions of the proof, each for a certain family of graphs ~, as follows: H is 3-connected with 
g(~) = 1  H is 2-connected 2-separable with g(lf) = 1  H is 5-connected with g(n) >1  H is 2-connected 
but not 5-connected, non­triangular (see bellow) with g(lf) >1  H is l-separable.  H is 2-connected 
triangular.  It suffices to consider the case where H is connected (an explicit proof can be found 
in [6]) and the above list indeed covers all such graphs. Some notational remarks: Let G = (V,E) be agraph 
G with vertex set V = V(G) and edge set E = E(G). G is k-separable if it is not k + l-connected. If G 
= (V, E ) we use G G or G E to denote (V,E E ) and if V C V then G V = (V V , E {e c E : e is incident 
to a vertex of v }). A graph H = (E, V) is called triangular by 3 of its vertices W., VI, V2 c V if 
it is the union of three con­nected components CO, C 1, C Z and V(C~) (1 V(Ci+l) = {vi} for O ~ i ~ 2 
(additions modulo 3). An H-subgr-aph of G is a subgraph of G, which is isomorphic to H. If G admits an 
H-decomposition, D, then every graph in D is called a D-part. Let D be an H-decomposition of G and let 
H be a D-part. Hence there exists an isomorphism ~ : V(H ) + V(H) (select certain isomorphism if there 
are more than one). For v c V(H ) ~ V(G), z G V(H) the relation x = ~(v) is denoted by v = z(H ). We 
also say in that case that v plays the role of x in H . We present here most of the constructions for 
the various cases, but omit some details while proving their validity. 2 g(lq = 1 The scope of this section 
is the proof of Theorem 2.1 If H = (V, E) is a 2-connected graph with IEI z 3 and g(H) = 1 then H-decomposition 
is NPC. To prove Theorem 2.1 we present a polynomial time reduction of the following problem into H­decomposition. 
 Definition: An instance of k-XC (k-eXact Cover) is a pair I = (U, A), where U is a jinite set and A 
a collection of k­element subsets of U. The k-XC problem on I is to decide whether there exists a partial 
collection X c A of pairwise disjoint sets such that (JAcx A = U. For every positive integer k >3, k-XC 
is known to be NPC (k-dimensional matching is a restricted version of k-XC). H-decomposition is obviously 
in NP for any graph H, thus we show NP-hardness. Let H = (V, E) be a fixed 2-connected graph with g(H) 
= 1 and 1111= m z 3. For every instance 1 = (U, A) of m-XC we construct, in polynomial time, a graph 
GH(l), for which H-decomposition is equivalent to m-XC on I. The general construction scheme is described 
while dealing with the case where H is 3-connected. More carefully tailored details are required later 
for graphs of lower connectivity. 2.1 H is 3-connected The basic building block of which GH(I) is composed 
is the Link module LH, constructed as follows: The Link module, LI+ Choose, accord;ng to Wilson s theorem, 
an integer n such that Kn and K.+l both are H-decomposable (g(H) = 1 is necessary for the existence of 
such n and here is the only point where that condition is recalled). Apply Wilson s theorem one more 
time, to choose an integer N such that KN is Kn+l-decornposable. Select a vertex v of the complete graph 
KN and delete n 1 of the edges incident to v. Also select c and d, two of the vertices which remain 
adjacent to v. The graph obtained, with its 3 labelled vertices c, d and v, is the link module LH. The 
pertinent property for which LH was defined is: Figure 1: The Link module Proposition 2.1 The subgraphs 
obtained from LH by deleting either one of the edges el = (v, c), or ez = (v, d), both are H-decomposable. 
 253 To verify the proposition, start with a Kn+l­decomposition D of KN, where the n + 1 clique on V,C 
and the n -1 vertices to become nonadjacent to v form a D-part. Once all the edges incident to v in this 
clique (including (v, c)) are deleted, the remaining edges form a copy of K~. Since K~ and K~+l both 
are H-decomposable, the partition obtained can be refined into an H-decomposition of LH {(v, c)} (see 
Figure 1). The same argument holds for LH {(v, d)} as well. The Chain module. CH A sequence (LI, Lz,.., 
LZm) of 2rn copies of LH is concatenated into a Chain module CH by means of identifying the edge (vi, 
di) (that is the edge (v, ~) of Li) with the edge (ci+l, Vi+l ) and their corresponding endvertices (vi 
with C;+l and di with ~i+l ), for every 1< i < 2rn 1. The two edges (cl, VI) and (v2~, d2~) will be 
referred to as the arms of CH (see Figure 2). The chain s arms <.-......-.-. L1 ... d1=v2=G3 L$: L3 
d2=g3=G4 d3=Q4=G5 .L4 . . L3 .. ,.. L6 L7 ~: D Figure 2: The chain module, CH H being 3-connected, Proposition 
2.1 and the m edges distance between the two arms of CH clearly imply the following: Proposition 2.2 
Let C be a CH-subgraph of a graph G where the only common vertices of C and G C are the endvertices 
of C s arms and the distance (length of shortest path) between the arms of C in G is at least m. If G 
admits an H-decomposition D then all D-parts are either contained in C or edge disjoint from C, except 
for one D-part Hc for which Hc ~ C consists of a single arm of C. The Block module and G=(I) Let 1 = 
(U, A) be an instance of m-XC. The graph GH(l) is now constructed as follows: For every A E A take a 
Block module BA consisting of a copy HA of H, every edge of which is an arm of one of m chain modules, 
which are otherwise vertex disjoint. The other m arms of these chains will be referred to as the remote 
arms of BA. For every z c U let all block modules BA for which z c A share a common remote arm em (and 
be otherwise vertex disjoint). (see Figure 3). Figure 3: The block module, ~A, where {z, y, z} ~ A We 
omit the straight forward verification that indeed a solution for 1 exists if and only if GH(I) admits 
an H-decomposition. 2.2 1? is 2-connected, 2-separable Proposition 2.2 above strongly relies on 3-connectivity. 
The link module LH is almost a complete graph and thus if H is not 3-connected then an H-subgraph can 
spread among several links of a chain in an uncontrolled manner. To avoid this, we define a modified 
link module Lb, such that, when LH is replaced by L1~ Proposition 2.2, and hence the whole proof, remains 
valid also for 2-connected graphs. Let H = (V, E) be a 2-connected, 2-separable, graph with g(H) = 1 
and 117[= m ~ 3. A separating pair SP for short -of H, is a pair of vertices {z, y} C V such that the 
graph H {x, y} = (V {x, y}, E {e[e is incident to either z or y}) is not connected. An {x, y}-component 
is a subgraph of H, induced by the union of {z, y} with a connected component of H {z, y}. Thus all 
{z, g}­components share the vertices x and y (and an edge (x,y) if it exists) and they are otherwise 
disjoint. An sp-sequence of H is a sequence ({zI, Yl}, .... {*k, w}) of distinct (not necessarily disjoint) 
SP S such that all {zj, yj } j > i are contained in the same {Zi, yi}­component. Let S = ({zl, yl}, .... 
{zk, y~}) be an S P­sequence of H of maximal length k. Also let S be selected such that d(zk ) is minimal 
among all SP­sequences of length k. From an {z~, yk}-component which does not contain {z~_ 1, ~b_ I } 
select a vertex z # Yk (See Figure 4). The modified link Lb Recalling the construction of LH and Proposition 
2.1, form an H-decomposition D of LH {(v, c)}. Let the roles of xb and z in the D-part Ho which contains 
the edge (w, d), be played by the vertices v and d, in that order. Also verify that c is not a vertex 
of H (note that (v, d) can be any edge in an n + 1 clique decomposed into copies of H hence no constraint 
holds regarding its role in HV ). From the D-part H. construct HO,, a new copy of H ss follows: For every 
u ~ V(HV ) such that (u, z = d) @ E(HV), replace u in Hv by a new vertex u . That is, delete every edge 
(u, w) and insert (u , w) instead. Also add a new vertex v to replace v in Hut in the role of Zk (see 
Figure 4). V =xk G .. Figure 4: The modified link module, L~ Define D = (D {HO}) U{ HV,}. Also define 
L~ to be the union of all T E D and the edge (v , c). Obviously D is an H-decomposition of L~ {(v , 
C)}. Furthermore, the neighborhood of (set of vertices adj scent to) c in LH is identical to that of 
d. The vertex d in HO plays the role of z c V(H). The neighbors of this vertex, except for v, were not 
changed. c is not at all a vertex of HU. Consequently, the neighborhoods of c and d are identical also 
in H;. Thus, switching the roles of c and d in each T c D , we obtain an H-decomposition also for L~ 
 {(v , d)}. L~ satisfies the following stronger version of Propo­sition 2.1. Proposition 2.3 Let L be 
an L~-subgraph (with 3 vertices labelled c, d and v as above) of a graph G, such that each of {v , c} 
and {v , d} is an SP of G. If D is an H-decomposition of G then there exists a D-part H(L), entirely 
contained in L such that the degree of v inL H(L) isatmost 1. Proofl Let S = ({x{, ~},..., {zj = v , 
yj}) denote the maximal SP-sequence S, as defined above, of the H­subgraph H; of L. By the construction 
of H;, S is also an SP-sequence of L and of G. Select an edge e from an {z{, ~1}-component which does 
not contain the other members of S . Let H(L) be the D-part which contains e. Clearly S is also an SP-sequence 
of H(L). If H(L) contains an edge out of L then the separating pair {v , d} of G is also an SP of H(L), 
which can be appended to S to form a longer SP-sequence -a contradiction which implies H(L) C L. Regarding 
the degree of v , this vertex belongs to the kth SP of S. S was selected to make the degree of ~k minimal. 
Thus, d(v ) in H(L) is at least d(ck) (in H). On the other hand, the degree of Vt in L is d(ak) + 1 (it 
was inserted to replace ~k and then an edge (v , d) was added). This obviously implies d(v ) <1 in L 
 H(L). The chain module CH, where H is 2-connected, 2­separable is constructed by the concatenation 
of 2m modified links L H, exactly as described in the previous subsection for 3-connected graphs. The 
vertex v of a link is replaced by the vertex v of the modified link. For the completion of the proof 
it suffices to confirm the validity of Proposition 2.2 for the case we are dealing with. The construction 
of GH(l) then remains the same. Proposition 2.4 The assertion of Proposition 2.2 holds also for the case 
where H is 2-connected, 2­separable. Proof Let C denote the subgraph obtained from the chain C after 
the edges of the D-part H(Li ), defined in Proposition 2.3, are deleted from each of the modified links 
Li. By Proposition 2.3 (although {v , c}, {v , d} are not necessarily SP S of G, they can be treated 
as such due to the 2m links along each chain) at most one of the edges adjacent to v of each Li still 
remains, in C . Two consecutive Lj s share one of these edges and thus at most one such edge remains 
in all of C . Thus C is structured of two l-separable subgraphs, possibly connected to each other by 
a single edge. A path between C s arms passes through at least m articulation points of C (see Figure 
5). , $. . ....... .. ............-- . ...-- - - .......  1--1 ....---­ ... Figure 5: C , the chain 
module after deletion of all H(Li) s Since H is 2-connected, only one D-part can be partially cent ained 
in Cl. According to the construction of a chain, the number of edges in C is 1(mod m). This clearly still 
holds for C . Thus there must be a single D-part which contains a single edge of C and this edge is clearly 
an arm of C as required. 0 3 g(lf) >1 3.1 The second proof scheme In this section we use another general 
scheme presented by Lemma 3.1. Some more notation and definitions are required before we state that lemma: 
 A Module M = (V, E, B) is a graph on vertex set V and edge set E, with a prespecified set of vertices 
B c V. The members of B are called boundary vertices of Ad. The Boundary of M, B(M), is the subgraph 
induced by B and the edges of B(M) are called boundary edges. M -B(M) is called the inierior of M, the 
edges of M B(M) are the intem or edges and V B is the set of the intefl or vertices.  A modular extension 
of a module M is a graph G  -. which contains M sa an induced subgraph, such that no edge in G M is 
adjacent to an interior vertex of J4. Lemma 3.1 H-decomposition is NPC if there exists a Square module 
SH(V1, V2, V3, V4) (shortly denoted by SH where no ambiguity is caused). The boundary of the Square module 
is a l-cycle B(SH) = {el = (U1, V2), ez = (vz, v3), e3 = (v3, v4), e4 = (V4, VI)} and it satisfies the 
following two conditions: 1. Each of SH {el, ea} and S~ -{e2, e4) is H­decomposable and 2. Every H-decomposition 
of a modular extension of SH contains an H-decomposition of either one of the above two subgraphs.  
 If g(H) > 1 then Condition ,% can be replaced by the apparently weaker requirement: 2 . Every D-part 
of ony H-decomposition D of a modular extension of SH is either entirely contained in SH or it contains 
no interior vertex. Let us see first how Condition 2 implies Condition 2 where g(H) > 1. Let D be an 
H-decomposition of a modular extension of S = SH (VI, V2, V3, V4). Let D denote the set of all D-parts 
which contain an interior edge and are hence entirely contained in S if Condition 2 holds. Clearly R 
= S &#38;e~, T is a subset of B(S) = {el, e2, es, e4}. Since g(H) > 1 the difference between the degrees 
of a vertex in two distinct unions of H-subgraphs is either O or at least 2. Thus if Condition 1 is satisfied 
then R is a complete matching on {VI, V2, V3, V4}, that is either R = {el, es} or R = {e~, eA}, which 
is the assertion of Condition 2. 1 Several building blocks should be defined for the proof of Lemma 3.1: 
Square modules are combined to form the r-alternator module r-AH = (W ~ W, E, ~ V9) as follows: g=l 
q=l Let u be a vertex for which d(u) is maximum in H (i.e. d = d(u) = maz{d(z) : z c V}). Define first 
the sets of vertices V9 = {v$:l<i sd+l}forl<q<r and W = {wi,j : z # j, 1 S i,j s d+ 1}. Construct now 
r (d~l) square moduh=, s~,j = SH (v:, W;; ~j,i ~Wi,j) foreveryl <q~r and 1< i< j<d+l. Letthe S~j s be 
vertex disjoint except for the common vertices of the Vq s and W. Also for each 1 < i < d + 1 construct 
a copy H,~ of H {u} where the d vertices wi,j j # i serve as the d neighbors of the deleted vertex u. 
We refer to these H {u~-subgraphs as wings. Let the vertex sets of the wings be otherwise vertex disjoint 
(from each other and from the Vg s and W). Notice that the induced subgraph on each vertex set, Vg in 
the boundary, is a complete graph which will be denoted by Kg (see Figure 6). If r= 2we refer to K1 and 
K2 asthe arms ofthe module. i$ Figure 6: The 2-alternator module for d = 2 The following simple observation 
is our reason to define r-AH: Proposition 3.1 The subgraph obtained from A = r-AH by deleting any (r 
1)-subset of the r cliques Kg 1< q < r is H-decomposable. The Holyer graph, lf~,p Holyer in [10] defines 
a graph Hn,p with ~pn-1 edges for every n, p >3 which satisfies the following: Lemma 3.2 There are exactly 
two distinct Kn ­decompositions of H~,P. The two Kn-decompositions of H.,P are denoted by K+ and K-. 
Proof of Lemma 3.1: To prove Lemma 3.1 we present a polynomial time reduction of 3d-XC into H-decomposition, 
where d is the maximum vertex degree in H. Let 1 = (U, d) be an instance of 3d-XC. We construct in polynomial 
time, a graph G~ (1), for which H-decomposition is equivalent to 3d-XC on I. This graph is composed of 
building subgraphs, rep­resenting elements, blocks and anti-elements where the anti-elements serve for 
garbage-collection . Following is a set of instructions for the construction of G~(l): For every A = 
{xl, ... X3.} 6 A construct the Block graph BA a copy of the Holyer graph, Hd+l ,3, where each d+ l-clique 
in K+ = {K~ }j~l and K-= {K,= }~~1 is an arm of one of 2. 3d 2-alternator modules. The other 2. 3d arms 
of these alternators, 3d for K+ and 3d for K-, will be referred to as the remote arms and remote anti­arms 
of ~,4, respectively. For each z G U let al] block graphs BA, for which z G A, share a common remote 
arm EZ (and be otherwise vertex disjoint). Also for each element z E Al, ... Ak E A, construct the anti-element 
graph, AE=, which is a copy of the k-alternator module, k-AH, and identify one remote anti-arm of BA, 
with one boundary clique, Kq, of AEZ, for each 1 ~ q s k. The obtained graph is GH (1) (see Figure 7). 
Figure 7:Apart ofGH(I) for zcA,B,C6A We omit the technical, although non-trivial, proof of the equivalence 
between a solution of I and an H­decomposition of GH(l). The first step towards establishing the existence 
of SH is the following construction of a Pre-Square module for any given graph H. The Pre-Square module, 
PSH Let H be any graph. According to Wilson s theorem select integers n and N such that Kn is H-decomposable 
and KN is Kn-decomposable. Also let N be big enough to allow two vertex disjoint copies of Kn in an Kn­decomposition 
of KN. Select four vertices VI, vz, V3, V4 of the graph KN = (V, E). Also select two disjoint (from each 
other and from {VI, V2, V3, V4}) sets A, B C V of n 2 vertices each. Let x $ V be a new vertex and define: 
 PSH(V1 , vz, V3, V4) = (V U{Z}, E-{(VI, V) : V C A}­ {(v3, v) : v G B} U{(Z, W):w A UB U {VZ, Vq}}) 
 with boundary vertices V1, VZ7v3, v4. Note that B(SH) is the 4cycle {el = (VI, V2), e2 = (02, V3), e3 
= (V3, V4), e4 = (V4, VI)} (see Figure 8). Figure 8: The Pre-Square module The Pre-Square satisfies 
the first condition required from the Square. Proposition 3.2 Each of PSH {el, e3] and PSH {ez, e4} 
is H-decomposable. H is 5-connected and g(H) >1 In that case we simply define SH = PSH. There are only 
4 boundary vertices of SH and H is 5-connected, hence, any H-subgraph of a modular extension of SH which 
contains an interior edge is entirely contained in SH. The assertion of Condition 2 immediately follows. 
1 3.2 g(n) >1 and H is Non-triangular 2­connected but not 5-connected The proof above strongly relies 
on 5-connectivity. The Pre-square module, PSH, is almost a complete graph and thus if H is not 5-connected 
then an H-subgraph can spread bet ween a square module and the rest of GH (1) in an uncontrolled manner. 
To avoid this we define here a modified pre-square module PS~ and then combine some copies of it to form 
the Square module. Some more definitions are required: Definition: A minimal separating set (MS) of a 
graph G = (V, E) isasetofverticesSCV, suchthat(G S)= (V S, E-{e : e is incident to an element of S}) 
is not connected and no proper subset of S has this property. An S-component is a subgraph of G, induced 
by the union of S and a connected component of G S. A k-separating sequence (k-SS) is a sequence Q = 
{SI, S2, ... S~} of distinct minimal separating sets of cardinality lS~I s k, such that their cardinalities 
{lSi 1} form a nondecreasing sequence and for every 1 ~ i ~ n 1 all Sj, j > i are contained in the same 
Si ­component. Let nj(Q) denote the number of MS in Q of cardinality j. Define a partial order among 
k-SS s of G by Q1 > Qz if nj(Ql) > nj(Qz) for the smallest j where nj (Ql) # nj (Qz). A maximal k-SS 
is maximal with respect to that partial order. Let Q = {S1, S2, ... Stt} be a k-SS of G. Let CO(Q, G) 
denote the union of the S1-components which do not contain Sz and let C~(Q, G) be one of the S~ ­components 
which do not contain S.-1 (If n = 1 then CI(Q, G) is any component and CO(Q, G), the union of all the 
others). Proposition 3.3 Let H be a subgraph of G and Q = {S1, ... S.} a maximal k-SS of H such that 
no edge of G H is incident to any vertex of V(H) C.(Q, H). If H is an H-subgraph of G which includes 
an edge e. E C O(Q, H) then S is a (maximal) k-SS of H . Proof ommited. The modified Pre-Square module, 
PS~ Recalling the construction of PSH and Proposition 3.2, form an H-decomposition, D, of PSH {el, es} 
where el = (VI, V2), e3 = (us, v*). Let Q = (S1, ... S~), be a maximal 4SS-sequence, where S. = {cl, 
... z,}, such that d(xr ) is minimal among all maximal 4SS­sequences. Select a vertex z # Sn which is 
adjacent to Z, in C.(Q, H). For the D-part, H.,, which contains the edge (v1, v.4), select Z,(HV1 ) = 
VI and Z(HV1 ) = V4. Also verify that V3 is not a vertex of HV1 (note that (U1, v4) can be any edge in 
an n-clique decomposed into copies of H, hence no constraint holds regarding its role in H.l ). From 
the D-part H., construct HV1~, a new copy of H as follows: For every u ~ V(HV, ) such that (u, z(H.,) 
= v4) @ E(HU1), replace u in HV1 by a new vertex u . Also add a new vertex VI to replace V1 in the role 
of G. Similarly, let the role of z, and z in the D-part, HV~, which includes the edge (V3, V2), be played 
by the vertices V3 and V2 in that order (note that (V3, W2) can be any edge in an n clique, vertex-disjoint 
from the clique which includes (U1, V4)) Using the same scheme as above construct HV~, from the D-part 
Hv~. Also add a new vertex v3i to replace V3 in the role of x~. Define 0 = (D {H.,, Hvs})lJ{H.~, H,i}. 
AlSO define PS~ to be the union of all T ~ D and the edges el and es. The boundary vertices of PS~ are 
v;, V2, v;, VA and we refer to that specific copy as Psi (v; , V2, V$, V4). It can be verified that: 
Proposition 3.4 The modified Pre-square module sat­isfies Condition 1 of Lemma 3.1. Moreover, the following 
stronger version of Proposi­tion 3.2 is obtained: Proposition 3.!5 Let G be a modular extension of a 
modified Pre-square PS~(v~, V2, v$, V4) which admits an H-decomposition, D, then there exist two D-parts, 
H(S~, vi), H(S~, v!), entirely contained in PS~ such that the degree of v: and that of vi in PS~ {H(%z, 
v;), H(S~, vi)} each is at most 1. Proof ommited. In light of the last proposition we refer to the boundary 
vertices v; and v; as the thin vertices of the modified pre-square and accordingly V2 and V4 are the 
fat ones. Constructing the Square module, SH Start with anmxrn,or(m+1)x(mi-1)if m is odd, rectangular 
grid on the two dimensional torus. Let one square of the grid be the boundary of SH and let the vertices 
of this square be denoted by vl,vz,vs,vA. Fill all the other grid squarea by copies of PS~, whose boundaries 
intersect according to their geometric adjacency. While doing so make each grid vertex either thin in 
all the modifies pre-squares which contains it, or fat in all of them. Thus a thin fat bicoloring of 
the grid vertices is induced. Let V1 and V3 be colored thin . The graph obtained is the Square module 
SH (VI, vz, us, VA). A modular extension of SH can be represented by filling the empty boundary square 
with G S (see Figure 9). As a consequence of Propositions 3.4 and 3.5, Con­dition 1 of Lemma 3.1 is 
satisfied by SH. Let us prove now that Condition 2 is also ,satisfied: Let D bean H-decomposition of 
a modular extension G of SH. Let G denote the graph obtained from G by deleting all the D-parts H(S&#38;, 
vi) and II(S&#38;, v4), defined in Proposition 3.4, from all the PS~ in SH. As a result of that proposition 
each thin grid vertex, except VI and V3 is completely saturated by the above D-parts Figure 9: G . The 
doted grid lines are not edges of thegraph and are drawn for reference only. o and . denote fatandthin 
vertices respectively. Theverticesx and g can be in any of the squares surrounding VI and V3 and it 
is hence isolated in G1. The remainder of each modified pre-square is a diagonal strip connected to the 
rest of Gt by the two fat grid vertices to which we refer as the end vertices of that strip. There might 
remain a single edge connecting VI to an interior vertex z of SH and one connecting V3 to an interior 
vertex y (in addition to many vertices adjacent to VI and to V3 in G SH). Let Ho be an H-subgraph of 
G which contains a vertex vo of G SH. Assume that HO contains an interior vertex of SH. Ho is too small 
to go around the whole torus. Let u be a grid vertex in Ho which is farmost (geometric distance on the 
torus) from the boundary square. At most two strips lead from u toward the boundary and thus either Ho 
is l-separable or it is triangular by u and the other end vertices of the above two strips u and u (see 
Figure 9). More careful attention should be paid to the case where Ho is limited to the squares which 
surround the boundary and it contains the edge (VI, z) (and/or (V3, y)). A short case analysis shows 
that also in that scenario Ho is either 1­separable or triangular by VI, x and a certain grid vertex 
whose identity depends on the exact location of x. Since H is 2-connected and non-triangular the above 
leads to a contradiction and thus Condition 2 is satisfied. 0 Triangular graphs In this section we modify 
Holyer s proof [10] to obtain the following: Lemma 4.1 H-decomposition is NPC for any 2­connecied triangular 
graph H. To prove Lemma 4.1 we present a polynomial time reduction to H-decomposition of the 3SAT problem, 
defined aa follows: Definition: An instance of 3SAT is a set of clauses C = {Cl, ... C,} in variables 
UI, ... u,. Each clause C i consists of three literals li,l, li,2, li,3 where a literal Ii,j is either 
a variable uk or its negation W. The problem is to determine whether C is satisfiable, that is, whether 
there is a boolean assignment to the variables which simultaneously satisfies all the clauses in C. A 
clause is satisfied if one or more of its literals has value %ue ~. The basic building block for the 
reduction is a modified version of the Holyer graph, H3,P (see the definition of Hn,P in [10] and Figure 
10). ,,   , , ,0 , ,/ , ,4 (0,0,0) (1,-1,0) (2,-2,0) -----.---------. ..---* Figure 10: H3,3 embedded 
in the (2-dimensional) torus (and modified for kf,). Lemma 4.2 The graph H3,P has the following proper­ties: 
1. The degree of each vertex is 6. 2. The largest complete subgraph is a triangle. 3. The number of 
triangles containing a particular vertex is 6.  Each edge occurs in just two triangles. 4­ 5. Each 
two distinct triangles are either edge-disjoint or have just one edge in common. 6. There are just two 
distinct edge-partitions of H3,P into K3 s.  All the above listed facts are trivial. A proof in the 
wider frame of H~,P can be found in [10]. The two K3 partitions of H3,P will be called true and false 
partitions, denoted by T-partition and F­partition. Two KS S in H3,P are called neighbors if they have 
a common edge. Also define a patch to be the subgraph of H3,P consisting of the vertices and edges of 
a particular KS and its neighbors. It is a T-patch if the central K3 belong to the T-partition, and it 
is an F­patch otherwise. Two patches P1, P2 in H3,P are called noniderfering if the distance d(x, g) 
in H3,P between vertices z e V(P1) and y c V(P2) is always at least 10. Proof of Lemma 4.1: Let the 
graph H be triangular by vertices V., VI and V2 and components Go, G1 and G2. Select vo, V1, V2 and Go, 
Gl, Gz such that [J!?(Go) I will be maximum among all possible triangular representations of H. Let 1 
= {c,, ... C,} in s variables U1, ...u, where each C i consists of literals li,l, li,2, li,3. We construct 
a graph G~(l), for which H-decomposition is equivalent to 3SAT on I. Label each of the vertices of H3,P 
either VO, V1 or V2 such that the labeling forms a proper 3-coloring and replace every edge (vi, ~i+l 
) (mod 3) by a copy of the component Gi. Let all these copies of Go, G1, G2 be disjoint except for the 
common original vertices of H3,P. In the obtained graph Mp we have a copy of H replacing every triangle 
of H3,P. Accordingly A4P admits T and F H-decompositions and has its T and F patches. (see figure 10). 
Every H-subgraph of MP obtained from a triangle of H3,P will be refered to as a K~. Take a copy Ui of 
MP to represent each variable ui and copies Cl,l, Cl,s, C1,3 of MP to represent each clause Cl. Join 
these copies of MP together as follows: If li,j is uk, then identify an F-patch of C i,j with an F-patch 
of Uk. If is ~, then identify an F-patch of Ci,j with Ii,j a T-patch of Uk. AlSO join Ci, 1, Ci,2 and 
Ci,3 for each i by identifying one F-patch from each and then removing the edges of the central K~. 
Choose all patches which occur in a single MP copy to be noninte rfering. The obtained graph is G~(l). 
 If C is satisfiable, we partition GH(I) by partitioning uk according to the truth of uk in a satisfying 
assign­ment, choosing one true literal li,j for each i, and F-partitioning the corresponding Ci,j. suppose 
that there exists an H-decomposition, D, of GH(l). Maximality of Go implies {w, Z} C {v2} U V(GO), for 
each separating pair {w, z} such that w G V(Gi) and z G V(Gj) (i # j). Let S be the multy-set of all 
SP S of all D-parts and consider one particular K$, say A, in GH (1). First we assume that each of the 
three components of A is included in exactly one D-part. Thus it is enough to consider K3-decomposition 
of G~(I) which is obtained from GH(l) by replacing each such component by a simple edge. Suppose that 
there is a K3-decomposition of G~(l), and consider a particular copy M of a modified it4P (that is a 
copy of HS,P) involved in the construction of GH(I). Take a D-part, say B, which is in M but not near 
any join. Clearly, the neighbors of B do not belong to D, and the neighbors of neighbors of B do belong 
to D and so on. Therefore the edges of M except perhaps those involved in joins, are all T-partitioned, 
or all F-partitioned. Thus we may say that M is T or F partitioned. Now suppose li,j is uk and consider 
the join between C i,j and uk. We claim that the edges in the vicinity of this join are K3-decomposable 
if and only if at least one of Ci,j, Uk is T-partitioned. If (say) Ci,j is T­partitioned, this accounts 
for all the edges of Ci,j near the joining patch except for those of the patch itself. The patch can 
be regarded as belonging to uk, which can then be locally partitioned in either way. If on the other 
hand both Ci,j and uk are F-partitioned, the argument of the previous paragraph shows that the edges 
of the patch not belonging to the central K3 are forced to belong to the F-partitions of both Ci,j and 
uk, which is a contradiction. Similarly if Zi,j is ~, then either Ci,j is F-partitioned or uk is T-partitioned. 
To complete the proof we will show that each of the three components of A is included in exactly one 
D-part. Obviously, S contains all SP S included in one of the three components of each K: in GH(I). Therefore, 
the only SP S which are not guaranteed to be in S are {w3, w}, w G V(G1) \ {w, W} for some K&#38;subgraph 
of G~(l). First assume that there is no such SP in H. Simple counting arguments imply that each of the 
three components of A is contained in exactly one D-part. Finally consider the csse where H contains 
n SP S, {v2, wl},.., {v2, w~} such that wi ~ Go, i = 1,.., n (VCI= WI and VI = w.). Obviously, each 
D-part which intersects the Go component of A, implies &#38;) > n SP s in S. Since there are n 2 problematic 
SP S, itimplies that Go intersects exactly one D-part. Therefore each of Go, G1 and G2 is included in 
exactly one D-part. 0 5 H is l-separable In this section we prove: Theorem 5.1 If H = (V, E) is a l-separaNe 
graph with [El >3 then H-decomposition is NPC. Definition: Let D be an H-decomposition of G and let x, 
v be uertices of H and G respectively. We define N(z, v, D) to be the number of D-parts, H , for which 
z(H ) = v. Let x be a separating vertex of H and let C be an z-component of H. Let D be a C-decomposition 
of a graph G. We construct the {H, C, D)-expansion, G , as follows: For each vertex v of G construct 
n(v) = N(z, v, D) copies of H C, in which v is identified with x and the other vertices are new. Let 
these copies be denoted by (H C)i,v, 1< i < n(v), v c V(G). Finally define G =G U U (H-C)iv. v~V(G) 
l<i<n(u) .. Let z be a separating vertex of H such that at most one z-component is l-separable and let 
C be a 2-connected {x}-component. Select z and C such that IE(C)] is maximum. Let us first assume that 
C is non­triangular. The new Pre-Square module, NSH The basic building block here is the modified Pr~ 
Square module PS~ for 2-connected, non-triangular graphs defined in Section 3. Recall the main properties 
of the modified square module PS~: The boundary of the rnodijied Pre-Square module is a J-cycle B(PS~) 
= {cl, e~, es, e~} where el = (vl,vz),ez = (vz,vs),es = (vs, v4), e4 = (04, v1) and it satisfies the 
following two conditions: P1. Each of PS~ {el, e3} and PS~ {ez, e4} is H­decomposable. P2. Let G be 
a modular extension of a modijied Pre­square PS~ which admits an H-decomposition, D, then there ezist 
two D-parts, H(vI ), H(v3), entirely contained in PS~ such that the degree of V1 and that ofv3 in PS~ 
 {H(vl), H(v3)} each is at most 1. Let D be a C-decomposition of PS&#38;. We define the new Pre-Square 
module, NSH (D), to be an {H, C, D}­expansion of PS~. Lemma 5.1 1. {el, e3} admits a C-decom­ ~sc(vl 
, V2, V3, V4) position, D1, such that N(z, v2, Q) = N(z, v4, DI).  2. There exist C-decompositions, 
D1 and D2, of PS&#38; {el, e3} and PS&#38; {e2, e4} respectively, such that N(z, vz, D1) = N(z, v4, D1) 
= N(z, v2, D2) = N(g, V4, D2). 3. NSH = NSH(D1) = NSH(D2) is well defined and satisjies P1. 4. NSH 
satisfies P2 if every H-decomposition of NSH impiies a C-decomposition of a PS~ subgraph of NSH.  Proofi 
1. Recall that by definition PSC {el, e3} is KN­decomposable for some constant N for which KN is C-decomposable. 
The total symmetry of K~ clearly allows the required structure of L)l. 2. Let D1 be aa above and let 
D2 be the decomposition obtained from D1 by switching the roles of V2 and V4. 3. Add to each Di-part 
(i = 1, 2), one copy of (H C), to obtain an H-decompositions in accordance with P1. 4. PS&#38; (and 
thus NSH) satisfies P2, if its H­decomposition implies decomposition of every PS&#38; subgraph.  From 
this Pre-Square module we construct the mod­ified Square module, Sk, following the construction for 2-connected, 
non-triangular H, replacing each PS~ by a copy of NSH. C is non-triangular and g(C) >1: Let z be a vertex 
with d = d(z) maximum degree in C. Once more we use the general scheme presented in Section 3 to obtain 
a reduction of 3d-XC into H­decomposition. Let 1 = (U, A) be an instance of 3d-XC. GH(l) is defined as 
follows: Construct Gc(l) (as defined in Section 3 for 2­connected, non-triangular graphs) and let G be 
the graph obtained from GC(l) by replacing its square modules by the above modified square, S$. Let S(G) 
be the union of all square modules in G. Let D be any C-decomposition of GC(I) and let D = {P : P E D, 
P @ S(G)}. Notice that n(v) = N(,z, v, D ) is independent of D (see proof of Lemma 3.1 in Section 3). 
Finally define GH(l) to be an {H, C, D }-expansion of G. Now, let us verify that H-decomposition of GH(l) 
is equivalent to 3d-XC on 1: If X c A is a solution of 1 then G~(l) is H­decomposable exactly as in Section 
3. On the other hand, let N = (i.e. the number of copies of ~ H in every H-decomposition of G~(l)). For 
any 2­connected, non-triangular graph C, let Gc (1) be the graph (defined in Section 3) for which C-decomposition 
is equivalent to 1. Obviously GC (1) is a subgraph of GH (1). Moreover, GH(l) -GC (1) is a union of N 
copies ofH Cand if(H C)i isthe i-th copy ofH Cand z.((H C)i) = ~i then V((H C)~) \ {z~}, i = 1,2, ... 
are pairwise disjoint. Lemma 5.2 Every H-decomposition of GH(I) implies a C-decomposition of GC(I). Proofi 
Let D be an H-decomposition of G~(l). If each z­component of H is isomorphic to C then each D-part is 
an edge-disjoint union of C-subgraphs. Therefore assume that not all the z-components are isomorphic. 
We wish to prove that for every D c D, E(D ) (1 E(GC(I)) is an edge-disjoint union of copies of C. Take 
any separating vertex, say v, in GH(l) (v E V(GC(I))) and take any v-component in G~(l), say C , which 
is edge-disjoint from GC(I). First assume that Cl is l-separable. Cl is contained in at least one D-part. 
Since Cl cent ains the maximal path of separating vertices in H, at most one l-separating component is 
contained in each D-part. Since the number of such components in G~(l) equals N = (GH ~)) C must be contained 
in exactly one D-part. +, On the other hand, if C is not l-separable, select lZ(C ) to be minimum. Since 
E(C) was chosen to be maximum, C must be cent ained in exactly one D-part. Remove all copies of C and 
continue with the next smallest z-component. G~(l) Gc(l) contains IV edge-disjoint copies of H C, i.e. 
N edge-disjoint copies of each 2-connected component of H, except C. Each such component is contained 
(as a block) in exactly one D-part and if we remove all those components from D we obtain a C­decomposition 
of GC(l). D Lemma 5.2 together with the proof for 2-connected, non-triangular graphs in Section 3 implies 
the required. C is a triangular graph: The same arguments applied to Gc (1) in Lemma 5.2 also holds 
for the construction in Section 4 to obtain Theorem 5.1. C is non-triangular and g(C)= 1: To handle 
the case where g(C) = 1 we need some modifications of the above construction. Let z be a separating vertex 
of H such that at most one x­component is l-separable and let C be a 2-connected {z}-component. Select 
z and C such that IE(C)[ is maximum. First, notice that the modified Pre-Square PS&#38; (for 2-connected, 
non-triangular graphs) satisfies Condition 2 of Lemma 3.1 without constrains on g(C). Moreover, the modified 
Square module satisfies the following variation of Condition 21. 262 Proposition 5.1 Let G be a modular 
extension of a modijied Square module S = S~ (VI, V2, V3, V4) which admits a C-decomposition, D. Let 
G = (V(G), E(G~) (1 E(S)) where GD is the graph obtained from G by removing all D-parts which are internal 
to the square, S. 1. E(G ) = {cl, ez} where ei, i = 1,2 are two boundary edges. 2. The degree of VI 
and us in G is exactly 1.  The first property is clear from Condition 2 and to verify the second, recall 
that VI and V3 were thin vertices. Take any vertex, say z, in C and let d = d(z). We follow the construction 
above to obtain a reduction of 3d-XC into H-decomposition. Recall that the construction didn t required 
any constrains on d(z) and and g(C). Therefore, given 1 = (U, d), an inst ante of 3d-XC, construct GH,Z 
(1) from Gc,= (1) as above with the following exception: For any 2-alternator module in Gc,= (1) and 
1< i < d + 1, let Wi,i+l be a thin vertex in s~,i+l (additions are cyclic in 1, ... d+ 1) and let ~i+l,i 
be a thin vertex in S,2+~,i (see Section 2, r-Alternator module, for the definition of wi,j and S~,j 
). The validity of the construction follows from Lemma 5.3 and the selection of z. Lemma 5.3 H-decomposition 
is NPC if there exists a vertex z in C such that for every C-decomposition, D, of Gc,Z(I), each wing 
is contained in exactly one D-part. Proofi Suppose z is a vertex as required and let D be a C­decomposition 
of GC,Z (1). Take any 2-alternator of GC,Z (1), A = 2-AC and let Di, 1 < i < d+ 1 be the D-parts which 
are internal to A but not to any Square module. Since each wing is contained in exactly one D-part, V(Di 
) is V(H2~) u{v~ } for some q~ c {1, 2]. First, we show that ~ = ~1 = ... = *d+l. suppose, without loss 
of generality, that ql = 1. Since W1)2 is thin in S~,2 and W2,1 is thin in S~,l, the edge (wz,l, v;) 
is not in D2 and therefore qz also equals 1. Now take any H-decomposition, D, of GH,Z (1). By Lemma 5.2, 
D containes a C-decomposition, D , of Gc,z(I). As seen above, all The 2-alternators are decomposed properly 
and a solution for I is obtained. 0 To complete this section we show how to select z to obtain the required 
condition for Lemma 3.1. First, let us assume that z is adjacent to every vertex in C and select z to 
be x. Let D be a C-decomposition of Gc(l) which exists by Lemma 5.2 and let D be the set of D-parts which 
are not included in any Square module. Take any vertex w = Wi ,j. If w plays the role of z in a D -part 
then its vertex set, V is included in {wi,~, 1< k # i < d(z)} lJ{wj,i}U{~},9 = 1,2, ..}. If wj,i ~ V 
then its degree is 1 a contradiction. Therefore, each wing is contained in at least one D -part and 
a counting argument shows that it must contain all the wing. Hence, all vertices playing the role of 
z are Vq s. Each v: is connected to at most one wing (othe;wise C is l-separable) and once more each 
wing is contained in exactly one D -part. Therefore, we can assume that there exists vertex in C which 
is not adjacent to x. In that case, select z to be a far most vertex from z and denote its distance from 
z by 1. Again, let D be a C-decomposition of GC(I) after removing the parts which are included in Square 
modules. Take any D -part, P, which contains z(H,~ ). It is essy to see that z(P), is .z(H,7 ). Moreover, 
P contains (entirely) the first I 1 IeveIs of the 13FS tree of H,:, rooted at z. Any vertex in V(P) 
\ V(Ht: ) must be in the l-th level of the tree and it must be adjacent to some vertex from the 1 l-th 
level. Therefore, each vertex of P which is not in H,: is not in any other wing ( otherwise, C is l-separable 
) and each wing is contained in exactly one D -part. 0 References [1] N. Alon, A note on the decomposition 
of graphs into isomorphic mat things. , Acts Math Hung. 42 (1983), 221-223. [2] J .C. Bermond &#38; D. 
Sotteau, Graph decomposition and G-designs. , Proc. of the 5th British combina­torial conference., Aberdeen 
(1975). [3] A. Bialostocki &#38; Y. Roditty, 3Kz-decomposition of a graph, Acts math. Acad. Sci. Hungar. 
40 (1982), 201-208. [4] A. E. Brouwer &#38; R. M. Wilson, The decomposition of graphs into ladder graphs, 
Stiching mathematisch centrum (zn 97/80), Amsterdam, 1980. [5] Y. Care, Decomposition and Partition of 
trees into isomorphic sub trees., Tel-Aviv Universit y (M .Sc Thesis), 1985. [6] E. Cohen &#38; M. Tarsi, 
NP-Completeness of Graph-Decomposition Problems, Journal of Complexity 7 (1991), 200-212. [7] 0. Favaron, 
Z. Lone &#38; M. Truszczynski, Decompo­sition of graphs into graphs with three edges, Ars Combinatoria20 
(1985), 125-146. [8] M. R. Garey &#38; D. S. Johnson, Computers and In­tractability, a guide to the theory 
of NP-completeness, W. H. Freeman and Company, San Francisco, 1979, [9] Ian Holyer, The complexity of 
graph theory prob­lems., Churchill College (Ph.D dissertation)., Cam­bridge, 1980. [10] Ian Holyer, The 
NP-completeness of some edge partition problems., Siam J. of comp. 10 (1981), 713-717. [11] D. G. Kirkpatrick 
&#38; P. Hell, On the completeness of a generalized matching problem, 10th annual ACM Symposium on Theory 
of Computing Machinery, New-York, 1978. [12] Masuyama &#38; Hakimi, Edge packing in graphs, preprint. 
[13] M. Preisler &#38; M. Tarsi, On the decomposition of graphs into copies of Pa U t Kz ~ Ars Combinatorial 
(To appear). [14] J. Steiner, Combinatorische aufgabe. V Z. Reine Angew Math 45 (1853), 181-182. [15] 
R.M. Wilson, Decomposition of a complete graph into subgraphs isomorphic to a given graph. , Utili­tasMath, 
Winnipeg (1976). 
			