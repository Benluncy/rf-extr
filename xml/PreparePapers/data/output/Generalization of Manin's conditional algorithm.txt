
 Generalization of Manin's Conditional Algorithm by Horst G. Zimmer Fachbereich 9 Mathematik Universit~t 
des Saariandes D-6600 Saarbrdcken, Fed. Rep. Germany I. Introduction and Manin's theorem In a Lecture 
~6] delivered at the con- ference on "UtiLisation des caLculateurs en mathematzques pures" in France, 
we de- veloped some ideas regarding the impLe- mentation of Manin's conditional aLgo- rithm [7] for computing 
the rank and a basis of the group of rational points on an eLLiptic curve C over the rationals @. The 
aim of the present paper is to dis- cuss to which extent this algorithm can be generalized to eLLiptic 
curves C de- fined over an arbitrary finite-aLgebraic number field K. Furthermore, certain pro- btems 
concerning the implementation of - the generalized algorithm wiLL be trea- ted. Some results obtained 
in this con- nection seem to be also per seof interest. In an appendix we shaLL give complete proofs 
of the assertions made in sections 1,4, and 6. Let C denote an eLLiptic curve in Weierstrass normal 
form Y2 = X 3 + aX + b with coefficients a,b in an algebraic number field K of finite degree n=[K:Q] 
 over Q. The nonzero discriminant of C is a = 4a3+27b 2. Without Loss of genera- Lity, the coefficients 
a,b and thus the discriminant a may be assumed to be in- tegers in K. By the MordeLL-Weii theorem, the 
additive abeLian group C K of rational points of C over K is finitely generated. Hence this group can 
be written as a di- rect sum of the finite subgroup CK of aLL torsion points (points of finite order) 
in C K and a maximal free subgroup CK of C K of finite rank. The number r of basis ele- ^ ments of 
C K is caLLed the rank of the eLLiptic curve C over K. Manln's conditi- onal algorithm consists in determining 
first the torsion subgroup CK of C K and second a maximal free subgroup cK/ of c K in terms of a basis. 
Of course, this yields at the same time the rank r of C over K. The conditions on which the aLgo-rithm 
depends are the truth of the con-jecture of Birch and Swinnerton-Dyer [7,1o] and the feasibility of estimating 
the L-series L(C,s) of C over K and its (i) C derivatives L (,s) at s=1, where i ranges from I through 
a certain positive integer r' (see [7] and Manin's theorem below). The Latter condition is satis- fied 
in the case K=Q provided that the WeiL conjecture is true (see [7,11]). Before stating Manin's theorem 
on which the algorithm is based we have to introduce some notation and recaLL cer- tain facts. Let us 
begin with defining the N4ron- Tate height h on C K which is an impor- tant tool in the algorithm. To 
this end we shaLL use an auxiliary function d on  Proceedings of the 1976 ACM Symposium 285 on Symbolic 
and Algebraic Computation C K. The function d is the natural genera- Lization of a corresponding function 
in- ^ troduced in ~6] for defining h in the special case K=&#38;#169;. For a point P= (~,~) in CK, the 
(affine) coordinates ~,~ E K can be written in the shape = 7x and ~ = z~ 9  where x,y, and z are some 
integers in K. If ~ and ~ are both nonzero the integers x,y, and z are aLL nonzero and can more- over 
be chosen in such a way that the g.c.d.'s of x,z 2 and y,z 3 (as divisors of K) are (x,z2)=¢ 2 and (y,z3)=c 
3  with an integral divisor c of K belonging to a fixed system V of representatives of the (finiteLy 
many) divisor classes of K. The divisors c wiLL in fact be chosen in such a way that their norms are 
bounded by the Minkowski bound B (see [4,12,13}and appendix for details). In what foLLows Log wiLL always 
denote the Logarithm to a fixed base. We now define the function d on C K by  setting n d(P)=2n~ Log 
H max v=l {2j~ Iz(V)12 , 3~ Iz(V)12 ' Ix(')l} for PeC K , where a (v), b (v), x (v), and z (v) desig- 
nate the images of a,b,x, and z under the n = [K:~] distinct embeddings K ~>K(V)g ¢ (v=l ,2,. ..,n) 
 of the field K into the complex numbers e and I...] denotes ordinary absolute value on ¢. This definition 
can also be used if ~=0 by simply choosing x=0, z=l. If p=o=(~,~) is the neutral element of the addition 
in CK, we set d(P)=O. Notice that the function d arises from the usual WeLt height h on C K by only a 
slight modifi- cation [3,8,14]. We caLL d therefore the modified WeLL height on C K. The N6ron- Tate 
height h on C K is now defined by putting h(P) = tim d for PEC K 2~ . m-~ 2 Lm The function h gives 
rise to a symmetric bitinear form g on C K × C K via [8]  g(P,Q)=½ for (P,Q) E C K x C K. By means 
of the biZinear form g we de- fine the determinant of the eLLiptic curve C over K as the quantity H=Idet 
(g(Pi'Pj))li,J=l ,... ,r ' where the points P1,...Pr are a basis of a maximal free subgroup ~K of C K 
. The determinant H cLearLy does not depend on the choice of the group CK and the points P1,...,Pr in 
CK since any other choice just amounts to applying a unimoduLar transformation of determinant ±1 to the 
points P1,...,Pr originaLLy chosen. We need furthermore a Lower bound h' for the values of the Neron-Tate 
height on the set C K\ CK (the complementary set to CK in CK) , that is,a real number h' such that 
 O<h'~ min {h(P); PECK\CK} . FinaLLy, the deviation of the modified WeLL height d from the N6ron-Tate 
height on C K plays a significant rote in Ma- nin's theorem. Let 6 denote an upper bound for this deviation 
such that we have Id(P)-h(P)l g 6 for PEC K . It is for the sake of keeping the bound 6 as smali as 
possible and making the func- tion h easily computable that we have cho- sen the above modified WeLL 
height d in- stead of the usual WeLL height h for de- fining the N6ron-Tate height h on C K . Manin's 
theorem assumes exactly the same shape as in the special case K=Q (see [7,16]), though the constants 
invoL- ved become somewhat more compiicated.  286 Theorem (Manin ~ o16 ] ). bitrary finite-aLgebraic 
number field K as Suppose that r'E~ and H'E~ are upper bounds for the rank r and the determinant H of 
the eLLiptic curve C over the number field K. Then, the set of points PECK\C K satisfying the inequality 
 2 2r' H,2 (1-r') d(P)~6+ ~ max {1,h '2 } , where Cr, stands for the volume ot the r'- dimensional unit 
baLL in EucLidean space, generates a subgroup of index p~r'! in a certain maximal free subgroup CKmCK/CK 
of C K Of course, the set of points P~CK\C K mentioned in the theorem is finite since there are only 
finitely many points in C K having bounded Well height [8,14]. The proof of the theorem (see [7]) is 
based on the method of successive minima from geometry of numbers appZied to the Lattice generated by 
the Z -moduLe C K in the r-dimensiona~ reak space CK~]R. The NSron-Tate height h is a positive de- finite 
quadratic form [7,8,14] on C K ®z]R and thus defines a EucLidean norm on this space. Since the kerneZ 
of the canoncicaL -moduLe homomorphism C K ~ CK ~]R is precisely the torsion subgroup C K of CK, we 
get an injective embedding of any maxi- mal free subgroup CKZ-CK/CK and ¢--- CK~ z ~ may therefore identify 
C K with the Lattice generated by C K in the space CK®~]R. Martin's algorithm now consists mainly in 
finding, by triaL and error, aLL points satisfying the inequality of the theorem and then deriving from 
this set of points a maximaZ free subgroup CK of C K in terms of a basis. This is achieved by repeated 
"divisions by two" and the "infinite des- cent" procedure known from the proof of the MordetL-WeiL theorem 
[8]. So far the algorithm was restricted to the case K=~. As pointed out at the beginning, we wish to 
discuss here the possibilities of ex- tending it to the general case of an ar- ground field for the 
curve C. The inten- ded discussion concerns the determination of the torsion subgroup CK of C K and the 
computation of the constants appearing in Martin's theorem. 2. The torsion subgroup Manin (see [9]) 
has shown that, for any fixed prime p, the order of the p- component of the torsion subgroup CK of the 
rational point group C K of any eLLiptic curve C over K is bounded by a constant depending only on K 
and p. On the basis of a similar result Dem'janenko Eli established the boundedness of the order of the 
group CK itself, the bound depen- ding only on the field K (though the effectiveness of Dem'janenko's 
arguments does not seem to be quite clear). Thus, in some sense, there are not too many torsion points 
in CK: The actual determi- nation of the group C K can be accomplished A by applying the height functions 
d and h on C K in combination with a generaZizaticn of the cLassicaL theorem of NageLL and Lutz. This 
theorem hoZds originally onZy in the speciaZ case K=~ but it can be ge- neralized to an arbitrary finite-aLgebraic 
number field K as was shown in [15], the- orem 2. SimiLarLy, the strengthened ver- sion of the theorem 
of NageZZ and Lutz used in [16] for computing CK if K=~ carries over to the general case of an ar- bitrary 
finlte-aLgebraic number field K (see theorem I in [15]). Other methods have been recently developed 
in [2]. We shaLL state the generalized strengt- hened version of the NagetL-Lutz theorem in a form which 
is most appropriate for computational purposes. To this end we in- troduce the (formaL) coefficient divisor 
 [15] m= HP p~P of the Weierstrass equation for C by  287 defining, for each prime divisor (finite 
place) ~ of K, a rational exponent  ~p= min {½ wp(a), ½ w (b)} , where wp denotes the normalized valuation 
 on K belonging to p such that wp(K*)=~ . A divisibility relation mly between the (formaL) divisor m 
of K and a nonzero element yEK is to be understood in the usual sense that ~ ~wp(v)r for aLL prime 
 divisors ~ of K. Theorem. Let P= (~,~) be a point of order m in C K. Then, the foLLowing divisibility 
re- Lations hold: ml~ , m31~ 2 if m is not an odd prime power, and 2 6 mP -~'~" Ig , m3p -~'TT I~ 2 
if m=pV(v~1) is an odd prime power, and furthermore,   ~21am-3 if m is neither 2 nor twice an odd 
prime power, and 2 2 ~=0 or ~ IAm-3p if m=2 or m=2pV(v~l) is twice an odd prime power. The proof 
of this theorem is to be found in [15]. The theorem, giving only a necessary con- dition for a point 
P=(~,~) in C K to be a torsion point, can be applied in com- bination with the height functions d and 
h on CK in order to determine the fi- nite group C K as foLLows. A point P in C K belongs to C K if and 
only if h(P)=O (see [14]). Therefore, we conclude from section 1 that CK is contained in the finite set 
~K of aLL points P in C K  satisfying d(P)~6 with the real bound 6 which wiLL be ex- pLicitLy given 
in section 4. The set ~K is known from Manin's theorem. Now we de- termine the subset ~K~SK consisting 
of the zero point 0 and aLL points P=(~,~) in ~K which fuLfiLL the necessary con- dition of the above 
theorem. Then we get rid of those points in ~K having infinite order by checking repeatedly if 2PEN K 
whenever PEN K. In case 2~ for some PE~K we discard the point P from the set ~K" After a finite number 
of steps we end up with the searched group C K. 3. Bounds for the rank Up to now it is not known if 
the rank r of any eLLiptic curve C over a number field K is bounded by a constant depen- ding only on 
K or if r can become arbitra- rily Large as C ranges say over a sui- tably chosen infinite set of eLLiptic 
curves C over K. However, for a fixed eLLiptic curve C over K upper bounds for r, depending on C and 
K, can be given. Whereas in the special case K=@ trea- ted in [16] we used a method of Tate for estimating 
the rank r of C over K, we shaLL here refer to a bound for r which was recently given by Heuss [5] in 
the general case of a finite-aLgebraic number field K as ground field for C. Instead of the assumption, 
made in [163, that the group C@ contains a point of order 2, we shaLL here require the group C K to con- 
tain aLL points of order L of the curve C for a fixed prime number t. These so- caLLed L-divislon points 
of C are known to form a subgroup of isomorphism type ~/L × ~/L in the torsion group C~ of the curve 
C over the algebraic closure K of K. The requirement imposed on the rati- onal point group C K amounts 
to a rather severe restriction of generality. Of course, one can always shift from K to 288 the finite 
extension T of K obtained by adjoining to K the coordinates of the L- division points of C and thus shift 
from C K to the rational point group C T of C considered as an eLLiptic curve over T. But then one encounters 
the open problem as to how the rank of the curve C behaves under the shift from K to the L-divislon field 
T over K as the new ground field for C. Now we shaLL state the theorem giving a bound for the rank r 
of the eLLiptic curve C over K provided that C K contains the L-division points of C for a fixed prime 
number L. Let S denote the set of prime divisors p of K such that either p divides the prime number L 
or the func- tion field Fc/K of the curve C over K has bad reduction modulo p. Observe that S is a finite 
set. Theorem (Heuss [5]. Let C be an eLLiptic curve over a fi- nite-algebraic number field K whose 
rati- onal point group C K contains the L-divi- sion points of C for a fixed prime number L. Denote 
by S the set defined above. Then, the rank r of C over K satisfies the inequality r(2{rkt~s(E) + rk 
U(K) + ISI} + I, where rkL~s(K ) and rk u(K) stand for the usual rank of the L-component of the S-cLass 
group ~s(K) of K and the usual rank of the unit group u(K) of K, res- pectively, and IS] designates 
the cardi- naLity of the set S. Remark, Section 2 yields right away the decision as to whether or not 
the condition of the theorem regarding the L-division points of C is satisfied for the given eLLiptic 
curve C over the aLge- braic number field K. As G. Frey pointed out to the author, a similar estimate 
for r can be derived from the theorem of Bashmakov and Tate (see [7]) even without  the restriction 
made in the above theorem. It is the bound of this theorem which we propose as the choice of the number 
r' occurring in Manin's theorem. This bound proves to be sharper than a similar bound exhibited by Honda 
(see [5,6]). s  4. CaLcuLations inyoLving the Neron-Tate height Let us first estimate the deviation 
of the function d defined in section I from #  the Neron-Tate height h on the rational point group 
C K. RecaLL that K is a finite- algebraic number field of degree n=[K:@]. We have n=rl+2r2, where r I 
is the number of real and 2r 2 the number of complex em- beddings of the field K into the complex numbers 
g. Designate by D the discriminant of the field K. Then we have for PEC K -2 Log Log B, where the quantity 
~ is defined by (com- pare section I and appendix) n ~= Log H max {~a~V/~,~Ib~VJ~} and B denotes the 
Minkowski bound of K (see [4,12,13]), that is, n! ,~" B= (~) r2 nn The above estimate for the difference 
d(P)-h(P), where PECK, coincides precise- Ly with the one indicated in [16] in the special case K=Q because 
we have then n=l and the term involving the Minkowski bound disappears. AccordingLy, we choose the constant 
5 of Manin's theorem as 5= 5 Log 2+ 2n W~+ Log B ~ ~  which is the adaquate generalization of the 
choice of 8 made in [16]. The determination of a Lower bound h' for the N~ron-Tate height h on CK\ CK 
is achieved as in [7,16]. Since d(P)-h(P)~8 for P(C K , 289 it suffices to choose h'= rain {6,h(P); 
PECK\C K such that d(P)<2~ } because there holds h(P)a6 for aLL PEC K such that d(P)~28. As pointed 
out in sec- tion 2, we have h(P)=0 if and only if PECK. Thus O<h'¢ min {h(P); PECK\CK}  as desired, 
the positivity of h' being a consequence of the facts that h is posi- tive definite on CK\C K.. and that 
there are only finitely many points P in C K satis- fying d(P)<26 (see [8,14]). For actuaLLy determining 
h', one has to approximately caLcuLate h(P) for a fi- nite number of points PECK\C These K.__ points 
are found by trial and error as in the application of Manin's theorem. In order to approximately compute 
h(P) for a given point PECK\CK, one can utilize the relation [14]  d(2i-lp'2i-lP) i=1 22i in which 
the expressions d(2i-1 p, 2i-lp)=d(2ip)-4d(2i-lp) satisfy the inequalities (see appendix) U~ 12 -15(Log 
2+ -~-)- -~-Log B~d(2i-lp,2i-lp) 6(Log 2+ 7i.~)+ n ~ ~og B. Hence, the degree of accuracy in the caL- 
culation of h(P) is evident from the es- timate (see appendix) -2~m (Log 2+ U~ n24 tog B m d(2i-lp,2i-lp) 
 h(P)-d(P)-E i=1 22i 27m(Log 2+ ~)+ U~ n22m log B 1 . An approximate caLcuLation of h(P) for aLL 
PECK\C K such that d(P)<26 in accor- dance with the above explanations Zeads to the corresponding approximation 
of the searched value h', and this approxi- mation can be carried through to a suffi- cient degree of 
accuracy. 5. Estimation of the determinant In this section the most critical point of the attempted 
generalization of Manin's algorithm is reached. Estimating the determinant H of the eLLiptic curve C 
over K means a difficult problem because H is defined by virtue of a basis of the rational point group 
C K (see section 1), whereas such a basis is just to be deter- mined by the algorithm using H. Manin 
[7] solved this problem in the case K=~ under the condition that the Welt conjecture and the Birch and 
Swinnerton-Dyer conjec- ture are true. The determinant H is close- Ly connected with the behavior of 
the L- series L(C,s) of C over K near s=l via the conjecture of Birch and Swinnerton- Dyer (see below). 
But for K=Q the function /% L(C,s) and its derivatives Lti)(C,s) for i=l,...,r' can be approximately 
evaluated at s=1 via the Well conjecture. In this way the desired estimation of H is then accomplished. 
 Turning to the general case of an ar- bitrary finite-aLgebraic number field K over which the curve C 
is defined we stiLL can utilize the relation, supplied by the conjecture of Birch and Swinnerton-Dyer, 
between the determinant H of C over K and the behavior of the L-series of C over K near s=1. But since 
an analogue of the Well conjecture is Lacking (see [11]), there seems to be no comparable tool for approximately 
evaluating L(C,s) and 7 % L~i)(C,s) for i=1,...,r' at s=l in the general case. Let us discuss the 
general situation in detaiL.  For each prime divisor p of the number field K, we define the Local L-series 
of the eLLiptic curve C over K as foLLows. Suppose first that C has good reduction modulo p such that 
the reduced curve C(p)=C mod p is an eLLiptic curve defi- ned over the residue field K(p) of K with respect 
to p. RecaLL that the norm ~p=pfP=q is just the cardinaLity of K(p) (see [4,12]), where fp= [K(p):]F~ 
stands for the degree of p over the prime p of such that plp(IFp being the prime field of characteristic 
p). The Local L-series of the curve C over K at p is now defi- ned by Lp(C,s) = {(1-epq-s)(1-~ q-S)} 
-1, where the (compLex) numbers ~p and ~p are characterized by the relations I=pl=i pl= ~ and Np=l+q-Ep-=% 
, Np denoting the number of points of the reduced curve C(~) over the finite field K(p). Suppose next 
that C has bad reduc- tion modulo p such that C(p)=C mod p is a cubic defined over K(p) and having a 
 singularity. Then we set Lp(C,s)=(1-q-S) -1 , (1+q-S) -1, or 1 , according as the singularity of the 
redu- ced curve C(p) over K(p) is an ordinary double point with two (distinct) ratio- nal tangents, 
an ordinary double point with two irrational tangents, or a cusp, respectively. Again we caLL L (C,s) 
the Local L-series of the curve CPover K at p. Now the gLobaL L-series of the curve C over K is defined 
as the EuLer product L(C,s) = H L (C,s) p P taken over aLL prime divisors (finite pLa- ces) p of 
K. The gLobaL L-series L(C,s) is known to converge in the complex half- plane Re s>~ .  To state the 
conjecture of Birch and Swinnerton-Dyer, one has to presuppose that L(C,s) can be anaLyticaLLy continu- 
ed over the whole complex plane or at Least up to a neighbourhood of s=1. Fur- V  thermore, the Tate-Safarevic 
group L!Jof C over K must be assumed finite (see [7,1o, 11]). Conjecture of Birch add Swinnerton-Dyer 
 [7.1o.11] The L-series of the eLLiptic curve C over K has the asymptotic expansion near s=1 r ~ 2r2 
L(C,s) --(s-l)  M , where the bars signify cardinaLities and M is the product of some Local factors 
which correspond to a certain finite set of places of K including aLL the infinite places and those finite 
places p at which C has bad reduction modulo p. Taking the r-th derivatives on both  sides, we derive 
from the Birch and Swlnnerton-Dyer conjecture the asymptotic expansion near s=1 r 2  Lir)(c,s)"" ~ 
r! IWIH. 2 . N.  i~Ki 2 Now suppose we know an upper bound A for the r-th derivative of L(C,s) at s=1 
and a Lower bound ~ for the factor M, more precisely, suppose that I 1 L(r)(c,I)I ~]k and M~k>O. r~. 
Then it foLLows from the asymptotic ex- /% pansionof L~rJ(c,s) near s=l that we have H ~ 2-r2x -1A I~KI2 
,/i-~ -'~- Thus we can choose this upper bound for H as the constant H' in Manin's theorem. In the case 
K=~ this choice for H' is exact- %y the same as the one made in [7,16]. However, as pointed out at the 
begin- ning of this section, the feasibility of 291 estimating L(r)(c,1) is an open problem in the general 
case of an eLLiptic curve C over a finite-aLgebraic number field  K~m. 6. "Division by two" and the 
"infinite descent" As soon as the constants in Manin's theorem are known, the points P~CK\C K P =2P 
for some PriCK (v=g+l,...,m). (2) Try to divide all points Pi+Pj by 2 (l~i<j~). Suppose that PI,...,P8 
are such that the Pi+Pj are not divisible by 2(lgi<j~8), whereas we have , !  P =Pj +2P for some P 
~CK(~=8+~,...,~ ;  1~j~). satisfying the inequality for d(P) in that theorem can be determined by the 
method indicated in section I. Suppose we have found these points by trial and error. De- note them by 
P1,...,Pm. According to Ma- nin's theorem, the points PI,...,Pm gene- rate a certain subgroup K of 
finite index p~r'! in a maximal free subgroup CK m CK/C K of rank rgr' in the rational point group C 
K. The group CK is to be determined in terms of a basis. Next we factor out the subgroup 2C K of CK 
consisting of aLL points P~C K such that P=2Q for some Q~C K. This yields (C(~) + 2CK)12C K g CKI2CK 
,  where the factor group on the right has order 2 r. By a finite procedure of repea- ted "divisions 
by two" of the points in C(~) we shaLL obtain a subgroup C(~)g CK such that + :  in the foLLowing manner. 
 We have C(~) = <PI' ...,Pm ~. AppLy the subsequent two steps executing the re- quired divisions by two 
by means of the duplication formula for the point addi- tion in C K. (1) Try to divide a~ points Pi 
by 2 (i=1,...,m). Suppose that PI,...,P are not divisible by 2, whereas Pa+1,...,Pm are divisible by 
2. Then we have Having carried out steps (I) and (2) we proceed as foLLows. For v=1,...,~ ,we $  write 
P =P . For v=G+l,...,~,...,m , we v v , replace Pv by Pv whenever P~Pi for !  i=l,...,v-1, and we 
drop P and P other- V V  wise. After a suitable renumbering of the points P for ~=B+l,...,e,...,m , 
if V A,  need be, we obtain a subgroup C K = , , , !  ~P1,...,P~,...,Pm,>Of index p in K such ^' 
 that C ~ CK ~ CK' P'[P' and m ~m. Then we repeat steps (1) and (2) for the points ! , ^!  PB+I,.~.,P~ 
of the new group C K in place of - C(~), keeping in mind that the points , !  PI,...,P~ have been 
treated already. Go- ing on this way we end up, after a fi- nite number of steps, with a certain sub- 
 that neither the --P~ ) (i=1,...,m (~")) nor the P. +P. (Igi<jgm ) are divisible l j ? ~ by 2, where 
m~Jgm. Then, we conclude that C(~)has odd index p(~) in CK' where g ~  p~)[p. Hence, we see that 
C(~)+ 2CK = CK and, afortiori, 2 K)/2 K : K/2 K  as desired. From the set of aLL points of the form 
P~) + ... + P~)(1~i1<...<i v ~m (~)) in C(~) we can therefore select a complete set of representatives 
inAC K of the 2 r cosets in the factor group CK/2C K. As a by-product of this process, we ob- tain the 
rank r of the curve C over K. Let {Q1,...,Q2r} be such a set of  292 representatives in CK for CK/2CK. 
There is a point Qv(lgvg2r) such that    fl(%) = max i=1,...,2 r We shaLL briefly write Q=Q . The 
"infi- v nite descent" procedure now shows that the group CK is generated by the set {Q1,...,Q2r } and 
the set {R1,...,Rt} of air points RjEC K such that  (Rj) , (see appendix), where the fact that t<~ 
was already noted in section 1. For actu-aLLy finding aLL points RjEC K satisfying this condition it 
suffices to determine the (possibLy a tittle Larger) finite set of aLL points RjEC K such that d(Rj) 
~ I+2 Log 2 + 6 + d(Q)  = 1+7 tog tog B + d(Q) This is clear from the estimate of the difference d(P) 
-h(P) given in section 4. The points RjEC K fuLfiLLing this Lat- ter condition are obtained by employing 
once more the triaL-and-error method. In doing so, one can utilize earlier caLcu- Lations in connection 
with Manin's theo- rem (section 1) and the theorem on the torsion subgroup CK (section 2). FinaLLy, 
we get a basis of the group CK by applying the elementary divisor theorem to the set {QI,...,Q2r,RI,...Rt} 
 ^  of generators of C K. Since the torsion subgroup CK of the rational point group C K is known from 
section 2, one can exhi- bit a basis of the whole group CK=CKeC K itself. 7. ConcLuding remarks The 
above exposition of a generaLiza- tion of Manin's conditional algorithm is to be considered a modest 
first step to- wards the implementation of a procedure for determining the rank and a basis of the group 
C K of rational points on an eL- Liptic curve C over a finlte-atgebralc number field K. The amount of 
caLcuLation involved wilt surety require the use of an electronic high speed computer. The aL- gorithm 
is "conditionaL" insofar as its feasibility depends essentiaLLy on the truth of the conjecture of Birch 
and Swlnnerton-Dyer which has to be taken for granted. The term "conditionaL" is more- over referring 
to the (open) problem of estimating the r-th derivative of the L- series L(C,s) of C over K at s=l. In 
the special case K=~, this problem can be sot- ved by assuming the truth of the WeLt con- jecture as 
was shown by Manin [7]. The WeLt conjecture guarantees in particular also that L(C,s) can be anaLyticaLLy 
con- tinued over the whole complex plane, a property needed for stating the conjec- ture of Birch and 
Swinnerton-Dyer. Next we remind of the condition, app- earing in the theorem of section 3, acc- ording 
to which the i-divislon points of C over K have to belong to K for some prime number t. (But compare 
the remark at the end of section 3.) Beyond the above-mentioned conditions, the feasibility of the generalized 
aLgo- rithm depends also on a rather good know- ledge of the arithmetic of the number field K over which 
the ettiptlc curve C is defined. For example, a complete system of in- tegral divisors of K, representing 
the finitely many divisor classes of K, is used for writing the coordinates of the points PEC K as quotients 
of integers in a suitabie manner as required in the de- finition of d(P) (see section 1). Such a system 
can be obtained, e.g., by the met- hod described in [13]. The same method yields also the class number 
and the structure of the class group ~(K) of the field K and, more generaLLy, the S-cLass number and 
the structure of the S-cLass  293 group ¢s(K) of K for any finite set S of prime divisors of K. Then, 
the rank rkLgs(K) of the L-Sytow subgroup of gs(K) can be computed for any prime number L. Of course, 
the quantity rkL$s(K), appea- ring in the bound for the rank r of C over K in the theorem of section 
3, does not exceed the L-rank rkL~ (K) of the or- dinary class group ¢(K) (see [12]).  The definition 
of d(P) is furthermore based on the n=rl+2r 2 distinct embeddings of the field K into the complex numbers 
¢ (see section 1). Wlth these embeddings of K, we know the rank rk U(K)=rl+r 2 of the unit group U(K) 
of K which also appears in the bound for the rank r of C over K given in the theorem of section 3. For 
determining the torsion subgroup C K of C K by virtue of the theorem of sec- tion 2, an explicit knowledge 
of the de- composition Law [4,12], according to which the primes p of @ split in K, is heLpfuL (compare 
[15]). The decomposition Law is also useful as a tool in the caL- culation of the Local L-series Lp(C,s) 
of C over K. SpecificaLLy, the dlscrimi- nant D of the field K must be computed. We have seen that D 
occurs in the Min- kowski bound of K and thus in the bound measuring the deviation of the modified WeLL 
height d from the Neron-Tate height on C K. In passing, we direct attention to the remarkable fact 
that Manin's conditi- onal algorithm is the first procedure de- vised for determining a basis of the 
ra- tional point group C K of the curve C over the number field K. Appendix We shaLL prove here those 
assertions which were Left without proof in the a- bove exposition, thus verifying also the corresponding 
unproved assertions in [19. To section 1 Let us begin with establishing the re- presentation required 
in section 1 for the coordinates of the rational points P=(~,~) in C K such that ~0, ~0. We foLLow cLoseLy 
[5]. The Weierstrass equation of C applied to such a point P in C K yields divisor representations of 
its coordinates in K of the form ~ -~ and ~ ~,, with some integral divisors ~,9, and 8 of K having the 
g.c.d.'s (~,~) = (~,8) = 1. Choose a fixed system V of representa- tives for the (finiteLy many) divisor 
classes of K such that V is made up of integral divisors c of K whose norms do not exceed the Minkowski 
bound B of K (see [4,12,13]), ~c~B Then, for the given divisor 8 of K, there exists a divisor cEV 
such that ~c is a principal divisor of K, ac ~ z for some nonzero zEK. Hence we obtain the representations 
 2 x' c 3 ~ ~c2 m 7 and ~ ~ m z 3~ f°r s°me nonzero x',y' E K. On muLtipLying x' and y' by suitably 
cho- sen units of K, we end up with two non- zero elements x and y in K which furnish the desired representations 
 x g= z~ and ~= of the coordinates of PEC K as quotients of integers x, z 2 and y, z 5 in K having 
 the g.c.d.'s (x,z 2) = c 2 and (y,z 3) = ¢3.  294 To section 4  (a) We wish to derive the estimate 
cLai- med for the difference of the modified Well height d and the N~ron-Tate height on the group C 
K. In what foLLows we shaLL use the notation pl ~ or p~ for the infinite or the finite places p of K, 
writing in the Latter case also plp in- stead of p~ in order to signify the prime p of ~ over which p 
Lies. Let v , normalized as in [14], designate the ab- solute value on K corresponding to the (finite 
or infinite) place p of K. Observe that this normalization of vp differs from the normalization of the 
valuation wp used in section 2 for the finite pLa- ces p of K. In fact, we have, for each nonzero cEK, 
the relation 1 w v (c)= ~p (c)Log p whenever plP (see [4]), where ep denotes the ramifi- cation index 
of p. As in [14] we now in- troduce the real numbers ~p=min {½ Vp(a), ½ Vp(b)} for each place p of K. 
Notice that the numbers ~p differ, for each place p of K such that PiP, only by a factor ~p_ 1 Log p 
or ~epLOg p from the numbers ~p introduced in section 2. For each place p of K, Let np= [Kp:%] or = 
[K :~] denote the Local degree of p according as PiP or pl ~ respectively (see [4,12,14]). Then we put 
as in [14] P np~p the sum being taken over aLL (finite and infinite) places p of K. The function used 
in [14] for defining A the N~ron-Tate height h on C K was  where n: [K:&#38;#169;] is the field degree 
of K over &#38;#169; as before. (ActuaLLy, we used in [14] the function nd I and caLLed it d). The difference 
function dl-h on C K was shown in [14] to fuLfiLL the estimate -2 Log 2~dl(P)-h(P)~5 Log 2+~ ~ for PEC 
K . Starting off with this estimate we are Left with the task of estimating the dif- ference function 
d-d I on C K. The modified Well height d on C K was introduced in sec- tion I as d(P)= 2~n n 2~-a ~--v~ 
(v)llz (v) 2 , Log H max{ I v=l 37~77~ I z (V)I 2 , lX(~)l } with the coordinates of the point P=(~,~) 
in C K written in the shape x -Y-- (x,y,and z integers ~= -~-z and ~= z3 in K) as described in section 
I and at the be- ginning of this appendix. Hence, we obtain in the notation of [14] (making the con- 
vention that Log O= -~) d(P)= 2n3~v! max{½ Logl a (v) ]+2 Logl z(V) ], 1 !3 togl b(~) l+2 toglz (v 
) I,Loglx (v ) I} : 2n 3~ p~ np max{½ Loglalp+2 Loglzl, , 1 toglbl +2 toglzl toglxl } = -2n~p~ np min{½ 
Vp(a)+2Vp(Z),½ vp(b) + + 2%(z), vp(x)} =--~-2nP'~! np min{~p+2vp(z), Vp(X)}. On the other hand, the 
sum formula for the absolute values v D on K (see [14]) yields for the function d I on C K d1(P)= -~2n 
~np min {~p,Vp(z~) }  d I (P)= P P L--~ ~ if P=O = -2n zn min {ap+2vp(z) vp(x)}. ~ p P  A comparison 
of the Last expressions for the functions d and d I on C K shows at once that for P~C K dl(P)= d(P)- 
~ p~ n min{~p+2Vp (Z) ,V (x)}.  Hence, taking into account that a,b,x, and z are integers in K, we obtain 
the ine- quality d l(P)gd(P) for P~C K. It remains to establish an inequality in the opposite direction 
between dl(P) and d(P) up to an additive constant not de- pending on the point P. We shaLL explicit- 
%y exhibit such a constant. Remembering the fact that ~pmO for each finite place p of K and keeping in 
mind the choice of the coordinate ~= ~ of P such that Z  (x,z 2) = ¢2 with ¢6V, we derive from the 
above equation between dl(P ) and d(P) the inequality d l(P)md(P)- ~ ~ npmin{u +2vp(z),up+vp(x)} :d(P)- 
2~n ~ n, - 2~ ~ npmin{2v (z), =d(P)-~ ~ npup- ~n p~ npvp(¢). Consider the second and the third term 
of the Last expression. As regards the second term, we have in the notation of [14] and section 4 0 
~- 2~n p~ np~p= ~ ~+ ~ p~ spFL p = ~,+ ~ p~ n min{½ vp(a).½ vp(b)}  = 2Ln .- 2~n p~ n max{½ toglalp,~ 
%oglb'p} : ~_2n "- ~ n max{½ togl a(v) ~ 1,½ toglb(~')I} v:l n = 2n p- Log H max v--1 : 3 In particular, 
dropping the factor ~ and applying the sum formula for the absolute values v on K, we obtain  ~= -~npu~= 
-~n~min{q~ vp (a),~ vp (b)} Iii zn v (a) m 2p p ~ if 1 = O. En v (b) if b OJ ~ P P Hence, the above 
second term under consi- deration satisfies the inequality -~ ~ n ~ ~-~ ~. Now Let us took at the third 
term _2 p~npvp(¢)_ of the above expression. n Since ¢~V, the norm of ¢ does not exceed the Minkowski 
bound B, c ~ B. For the time being we shaLL denote, for each finite place p of K, by pp the prime of 
@ such that plpg.Then , the norm ine- quality can be expLicitLy written as (see [4,12]) f wp (c) ~c= 
~pp ~ B, where fp as usual stands for the degree of p over p~ (see section 5). Taking Logarithms on 
both sides, we get Log ~¢= p~ fpwp(¢) Log pp~ Log B. Hence, since np=epfp with the ramification index 
ep of p, we have ! p~ npvp(¢)= p~epn~wp (¢ )tog p~ =   P fpwp(¢) tog pp g Log B. The above third term 
under consideration thus satisfies the inequality -~np~ npvp(c)m-~ Log B.  In sum, we have established 
the esti- mate dl(P)~d(P)-~ ~-~ Log B for PECK . Combining this estimate with the inequa- Lity dl(P)gd(P) 
derived before we obtain the desired estimate 0~d(P)-d1(P)g 2~ ~'+ ~ tog B for PEC K . In combination 
with the above-quoted esti- mate for the difference dl-h on CK, this result Leads to the asserted inequalities 
 -2 tog 2~d(Pl-~(p)~5 ~og 2. ~ ~+ ~= + ~ Log B ~5 Log 2+ ~+ ~ Log B for PEC K , where in the Last step 
we have again em- ployed the relation WgW~ which was shown above to be valid. (b) Now we shaLL prove 
the estimate indi- cated in section 4 for the expression d(P,P)=d(2P)-4d(P) as P ranges over the group 
C K. To begin with we quote from [14] for the analog expression dl(P,P)= dl(2P)-4dl(P) the estimate 
 -(15 Log 2+ ~ ~)~dl(P,P)~6 tog 2 for PEC K . (ActuaLLy, we estimated in [14] the ex- pression ndl(P,P) 
and denoted it by d(P,P)). On the other hand, it foLLows by definition of d(P,P) and dl(P,P) from the 
estimate established in part (a) for the difference function d-d I on CK, that we have 6 12 Log B~d(P,P)~dl(P,P) 
+ d I(P,P)- ~ ~.- .~- 2n ~+ ~ tog B for PEC K . On replacing dl(P,P) by its cited tower and upper 
bound from [14], respectively, and remembering that ~g~, we get ~ 12 -15(tog 2+ ~-)- -~-Log Bgd(P,P) 
g g6(tog 2+ ~)+ ~n tog B for PEC K as asserted in section 4. In particular, this yields for the sum 
 m d(2i-lp, 2i-1p) ~(P)-d(P)- z 22 i i=1 d(2i-lp,2i-lp) 1 [ =i=m+l% 2 2i =2~i 1 d(2 m+i-1 p 2m+i-lp) 
 2~i the asserted estimate (compare [14]) Uoo 4 1 =  -(Log 2. ~1-~-tog ~ ~ i=1 2 m d(2m+i-lp'2m+i-lp) 
g 22~(%og 2+ ~) 2 2i 1 + n2~ tog B for PEC K . To section 6 Let us show how to get a set of generators 
for the group C K by appLy- ing the method of "infinite descent" (see [8]) to a given set {QI~.~.,Qr 
2r} of re- presentatives in ~K of h 2 cosets in the factor group CK/2C K. We have CK/2CK: {Q1,...,Q 
r}/2CK 2 The "infinite descent" works as foLLows. Let RECK be an arbitrary rational point: Put Ro=R. 
There is a rational point RIEC K such that Ro=~o+2R 1 for some index v o in I~vo~2 r. Furthermore, there 
is a rational point R2EC K such that ~=QVl+2R2 for some index v I in 1~v1~2 r. Going on this way we 
obtain an infinite sequence Ro,RI~ .... Rj_I,Rj,... of ratio- nat points in C K sucht that  Rj_I=~j_I+2R 
j for some index ~j-1 in I~vj_I~2 r, where 3~I.  FortunateLy, only a finite portion of this infinite 
sequence is needed for finding a basis of C K as we shaLL see. By induction on 3, it foLLows from the 
Last relation that the given rational point RECK admits a representation of the form +...+2Q (j~l) 
(*) R=23Rj+2J-IQ~3_I Vl+QVo  We wish to estimate the value of the N~ron-Tate height h at the point Rj.^To 
this end we utilize the property of h to be a positive definite quadratic form on the group^C K (see 
[8,14]). AppLying the function h to the relation 2R.=R. ~-Q J 0-I ~j-1 we obtain for j~l 4h(R3 )=2h 
(R3-I)+2h(Q~ j_ I o-I+Q3_ I ) 2h(Rj_ 1 )+2h(Q v ). j-1 In this inequality we may replace Q v3-1 by the 
point Q chosen in section 6 in or- der to gain 4h (Rj)~2h (Rj_ I )+2h(Q) (j~l). Now we use induction 
on j to infer from this the new inequality I {h(R)-h(Q) } (j~1) T When we choose the index j sufficiently 
Large, we arrive at a rational point R iEC K such that h(R3)~fl+h(Q):1+ max 2r {fi(Qi)}. i=1,..., 
Thus the given point RECK can be represen- ted as a Linear combination (*) of the points QI,...,Q2r 
and a point R 3 satis- ^ fying the above inequality for its h-va- Lue. By virtue of the estimate for 
the difference function d-h on CK' this Last inequality turns into the corresponding inequality with 
the N~ron-Tate height replaced by the modified Weir height d. References I. V.A. Dem'janenko, Torsion 
of eLLiptic curves. Izv. Akad. Nauk SSSR, Set. Mat. ~ (1971), 28o-3o7 = Math. USSR Izvestija ~ (1971~ 
289-318. 2. G. Frey, Some remarks concerning points of finite order on eLLiptic curves over gLobaL fields. 
To appear.  3. H. Hasse, Simuttane Approximation at- gebralscher Zahten durch atgebraische Zahien. Monatsh. 
Math. Phys. _~ (1939~ 2o5-225.  . H. Hasse, Zahtentheorie. Akademie- Vertag, BerLin 1969. 5. J. Heuss, 
Zum schwachen Endtichkeits- satz von MordetL. DipLoma Thesis, Kartsruhe 1~75.  6. T. Honda, Isogenies, 
rational points and section points of group varieties. Japanese J.Math. ~.~ (196o), 84-Ioi.  7. Ju.I. 
Manin, Cyctotomic fields and modular curves. Uspehi Mat. Nauk 2_~ (1971) no. 6 (162), 7-71 = Russian 
Math. Surveys 2_~ (1971) no. 6, 7-78.  8. D. Mumford, AbeLian Varieties. Oxford University Press, London 
1974.  9. J.-P. Serre, p-Torsion des courbes ettiptiques (d'apr~s Ju.I. Martin). In:  # Sem. Bourbaki, 
22e annee, 1969/7o, no. 38o, 281-294. lo. H.P.F.Swinnerton-Dyer, The conjectures of Birch and Swinnerton-Dyer, 
and of Tate. In: Proc. Conf. on Local FieLds, 132-157, Springer-Vertag, BerLin- G8ttingen-Heidetberg 
1967. 11. H.P.F.Swinnerton-Dyer and B.J.Birch, ELLiptic curves and modular functions.  298 In: ModuLar 
Functions of One VariabLe IV, Lecture Notes in Math., voL. 476, pp. 2-32j Springer-VerLag, BerLin- HeideLberg-New 
York 1975. 12. E. Weiss, ALgebraic Number Theory, McGraw-HiLL Book Company, New York 1963.  13. H.G. 
Zimmer, Some computational as- pects of, and the use of computers in, algebraic number theory. Compu- 
  ting 8 (1971), 363-381. 14. H.G. Zimmer, On the difference Well height and the N~ron-Tate Math. Z. 
147 11976), 35-51. of the height. 15. H.G. Zimmer, Points of finite order on eLLiptic curves over number 
fields. To appear in Arch. d. Math.  16. H.G. Zimmer, On Manin's conditional algorithm. To appear in 
Proc.Conf. on "UtiLisation des caLcuLateurs en  mathematiques pures", Limoges 1975.   
			