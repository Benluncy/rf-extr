
 Optimal Outlier Removal in High-Dimensional Spaces John Dunagan* Santosh Vempala* ABSTRACT Westudytheproblemoffndinganoutlier-freesubsetofa 
setofpoints(oraprobabilitydistribution)inn-dimensional Eulideanspae.Apointxisdefnedtobea,-outlierif thereexistssomediretionwinwhihitssquareddistane 
fromthemeanalongwisgreaterthan,timestheaverage squareddistanefromthemeanalongw[1].Ourmainthe­oremisthatforanyE0,thereexistsa(1-E)frationof 
theoriginaldistributionthathasnoO(n(b+logn))-outliers, improvingonthepreviousboundofO(n7b/E).Thisbound 
isshowntobenearlythebestpossible.Thetheoremis l onstrutive,andresultsinalT approximationtothefol­lowingoptimizationproblem:givenadistributionf(i.e.the 
abilitytosamplefromit),andaparameterE0,fndthe minimum,forwhihthereexistsasubsetofprobabilityat least(1-E)withno,-outliers. 
 Keywords Outlier,ellipsoid,sampling,Eulideanspae 1. INTRODUCTION Theterm"outlier"isafamiliaroneinmanyontexts. 
Statistiianshaveseveralnotionsofoutliers.Typiallythey quantifyhowfartheoutlierisfromtherestofthedata, 
e.g.thediferenebetweentheoutlierandthemeanor thediferenebetweentheoutlierandthelosestpointin therestofthedata.Inaddition,thisdiferenemightbe 
normalizedbysomemeasureofthe"satter"oftheset,e.g. therangeorthestandarddeviation.Datapointsthatare outsidesomethresholdarelabelledoutliers. 
Identifyingoutliersisafundamentalandubiquitousprob­lem.Theoutliersinadatasetmightrepresentexperimental 
error,inwhihaseitwouldbedesirabletoremovethem. Theyouldafettheperformaneofaomputerprogram, *DepartmentofMathematis,MIT,CambridgeMA,02139. 
Email:{jdunagan,verpala} rath.rit.eduSupportedin partbyNSFCareerawardCCR-9875024. Permission to make 
digital or hard copies of all or part of this work for personal or classroom use is granted without fee 
provided that copies are not made or distributed for pro.t or commercial advantage and that copies bear 
this notice and the full citation on the .rst page. To copy otherwise, to republish, to post on servers 
or to redistribute to lists, requires prior speci.c permission and/or a fee. STOC 01, July 6-8, 2001, 
Hersonissos, Crete, Greece. Copyright 2001 ACM 1-58113-349-9/01/0007 ...$5.00.  byslowingdownorevenmisleadinganalgorithm;mahine 
learningisanareawhereoutliersinthetrainingdataould auseanalgorithmtofndawaywardhypothesis.Evenfrom apurelytheoretialstandpoint,removingoutliersouldlead 
tosimplermathematialmodels,ortheoutliersthemselves mightonstitutethephenomenonofinterest. Howdoesonefndoutliers?Toaddressthisquestionwe 
havetofrstansweranother:whatpreiselyisanoutlier? Inthispaperwewillassumethatthedataonsistsofpoints (oradistribution)inn-dimensionalEulideanspae.Inthe 
one-dimensionalase,oneoulduseoneofthedefnitions alludedtoabove,viz.apointisanoutlierifitsdistanefrom 
themeanisgreaterthansomefatortimesthestandard deviation.Thefollowinggeneralizationtohigherdimensions 
wasproposedin[1].LetPbeasetofpointsinnn.Apoint xinPisalleda,-outlierifthereexistsavetorwsuh thatthesquaredlengthofxalongwismorethan,times 
theaveragesquaredlengthofPalongw,i.e.if T2T2 (wx),. [(wx)] Notethat(wTx)2isthesquareddistanealongwfromthe 
origin.Thefrstproblemweaddressisthefollowing:does thereexistasmallsubsetofPwhoseremovalensuresthat theremainingsethasnooutliers?Morepreisely,whatis 
thesmallest,suhthatonremovingasubsetonsistingof atmostanEfrationofthepoints,theremainingsethasno ,-outliers? 
Anaturalapproahmightbetofndall,-outliersinthe setandremovethem.Thisanbedonebyfrstapplyinga lineartransformation(desribedinsetion2)thatresultsin 
theaveragesquaredlengthofthedistributionbeing1along everyunitvetor(theso-alledisotropiposition).Isotropi 
positionwasusedin[4]toshowthatanyonvexsetKin isotropipositionontainsaunitballandisontainedin aballofradiusn.Bringingadistributionintoisotropi 
positionallowsustoidentifyoutlierseasily.Apointthat isa,-outliernowsimplyhassquaredlengthmorethan,. ThemaindiÆultyisthattheremainingsetmightstillhave 
outliers itispossiblethatpointsthatwerepreviouslynot outliersnowbeomeoutliers.Canthishappenrepeatedly, 
perhapsforingustothrowoutmostoftheset? Ourmainresultisthattheanswertothisquestionis"no" forasurprisinglysmallvalueof,.Wepresentitbelowina 
nTb: moregeneralframework.Letnn={0}{xn:2 b IxI:2b},i.e.thesubsetofn-dimensionalspaeoutsideofa verysmallballandinsideaverylargeball,plustheorigin. 
InplaeofthepointsetPinthedisussionabovewehave anyprobabilitydistributionfonnn.Notethatnbontains b thesetofallb-bitrationals,anobjetoffrequentinterestin 
theoretialomputersiene. THEOREM1(MAINTHEOREM).Letfbeaprobability n distributiononnbandSbearegioninspae.Denoteby 
f(S)theprobabilitythatxhosenaordingtofisinS. ThenforeveryE0thereexistsSand nn ,=O(b+log) EE suhthat 
(i)f(S)?1-E TT (ii)max{(wx)2:xS}:,.[(wx)2:xS]forall n wn Theproofofthetheorem(setion3)isonstrutive.In 
setion2wedesribe(twovariantsof)analgorithmforout­lierremoval.Thetheoremanbeprovenusingeithervari­ant.Althoughthetheoremisnotobvious,thealgorithmis 
extremelysimple.Toonvinethereaderofthis,weinlude amatlabimplementationofthealgorithminsetion9. Forapointsetwithmpoints(mn)thealgorithmruns 
inO(m2 n)time.Insetion4weshowthatthealgorithman alsobeusedonanunknowndistributionifitisallowedto drawrandomsamplesfromthedistribution.Thenumberof 
OnOO(b2n5 samplesrequiredisO(2b)andtherunningtimeis2). Ouralgorithmissimilartothealgorithmof[1],theimme­diateinspirationforourwork.Theboundon,inthethe­ 
;b n oremimprovesonthepreviousbestboundofO()given in[1].Thereitwasusedasaruialomponentinthefrst polytimealgorithmforlearninglinearthresholdfuntionsin 
thepreseneofrandomnoise.Duetothehighvalueof,, theboundontherunningtimeofthelearningalgorithm, 28 althoughpolynomial,isasomewhatprohibitiveO 
(n).In 5 ontrast,ourtheoremimpliesanimprovedboundofO (n) forlearninglinearthresholdsfromarbitrarydistributionsin 
thepreseneofrandomnoise.Further,ourboundon,is asymptotiallythebestpossible.Thisisshowninsetion 5byanexamplewhereforanyE2l 
,aboundon,better n thann((b-logl))isnotpossible. Ourmaintheoremgivesanextremalboundon,.Anat­uralfollow-upquestioniswhetheroneanahievethebest 
possible,foranypartiulardistribution.Givenadistribu­tionfandaparameterE,wewanttofndasubsetofproba-bilityatmostEwhoseremovalleavesanoutlier-freesetwith 
thesmallestpossible,.Thisquestionanbeshowntobe NP-hardevenintheone-dimensionalasebyaredution tosubset-sum.Insetion6weprovethatouralgorithm 
l ahievesa(lT)-approximationtothebestpossible,for anygivenE. Insomeasesitmaybedesirabletotranslatethedata 
setsothattheoriginoinideswiththemean,ratherthan havingafxedorigin.Weprovethefollowingorollaryfor standarddeviationsfromthemeaninsetion7.Letfbe 
aprobabilitydistributiononIn ,whereIb ={.:IpI,IqI b In {0,1,2,...,2b -1},q= 0}.isthesetofalln-dimensional 
vetorsofb-bitrationals.(Notethatnowfwillsatifythe "outsideasmallball,insidealargeball"riterionforever 
possibleplaementoftheorigin,exeptforatmostone point.)Theorollaryisthat,foranyE0,thereexists a(1-E)frationofthedistributionsuhthatalongev­erydiretion,nopointisfurtherawayfromthemeanthan 
b V nn O((b+log))standarddeviationsinthatdiretion.  2. ALGORITHMS FOR OUTLIER REMOVAL Westateouralgorithmsforprobabilitydistributionsover 
n arestritionofnforeaseofexposition.Weremovethis b restritioninasinglestepattheendofsetion3.Let n 
Jb ={0}[2Tb,2b]andJn ={xnIxiJb,i= b 1,2,...,n},i.e.thesubsetofn-dimensionalspaewitho­ordinatesinJb.Notethattheoordinateaxesplayaspeial 
rolein.Weassumefortheremainderofthissetionthat Jn bJn theprobabilitydistributionweareinterestedinisover. 
Inordertodetetoutliers,weusealineartransformation. b T LetM=.[xx]wherexisdrawnaordingtotheprob­abilitydistributionf.SineMispositivedefnite,there 
existsamatrixAsuhthatM=.Considerthetrans- A2 ATl formedspaez=x.Thistransformationpreservesout­liers:ifzisa,-outlierindiretionwinthetransformed 
spae,theorrespondingx=Azisa,-outlierindiretion iATl w=wintheuntransformedspae,andvieversa.The transformeddistributionisinisotropi[4]position,andwe 
refertotheresultingdistributionasaentereddistribution. Suhtransformationshavepreviouslybeenusedtomakege­ometrirandomwalksmoreeÆient[3].IfMdoesnothave 
fullrank,itisstillpositivesemi-defnite,andweinstead enterfinthespanofM. Foraentereddistribution,anypointxthatisanoutlier 
forsomediretionwisalsoanoutlierinthediretionx. Thisfollowsfromthefatsthataentereddistributionhas T .[(wx)2]=1foreverywsuhthatIwI=1,andthatthe 
projetionofthepointxontoadiretionwisgreatestwhen w=x/IxI.Thusoutlieridentifationiseasyforentered distributions. 
Thefrstalgorithmhasthefollowingsimpleform:while thereare,-outliers,throwthemout;ifatanypointweare verylosetoalowerdimensionalsubspae,droptothelower 
dimensionalsubspae.Stopwhentherearenooutliers.In thedesriptionbelow,isanabsoluteonstant. Algorithm1(RestritiontoEllipsoids): 
nn Let,=,2 =((b+log))andfbethedistribution. 1.Centerf.IfthereexistsxsuhthatIxI,,letS= {x:IxI:,}.RetainonlypointsinS. 
2.Transformbaktotheoriginalspae.Ifthereissome 2Tb oordinateaxisisuhthatPr[xi?]:3n,throw outallpointsxwithxi?2Tb 
. 3.Repeatuntilneitheroftheaboveonditionsismet. Thefollowingvariantoftheabovealgorithmwillbesig­nifantlyeasiertoanalyze.Whereasinthepreviousalgo­rithm,weremovedoutliersineverydiretioninonestep,in 
Algorithm2,weonlyremoveoutliersinonediretionper step.Asbefore,isaonstant. Algorithm2(RestritiontoSlabs): 
nn ,2 Let,==((b+log))andfbethedistribution. 1.Centerf.Ifthereexistsaunitvetorwsuhthat T2 T max{(wx)2},,letS={x:(wx)2:,2}.Re­tainonlypointsinS. 
2.Transformbaktotheoriginalspae.Ifthereissome 2Tb oordinateaxisisuhthatPr[xi?]:3n,throw outallpointsxwithxi?2Tb 
. 3.Repeatuntilneitheroftheaboveonditionsismet.  3. PROOF OF THE MAIN THEOREM Wheneitheralgorithmterminates,welearlyhavea,­outlierfreesubset.Itremainstoshowthatwedonotthrow 
outtoomuhofthedistribution.Themainideaoftheproof istoshowthatineverystepthevolumeofanassoiateddual ellipsoidinreases.Byboundingthetotalgrowthofthedual 
ellipsoidvolumeovertheourseofthealgorithm,wewill deduethatnomorethanaertainfrationoftheoriginal probabilitymassisthrownoutbeforethealgorithmtermi­nates.Speialarewillbetakentodealwiththepossibility 
thatatsomestepthedistributionfbeomesonentrated onasubspaeoflowerdimension. Towardsthisend,wewillneedsomedefnitions.Defne 
E(M)tobetheellipsoid{x:xI:1}andW(M)tobe IATl {x:IAxI:1}whereM=A2 .WewillrefertoE(M)and W(M)astheprimalinertialellipsoidandthedualellipsoid 
n respetively.IfSisasubsetofn,wedenotebyMsthe matrixgivenby TT Ms=.[xx:xS]Pr[xS]=f(x)xx s MsisthematrixobtainedbyrestritingftoS(zeroingout 
pointsoutsideofS).Wedenotethisrestritedprobability distributiondiretlybyfls.Theusefulpropertyattainedby 
enteringwithrespettofls(therestritionoftheoriginal distributionontotheregionS)isthat T .[(wx)2:xS]Pr[xS]=1foreveryunitvetorw, 
wheretheexpetationandprobabilityarewithrespettox drawnfromf. Wewillalsoneedthefollowingelementaryfatsaboutlin­earalgebraandellipsoids:thevolumeofanellipsoidisgiven 
bytheprodutoftheaxislengthstimesthevolumeofthe unitball,whihwewilldenotebyf(n),and{x:xI:1} IATl isanellipsoidwithaxesgivenbytheeigenvetorsofA.It 
followsthat (W(M)) (E(M))=(f(n))2 ,afuntion solelyofthedimension(althoughif (E(M))=0,then (W(M))=(). 
T Wewillatuallyprovetheorem1with.[(wx)2:x T S]Pr[xS]inplaeof.[(wx)2].Notethatthisisa strongerstatementthantheoriginaltheorem. 
Lemma1relatesthedualvolumegrowthtothelossof probabilitymass,andlemma2upperboundsthetotaldual volumegrowth. 
LEMMA1(RESTRITIONTOASLAB).Let,befxedand letfbeafull-dimensionalentereddistribution.Suppose :w,IwI=1suhthat 
T22T2 max{(wx)},.[(wx)] T2 LetS={x:(wx)2:,}andp=Pr[x/S].Then .'2/2 (W(Ms))?e (W(M)) T PROOF.Leta2 =.[(wx)2:xS]Pr[xS].Starting 
fromtheidentity T2T2T2 .[(wx)]=.s[(wx)]Pr[xS]+. /s[(wx)]Pr[x/S] T2 andusingthat(wx)2?,forallxnotinS,weget 
?a22 1+,p,whihimplies 22T'2 a:1-,p:e Wenowonstrutavetorw ioflength1/abelongingtothe dualellipsoid.Lettingw 
i =w/asuÆessinewisaunit vetorbyassumptionand 2 T2 T a=.[(wx):xS]Pr[xS]=wMswB iTii 1=wMswBwW(Ms) WealsoshowthateveryvW(M)alsobelongstoW(Ms). 
Wehave=M- T .Hene, Ms /sf(x)xx vT vW(M)BMv:1 TTTT vMsv=vMv-f(x)vxxv= /s TT2T vMv-f(x)(vx):vMv:1 /s 
 implyingthatvW(Ms).Thelengthofapointon theboundaryofanellipsoidlowerboundsthelengthof thelongestaxis.Sineatleastoneaxisofthedualhas 
length1/a,andalltheotheraxeshavelengthatleast1, (W(Ms))?(1/a)f(n)while (W(M))=f(n),im­ e'2./2 plyingthedualvolumegrowsbyatleastafatorof. 
Ifthedualellipsoidhasinfnitevolumeafterthisiteration, thenthestatementisstilltruebeausethedualellipsoid 
hadfnitevolumeatthebeginningoftheiteration.This onludestheproofoflemma1. LEMMA2(DUALVOLUMEGROWTH).Letfbeanini­tialfull-dimensionaldistributionandletfls.bethefnal 
distributionresultingfromappliationofeitheralgorithm. Assumefls.isfull-dimensional.LetL=(b+logn).Then 
TnL (W(M))?2 nL (W(Ms.)):2 PROOF.Firstwelowerboundtheinitialdualvolume, e (W(M)).Consideranyvetorvoflengthatmost2Tb/n. 
Sinethelongestpossiblexbelongingtofisoflengthat e most2bn,wehavethatvTMv=.[(vT x)2]:1andso vbelongstothedualellipsoid.Thusthedualellipsoidini- 
n(TbTIogn)2TnL tiallyhasvolumeatleast(2Tb/n)n =2?(usingtheinsribedubetolowerboundthevolumeofthe ball). 
Nextweupperbound (W(Ms.)).Consideranyve­ e torvoflengthIvI.ThenvhaslengthatleastIvI/non someoordinateaxisi.Bythepropertythatfls.isfull­dimensional,thetestonditioninstep2ofeitheralgorithm 
wasneversatisfed,andthusatleastanE/3nfrationof 2Tb thepointsxhavevalueatleastonthisoordinateaxis. Thisyieldsthat 
TT22T2bTb vMv=.[(vx)]?(IvI/n)(2)Pr[xi?2] ?(IvI2/n)(2T2b)(E/3n) vT2b+Iogn+l/2Iogl/ Forvtobeinthedualellipsoid,wemusthaveMv: 
1BIvI:.Thustheultimatevolumeof 2nL thedualellipsoidisnomorethan2n(b+Iogn+l/2Iogl/):(usingtheontainingubetoupperboundthevolumeofthe 
ball). Usinglemmas1and2,wenowprovethatAlgorithm2 terminateswithSsatisfyingtheorem1. PROOF.Supposethatthealgorithmterminateswithsub­setS 
* afterhavingthrownoutnomorethanEioftheoriginal probabilitymass.Thenwehavethatforeveryw, T2 *2T2 ** max{(wx):xS}:,.[(wx):xS]Pr[xS] 
Weremindthereaderagainthatnormalizingsothat . fls itisaprobabilitydistributiononpointsfromf,ratherthan 
withpointsoutsideofreplaedbyzeros,inreasesthe S * right-handsideofthisinequalitybythefator1/f(S * ),but 
doesnotinreasetheleft-handside.Thustheinequality willstillbetrueevenifwenormalizefls.Wethusahieve . nn 
,=, 2 =(b+log) EEItnowremainstoshowtherelationbetweenandEthat EiEi :E,i.e.thatwedonotthrowoutmoreoftheprobability 
massthanlaimed.Firstsupposeflsisfulldimensional. . LetL=(b+logn). ith Supposethatduringtheiterationofthealgorithm 
throughstep1,apifrationoftheoriginalpointsarethrown out.Thenthetotalamountthrownoutispi.Bylemma ; '2/2 
1,thetotalamountofdualvolumeinreaseisie= 2. ; 2 e.Comparingthistoourboundonthetotalinrease inthedualvolumefromlemma2yields 
2. e;:22nL 2 Forourhoieof, 2with=36,wehavethatpi:E/3. Wenowextendtheprooftotheasethatthefnaldistri­butionisnotfull-dimensional.Thisdropindimensionisthe 
mainissueoftheproofonewehavelemmas1and2.Sup­posethatatsomestepofthealgorithm,wemovefromMof dimensionktoofdimensionki 
.Wethenwanttorestrit Miourselvesfortherestofthealgorithmtotheki-dimensional subspaespannedbyMi .Thatis,bothW(Mi)andE(Mi) 
areki-dimensionalobjets.Wedenotethefatthatweare nowonsideringthevolumeofalower-dimensionalobjet byaddingasubsripttoour(-)funtion.Weshowtwo 
things (a)Ourupperboundonthetotalvolumeofthedual (kTk.)L ellipsoiddereasesby2 k(W(M))2(kTk.)L (b): k.(W(M.)) 
Thustheamountbywhihweareawayfromourupper boundonthetotalgrowthofthedualvolumeannothave inreased.(a)isimmediatefromthewaywealulatedthe 
upperboundonthefnaldualvolume.(b)willbeproved shortly.Wenowonludetheargumentassuming(b).Ev­erytimefdropsindimension(i.e.,therankofMdereases), 
wemaynothavemadeanyprogressininreasingthedual volume,andthusweannotapplylemma1totheprobabil­itymassthrownoutinthisstep.However,taking, 
2?3n/E yieldsthatwewon'tthrowoutmorethananE/(3n)fration ofthetotalprobabilitymassonanyonestep.Thisfollows 
from T T22.[(wx)2]1 Pr[x/S]=Pr[(wx)?,]:2 = 2 ,, Sineourhoiefor, 2alreadysatisfedtheaboverite­rion,weonludethateverytimewedropindimension,we 
throwoutnomorethananE/(3n)frationoftheprobability mass.Sinewemightalsodropindimensionbyexpliitly throwingoutuptoanE/(3n)frationoftheprobability 
mass(theriterionforstep2ofAlgorithm2),weanup­perboundthetotalamountofprobabilitymassthrownout withoutanyinreaseinthedualby 
32 n x(totalnumberofdimensionsdropped):23.Combin­ingthiswithpi:E/3,weseethatwethrowoutnomore thanEprobabilitymassoverthelifeofthealgorithm.Thus 
 Ei :E,andourfnalboundon,is 36nn ,:(b+log) EE Wenowproveproperty(b).Itfollowsfromthefollowing simplelemmaaboutellipsoids. 
LEMMA3(ELLIPSOIISLIES).Considerann-dimensional ellipsoidEwithaxislengthsal?...an.Nowtakeanyk­dimensionalslieCthroughtheenterofE.Then 
n k(C)?f(k)i nTk+lai (b)isaorollaryoflemma3beausenoaxisofthedual ellipsoidhaslengthmorethan,andtheotheraxesof 
2L W(M)anonlygrowwhenwethrowoutprobabilitymass fromf.Itonlyhelpsthatf(n)ismonotoniallydereasing inn. 
Proofoflemma3.ThemaintoolistheCourant-Fisher Theorem[5]. THEOREM2(COURANT-FISHER).LetAbearealsym­ ith 
 metrinxnmatrixAitheeigenvalueAl?...An. Then T xAx =minmax AiT xx wheretheminimumisoverall(n-i+1)-dimensionalsub­spaesU. 
SinethekdimensionalslieisasubspaeUwithi= n-k+1,andtheaxislengthsofW(M)aregivenbythe eigenvaluesofA,wefndthatthelongestaxisoftheslied 
ellipsoidhaslengthatleastanTk+l.Applyingthesame argumenttothek-1dimensionalsubspaeofCperpendi­ulartothelongestaxisofthesliedellipsoid,wefndthat 
thenextlongestaxishaslengthatleastanTk+2.Applying theargumenttotheremainderoftheaxesonludesthe proofoflemma3.Thisalsoonludestheproofofthemain 
theorem. Wenowgiveanalternateproofofthemaintheoremusing theonstrutiongivenbyAlgorithm1.Webeginbyproving 
ananaloguetolemma1. LEMMA4(RESTRITIONTOANELLIPSOII).Let,be fxed andletfbeafull-dimensionalentereddistribution. 
T2 LetS={x:(xx):,}andp=Pr[x/S].Then .'2/2 (W(Ms))?e(W(M)) PROOF.Firstweestablishthetradeofforaradiallysym­metridistribution,andthenweshowthataradiallysym­metridistributionistheworstaseforthetradeofwewant. 
Letbearadiallysymmetridistribution,anddefne fiMi ,S,andpasabove.Wethenalulatetheinreasein (W(Mi)).Leta 
2 =.I.[(w T x)2:xS]Pr[xS]for anyw,IwI=1.Fromtheenterofann-dimensionalsphere ofradius,,theprojetionofthesphereontoanydire­ 
e tionissharplyonentratedaround,/n,andthesquared expetationisexatly, 2/n.Usingtheidentity T2T2T2 .[(wx)]=./s[(wx)]Pr[x/S]+.s[(wx)]Pr[xS] 
asintheproofoflemma1,butnowforanyw,wededue 1?a 2+, 2p/n,andthus ()n/2 2 n./2 ,pT'2 a:1-:e n Asintheproofoflemma1,weobservethatW(Mi)inludes 
s avetoroflength1/ainthediretionofw.Sinethisis nowtrueforeveryw,thedualellipsoidvolumeinreasesby atleastafatorof(1/a)n 
.Thisshowsthatintheaseofa radiallysymmetridistribution, .'2/2 (W(Ms))?e(W(M)) Nowweshowthataradiallysymmetridistributionis 
theworstaseforthetradeofwewant.Supposetherewere someentered,full-dimensionaldistributionfforwhihthe statementofthelemmawasnottrue.Weonstrutanew 
entered,full-dimensionalandradiallysymmetridistribu­tionforwhihthestatementisalsofalse. fiWebeginbynotingthateverypointthrownoutfromf 
isalsothrownoutfromanyrotationoff thisjustfollows fromthefatthatfisentered.Letbetheexpetation fioffunderarandomrotation.Thatis,isaradially 
fi symmetridistributionsuhthattheprobabilityofhoosing xfromatdistanelessthanrfromtheoriginisexatly fithesameastheprobabilityofhoosingxfromfatdistane 
lessthanrfromtheorigin,foreveryr.Letorrespond Mi fi ConsideranaxisdiretionwiofE(Ms),IwiI=1.We havea 2 
i =.[(wiT x)2:xS]Pr[xS].ForE(Msi),denote theaxislengthforanyaxis(alsojusttheradiusofE(Mi)) to. s fi byaa.Wefndfromtheonstrutionofthat 
nn 2 T22 11 a =.[(wix):xS]Pr[xS]=ai nn il il Onewaytovisualizethisequalityistotakefandsimply onsiderfOahievedbyrotatingtheaxesoffontotheother 
axesoff;sinethisisadisretesetofrotations,itislear thatthesquaredaxislengthsoffOarejustthearithmeti averagesofthesquaredaxislengthsoff.Thenweanmake 
fOintobytakingaontinuoussetofrotations,without fiafetingtheaxislengthsfromfO. WenowonsiderthevolumeofE(Msi).Wehave 
 n n n f 1 (E(Msi))=f(n)aa=f(n) ai2r? n il il n f f(n)ai=(E(Ms) il wheretheinequalityisthearithmetimean-geometrimean 
inequality.Thisimpliesthat(W(Ms))?(W(Msi)). Thisonludestheproofoflemma4. Finally,weprovethatAlgorithm1terminateswithSsat­isfyingtheorem1. 
PROOF.Lemma2stillholds.Therateofinreaseinthe dualvolumeaswethrowoutprobabilitymasswhenthedi­mensionremainsonstantislearlystillgoodaswell.How­ever,ourboundontheamountofprobabilitymasspthat 
anbethrownoutinasinglestepisnolongerE/(3n).In­stead,wehavefromtheproofoflemma4onlythat 0:1-p, 2/nwhihonlyleadstop=O(E)forourhosen 
valueof, 2 .Thus,theanalysisforAlgorithm2doesnot immediatelyapply. ToanalyzeAlgorithm2,wearguedthatanydropinthe 
dualontheuptonpossiblestepsinwhihthedimension droppedouldnotleadtomorethananEoveralldropin theprobabilitymass.Thuswewereabletojustarguethat 
themaximumamountbywhihthedualvolumestillmight growouldn'tinreaseinthisstep.Tosuessfullyanalyze Algorithm1,wemustprovethestrongerstatementthatif 
wethrowoutalotofprobabilitymass,andthedimension dropsbyonlyasmallamount,thenwestillmakesignifant progressontheoverallgrowthofthedualvolume.Tobe 
preise,lettingM,Mi ,p,k,ki ,Lbeasbefore(intheanalysis ofAlgorithm2),weprove k.(W(M.))?2T(kTk.)(L+l).'2/4 
()e k(W(M)) (Compareto(b)intheanalysisofAlgorithm1.)The ideaforourproofof()isthatanypointeitherhasalarge 
omponentinthesubspaethatvanishes,oralargeom­ponentinthesubspaethatremainsifthedimension dropsbyonlyasmallamount,thereannothavebeentoo 
manypointswithalargeomponentinthesubspaethat vanishes,andthedualvolumegrowthresultsfromthedis­ardedpointswithalargeomponentinthesubspaethat 
remains.LetWWemainbetheki-dimensionalspaespanned by,andWt ssedbethe(k-)-dimensionalsubspaeof Mi kispan(M)orthogonaltoW 
emain.Letplbetheprobability ' thattheprojetionofxontoWWemainisatleast:,and 2similarlyletp2betheprobabilitythattheprojetionofx 
' ontoWt ssedisatleast:.Oneofthesetwoeventshappens 2 foreverypointx.Thusp:pl+p2. TakinganyunitvetorwWt 
ssedandusingourfavorite TT equation.[(wx)2]=./s[(wx)2]Pr[x/S]+ T .s[(wx)2]Pr[xS],wehavethat , 212(k-ki) 
1?0+()pl=pl: 2k-ki, 2 kiprojetionofa(k-ki)-dimensionalunitvetorontoaran­domdiretion. TakinginsteadaunitvetorwWWemainandletting 
a 2 =.[(w T x)2:xS]Pr[xS],asimilaranalysisgives wherethefator1/(k-)omesfromtheexpetedsquared (2)k./2 
k. p2, a :1­ 2ki k. Sine1/(aa)isalowerboundontheinreaseinthevol­umeofthedualellipsoidinthesubspaeWWemain,andthe 
dualvolumedropinmovingtothatsubspaewasatmost 2T(kTk.)L ,wehaveaninreaseinthedualvolumeofatleast 2T(kTk.)L2 
'2/42(kTk.) e.Usingp2?p-pl?p-yieldsthat ' 2 2T(kTk.)L.'2/4(kTk.)/2 thisisee,whihthenimplies(). Thetradeofexpressedin()isslightlyweakerthan(b) 
fromtheanalysisofAlgorithm2,butitisindependentof whetherwedropindimensiononagiveniterationornot. ith 
Supposewethrowoutprobabilitymasspithetime throughstep1ofAlgorithm1.From(),wehavethat droppingindimensiononlytakesawayfromourprogress 
towardstheupperboundondualvolumegrowthbyatmost afatoroftwoperdimensionthatwedrop,andthuswefnd 2. ;2n(L+l) 
2 e:2 Ourhoieof, 2with=36,impliespi:2E/3.We throwoutlessthanE/3oftheprobabilitymassinstep2 overthelifeofthealgorithm.Thustheentirealgorithm 
throwsoutnomorethananEfrationoftheprobability mass.ThisonludestheanalysisofAlgorithm1. Jn Wenowremovethetehnialityofrestritingtoin­ 
b n steadofn. b LEMMA5(CHOIEOFAXES).Letfbeaprobabilitydis­ n tributionovern.Thereexistsarotationoffwhihwe 
bn denotebyfi asubsetofspaeTandB=O(b+log)suh that (i)fi(T)?1-2 (ii)fli : isaprobabilitydistributionoverJBn 
PROOF.Weonstrutfibyrandomlyrotatingf.Tis hosentobethelargestsubsetofspaewemayretainand stillnothaveanypointswithtoosmallaoordinatevalue 
inanyaxis(soTequalsJBn,thesetthatwewantfli : tobe over). RestritingtoTonsistsofthrowingawayanypointswith 
2TB valuelessthanalonganyaxis.Theexpetedamount ofprobabilitymassthrownawayisthenatmostntimes theamountthrownawaybyrestritingalongoneaxis(i.e., 
2TB+l removingallpointswithintheslabofwidthentered attheoriginandperpendiulartotheoneaxis.) Considerasinglepointx,x=0.Thefollowing 
Rn b boundontheprobabilityofasmallprojetioninthedire­tionofarandomunitvetorisprovedin[2]. 2 x4 T2 Pr[(wx):]: 
wsn nCC l6nl6n 2 2Tb LetC=andB=b+log.SineIxI?,we 2T2B2haveforthehosenvalueofCthat:n..Asweonly 2T2B throwoutthepointifit'sprojetionislessthan,this 
hoieofBimpliesthattheprobabilityofthrowingouta pointisatmost4n foroneaxis.Thuswithprobabilityat leastahalf,wethrowoutnomorethanan2frationofthe 
distributionafteronsideringallnaxes. Letusnowonsidertheboundon,weahievewhenour initialdistributionisnotoverJn 
,butratheroverRn .We bb applythetransformationinlemma5asaninitialstep,and thenapplythealgorithmasbefore.Ourupperboundon, 
doesinrease,butonlybyaonstantfator.Thisisshown inouronludingalulation,whereweuse2,Binplaeof E,b.   
()(2 ) nn2n16nn ,=O(B+log)=O(b+log+log) E/2EEEE nn =O(b+log) EE 4. EFFICIENCY Inthissetionwedesribepolynomialtimeversionsof 
bothalgorithms.Theomputationalmodelistoallowmul­tipliationsandadditionsinunittime. 4.1 Point sets Supposethedistributionfisspeifedexpliitlyasasetof 
mpointswithweightsorrespondingtoprobabilities.Then weanahieveexatlythestatedvalueof,witheither algorithmdeterministially.Therunningtimeforeitheral­gorithmisgivenbythetimetoomputeM(O(mn 
2)),the timetoenterthedistribution(O(n 3+mn 2)),thetimeto fndanoutlier(O(mn)),andtheneedtorepeatthewhole 
proessuptomtimes.Theamountoftimespentinstep2 ofeitheralgorithmisnegligible.Thisyieldsatimebound ofO(m 
2 n 2+mn 3). Intheabovedisussionwemadetheworstaseassump­tionthatonlyonedatapointwasthrownoutineahiter­ationofenteringandlookingforoutliers.Intheasethat 
asingledatapointisthrowout,enteringthedistribution anbedonemoreeÆiently.Ifthedistributionisinitially 
entered,andvofprobabilitypisremoved,thenthenew entereddistributionisahievedbyreplaingeahvetoru V (u:v)v 
 byu-1-1-v2pv2 Anintuitiveexplanationfor thisformulaisthatwearejustorretingtheinertialellip­soidinthediretionofv.Usingthisobservation,weom­puteMfromsrathone(O(mn 
2)),enterthedistribution fromsrathone(O(n 3+mn 2)),andthenfndanoutlier (O(mn))andreenterusingourformulaabove(O(mn))a 
totalofatmostmtimes.Thisyieldstheimprovedtime boundofO(m 2 n+mn 2+n 3). 4.2 Arbitrary distributions 
Themoreinterestingproblemiswherewearenotgivenf expliitly,butratheronlytheabilitytosamplefromf.The outlier-freerestritionoffwillbespeifedasthepartoff 
ontainedinanellipsoid. 1.Applylemma5(ifneessary)togetasetof"lean" axes. 2.GetasetP={xl,...,xm}ofmsamplesfromf. 
3.Runtheoutlierremovalalgorithmalgorithmonthe disretepointsetPwithparameterr2 . 4.LetPibetheoutlierfreesubsetofP.Thentheoutlier­freerestritionoffisgivenby(1+Æ)2r2E(Ma),where 
a M= l ; .xix TiandÆ0isanaurayparam­ m eter. Themaintheoremofthissetionisthefollowing. THEOREM3(SAMPLECOMPLEXITY).Let 
.2 b+Iogn. n m=(Æ2(nlogÆ+logÆ)).Withhighprobability ei­theroutlierremovalalgorithmrunwithparameter= 
r2 (1+Æ)2 , 2returnsasetTsatisfying (i)f((1+Æ)2T)?1-E (ii)(1+Æ)2Thasno(1+O(Æ)), 2-outliers where(, 2 
,E)isahievedbythedeterministiomnisiental­gorithm(omnisientinthatitknowsthedistributionex­atly). Fortheremainderofthissetion,assumethatthede­terministiomnisientalgorithmwithparameter, 
2fnds asubsetSsuhthatf(S)?1-E,andhasno, 2 ­ fls outliers.Thestatement"fls hasno, 2-outliers",orsimply 
"Shasno, 2-outliers"(sinefisimpliit),isexatlythat T 2T \w,max{(wx)2:xS}:,.[(wx)2:xS]Pr[xS]. Notethat.[-]Pr[-]istakenoverf,butmaxisjustoverS. 
T SinemaxisoverS,wheneverwehave\w,max{(wx)2: T xS}:max{(wx)2:xT},wewillbeabletoonlude 2OO(bn thatS.T.Weknowthat,=)isalwaysahiev­able,butinsomeaseswemaydobetter,andourbound 
onrunningtimeisprovedforarbitraryvaluesof, 2 . SupposethatatsomestepweanestimateE(M)to 2 Æ)22 within1±Æineverydiretion.Letr=(1+,.Then 
everypointthatwepereivetobear 2-outlierwillbeat leasta, 2-outlierwithrespettothetruedistribution,and 
soremovingthemdoesnotthrowawayanypointthatthe deterministialgorithmkeeps.Similarly,ifwepereivethe distributiontohavenor 
2-outliers,thetruedistributionwill haveno(1+Æ)2 r 2-outliers.Beforeremovingoutliers,we a maynothavethatMiswithin1±ÆofM.However,when­everwearewrongbymorethan1+Æ,thereissometrueout­lierwithrespettotheoriginaldistributionthatwethrow 
a outevenusingourfawedM.Thislineofreasoning(made rigorous)willallowustoahievea(1+O(Æ)), 2-outlierfree 
regioninspae,where, 2istheparameterahievedbythe deterministiversionofthealgorithm.Inlemma6weshow thisforapartiulardiretioninapartiulariteration.In 
lemma7weextendthistoalliterations,andfnallyinthe proofoftheorem3weextendthistoalldiretionsandall n 2 
b+Iog n iterations.Wealsoshowm=O(Æ2(nlogÆ+logÆ)) samplessuÆetoahieveourstatedgoalofa(1+O(Æ)), 2 ­outlierfreesetwithhighprobability. 
LEMMA6(OUTLIERDETETION,ONEITERATION).Fix adiretionw.LetSbearegioninspae.Letournumberof '2 samplesbem=O(Æ2)andonsiderthesampledistanes 
TT indiretionwgivenby{wxi}.Lety=.[(wx)2:x S]Pr[xS]andxabethesamplevariane xa= l (w T xi)2 .Thenwehavewithonstantproba­ 
ms bilitythat ; T 2 (i)max{(wx)2:xS}:,y=(1-Æ)y: l {(w T xi)2}:(1+Æ)y. ms ; TT (ii)max{(wx)2:xS}:, 2yandT={x:(wx)2: 
r 2 xa}=SeT. PROOF.Property(i)saysthatwedoorretlyestimate thevarianeofanoutlier-freerestritionofthedistribution, 
andproperty(ii)assuresusthatanyoutlier-freerestrition ofthedistributionhasnoprobabilitymasspastr 2times 
thesamplevariane(i.e.,weanalwaysthrowawayproba­bilitymassusingthesamplevariane).Bothlaimsarefor afxeddiretionw.NotethatSfoundbythedeterministi 
omnisientalgorithmsatisfestheonditionsofboth(i)and (ii). LetXibetherandomvariablerepresentingthesquared 
T distaneofxialongthediretionw,Xi=(wxi)2 .Without T lossofgenerality,assumemax{(wx)2:xS}=1(byan appropriatesaling).Firstweshow(i).Sinefls 
hasno , 2-outliers,wehavey?l .ApplyingtheChernofbound '2 todeterminetheprobabilitythatxaisnotagoodestimate 
fory,wehave TÆ2mm/3 Pr[Ixa-myI?Æmy]:e '2 Thisourswithonstantprobabilityform=O(Æ2). Nowweshow(ii).LetTbeasabove,andagainassume 
T max{(wx)2:xS}=1withoutlossofgenerality.IfS hasno, 2-outliers,theny?l ,andwewouldhavefound '2 xatobeanaurateestimatebytheanalysisintheprevious 
m2 paragraph.Inthisase,xa?l+Æ,andShasno,-outliers T 2 impliesmax{(wx)2:xS}:, 2y:rxa.Thisthen impliesS.T. 
LEMMA7(OUTLIERDETETION,MANYITERATIONS). '2 b+Iog Fixw.Letm=O(Æ2logÆn )Theneitheroutlierre­movalalgorithmrestritedtowwithparameterr 
2produes T aregioninspaeT={x:(wx)2:t}(forsomevaluet) suhthatwithonstantprobability (i)ForanysubsetofspaeSthathasno, 
2-outliersalong wS.T. (ii)(1+Æ)Thasno(1+Æ)8 , 2-outliersalongw. PROOF.By"eitheroutlierremovalalgorithmrestrited 
tow",wesimplymeantheone-dimensionalversionsofthe twoalgorithms.ConsiderSahievedbythedeterministi omnisientversionofthealgorithm(restritedtow).Sine 
ouroutlierremovalalgorithmonlythrowsawayprobability masswhenneessary,thisSisthelargestpossiblerestrition 
thatis, 2-outlierfree.Defneyandxaasinlemma6.By lemma6,wehavethatxaisagoodapproximationtoy.This ensuresthatwithgoodprobability,weidentifySasr 
2 ­outlierfree,andso(i)isproved.Itremainstoshowthat,if ouralgorithmforsomereasonhoosesasubstantiallylarger 
regionT,then(1+Æ)Thasno(1+Æ)8 , 2-outliers. T DefneTo={x:(wx)2:a}.Suppose:asuhthat 2Æ)22 Tohasnor-outliers.ThenT(l+Æ)ohasno(1+r-T 
outliers.Thisfollowsfromthefatthatmax{(wx)2:x TT T(l+Æ)o}:(1+Æ)2 max{(wx)2:xTo}and.[(wx)2: xTo]Pr[xTo]isamonotoniallyinreasingfuntionof 
a.Thisanalysisholdswhetherweareonsideringthetrue underlyingdistributionorjustthesamples. SupposeweestimatethatsomesetT=Tthasnor 
2 ­outliers(inwhihasethealgorithmmightreturnTasan answer).Thenoursamplealsoleadsustoalulatethat Tohasno(1+Æ)2 
r 2-outliersfora[t,(1+Æ)t].Forevery t,wewillshowthatforsomenearby(withinafatorof (1+Æ))valueofa,weorretlyestimatethesamplevariane 
ontherestritionofftoTo.Sinetherangeofpossible 22(b+Iog) valuesfortisatmostn,weantakeeveryvalueof t=(1+Æ)kforsomeintegralkandunionboundovertheat 
n 22(b+Iog)b+Iog mostlogl+Æn=O()possiblevaluesfork. Æ WenowshowthatifweestimateTotohaveno(1+Æ)2 r 2 
­outliers,thenwithgoodprobabilityToatuallyhasno (1+Æ)6 r 2-outlierswithrespettothetruedistribution,and 
byourreasoningabove,sinethereisanawithin(1+Æ)of t,T(l+Æ)tis(1+Æ)8 r 2outlierfree. WedothisbyshowingthatifTohasa(1+Æ)6 
r 2-outlier, thenoursampleshowsTotohaveatleasta(1+Æ)2 r 2 ­outlierwithgoodprobability.LetXibetherandomvariable 
representingthesquareddistaneofxialongthediretion T w,Xi=(wxi)2 .Withoutlossofgenerality,assumea=1. 
Defneyandxaasinlemma6(butwithToinplaeofS). ThenbyassumptiononTo,y:l .Theondition 2 (l+Æ)6thatoursamplesshowTotohaveatleasta(1+Æ)2 
r 2 ­outlierisl Xi:l .WeapplytheChernof m;Ta(l+Æ)22 bound, TL2 m.[X;l/3 Pr[Xi?(1+L)m.[Xi]]:e wherewehavestatedtheChernofboundforthease 
thatL1.LetL= l 2 -1(thisyieldsthe .[X;l(l+Æ)2 orreteventinourprobabilityalulation).IfL1,then L2 .[Xi]?Æ2 
,andtheprobabilitywedonotorretlyiden­ 2 TL2 m.[X;l/3 tifythefurthestoutlierisatmoste=O(1)for Æ m=O( 2 
).IfL?1,thenL.[Xi]?,andtheap­ 22 pliablealternateformoftheChernofboundyieldsthat TLm.[X;l/3 Pr[Xi:m/,2]isatmoste=O(1)forthe 
samesettingofm. n b+Iog SinethereareonlyO()diferentvaluesofato Æ n 2 b+Iog onsider,m=O(Æ2logÆ)allowsustounionbound 
overallthepossiblevaluesofa.Thisshowsthatwithon­stantprobability,ifweestimateTtohavenor 2-outliers(in 
whihaseouralgorithmmightreturnT),then(1+Æ)Thas no(1+Æ)8 r 2-outliers.Thisimplies(ii). Weextendtheanalysisoflemmata6and7fromafxed 
diretiontoalldiretionsandarguetheorretnessofthe entirealgorithmbyprovingtheorem3. PROOF.LetSbetheellipsoidfoundbythedeterminis­tialgorithm(i.e.theoutlierfreesubsetofpointsliesin 
thisellipsoid).Ratherthanonsideringtheoriginalspae, onsiderthetransformedspaewhereS(notE(Ms))is theunitsphere.Considerthemanydiretionswgiven 
Æ ÆiÆi bya-gridoverthesphere,=.Weformthisgrid n byhoosingeverywsuhthattheoordinatesofwlie Æ2Æ in{0,,,...,1}.Byourhoieofm,weanapply 
nnn lemma7part(i)toeahofthese()ndiretionssimul- Æ Æi taneously.Wethenhavethatforeverywinthe-grid, TT 
max{(wx)2:xT}?max{(wx)2:xS}(i.e.,inthis diretionTontainsS).Wenowshowthatforanarbitrary diretionw,(1+Æ)2TontainsS. 
Consideranarbitraryunitvetorw.Foreveryaxisdi­retioni,therearesomevetorswilandwi2intheÆi-grid thatareaboveandbeloww,butwithindistaneÆ/n.Sine 
a T=r 2E(MT)isonvex,theminimumdistaneofTfrom l2 Æ theoriginbetweenwiandwiisgivenby1-.Bounding n overthemaximumdereaseineveryaxisdiretiongivesthat 
Tisatleastdistane1-Æfromtheoriginindiretionw. SineSiswithin1oftheorigineverywhere,wehavethat (1+Æ)TontainsS,andtherefore(1+Æ)2Talsoontains 
S.Thisonludestheproofof(i). Nowonsider(ii).Foreverywinour-grid,wehave Æithat(1+Æ)Tis(1+Æ)8 r 2-outlierfreealongwbylemma 
7part(ii).Consideranarbitraryunitvetorwnotinthe ÆiÆi -grid.Denotew'snnearestneighborswithinthe-grid by{wi}.Letwiibethevetorindiretionwiwithlength 
T givenby.[(wix)2:x(1+Æ)T]Pr[x(1+Æ)T].Then w idefnedsimilarlyisboundedawayfromtheoriginby thehyperplaneformedbythe{wii}thisfollowsfromthe 
onvexityofE(M(l+Æ)T).Combiningthisandthespaing ofthe-gridasinthepreviousparagraph,wefndthatthe Æimaximumdropinmovingtowfromwiisatmost(1-Æ), 
TT i.e.,.[(wx)2:x(1+Æ)T]?(1-Æ)mini.[(wix)2:x (1+Æ)T]. Sine(1+Æ)Tis(1+Æ)8 r 2-outlierfreealongw,(1+Æ)Te 
Hw,whereHwisthehalfspae(reallyaslab)orrespond- T 2T ingtow,Hw ={x:(wx)2:(1+Æ)8 r.[(wx)2:x  (1+Æ)T]Pr[x(1+Æ)T]}.LetH=Hw,theintersetion 
w ofallthehalf-spaes.Thenbythesameargumentusingthe onvexityofHandthespaingoftheÆi-grid,foranarbi- TT 
 traryw,max{(wx)2:xH}:(1+Æ)minimax{(wix)2: xH}.Oursimultaneouslowerboundontheexpetation foranarbitrarywandupperboundonthemaximumfor 
thatsamewyieldthatHis(1+Æ)l r 2-outlierfree. UsingthesameÆi-gridreasoning,wefndthat(1+Æ)2T Æ)l22 ontainsH,andtherefore(1+Æ)2Tis(1+r-outlier 
free. Beforestatingtheorollaryfortherunningtime,wemen­tionthatwestillhavenotshownthatstep2ofeitheralgo­rithmanbearriedoutwithhighprobability.Thiswillbe 
doneinourfnallemmaofthissetion,lemma8.Assuming lemma8,wehavethefollowingboundontherunningtime. COROLLARY1(RUNNINGTIME).Thealgorithmrunsin 
OO(b2 n 5 time). 2Æ4 PROOF.Wehavefromsetion3that,=, 2isatmost OOO(bn2 O(bn/E),andsoweneverneedmorethanm= 
Æ2)sam­ples.Plugginginthisvalueformtoourboundsinthedis­ussionofrunningtimeatthebeginningofsetion4yields 
n thatourentirealgorithmrunsintimeOO(b25 ),whihisthe 2Æ4 boundwereferredtointheintrodution.Inthistimewe 
ahievea1+O(Æ)approximationtotheoptimalvalueof ,. Wenowshowthatweanarryoutstep2ofeitheralgo­rithmwithhighprobability.Additionally,wesolvethefol­lowingproblem.Supposethatwearenotgiventheparam­eter, 
2 ,butratheronlyE,andaskedtofndtheappropriate , 2 .Lemma8willshowthatweanatanypointdetermine withinafatorof(1+Æ)howmuhoftheprobabilitymass 
iswithinafxedellipsoid.Sine, 2[1,OO(bn)],thereare OO(bnIog1n 2 atmostlogl+Æ)=valuesof,toonsider(with 
Æ alossofatmostafatorof(1+Æ)inthevaluewefndfor , 2).Thereforeweansimplytrythemall,estimatingfor eahonewhetherthis, 
2requiresustothrowawaymore thana(1+Æ)Efrationofthedistribution. Thus,iftheparameters(, 2 ,E)areahievableforthede-terministialgorithm,andweareonlygivenE,weanfnd 
aregioninspaeTisatifyingparameters((1+O(Æ)), 2 ,(1+ OO(b2 n 5 O(Æ))E).Ourasymptotirunningtimeinreasesto+ 
2Æ4 l h),whihisaninreaseofnomorethanaonstant. Æ LEMMA8(PROBABILITYMASSLOATION). (i)Fixadiretionw.Letournumberofsamplesbem= 
O(Æl2)andonsiderthesquaredsampledistanesindire- T tionwgivenby{(wxi)2}.Letyabethegreatestysuhthat a(1+Æ)Efrationofoursamplesareabovey.Thenwith 
onstantprobability atleastanEfrationofthedistribution hassquareddistanealongwofatleastyaandatmosta (1+Æ)2Efrationhassquareddistanealongwgreaterthan 
ya. (ii)LetEbeanellipsoid.Letournumberofsamplesbe m=O(l).Thenifweestimatea(1+Æ)Efrationofour Æ2 samplestobeoutsideofEwithonstantprobabilityatmost 
a(1+Æ)2EfrationisoutsideofEandatleastanEfration isoutsideoforonE. T PROOF.Firstweshow(i).Letyhigh={y:Pr[(wxi)2? 
T y]=E}.Letribearandomvariable,ri=1if(wxi)2 yhigh.Theeventthatyayhighisthesameasri? m(1+Æ)E.Weanupperboundtheprobabilityofthisevent 
usingtheChernofbound TÆ2 m.[Y;l/3 Pr[ri?m(1+Æ).[ri]]:e whihisonstantform=O(l).Asimilaralulation Æ2 T 
withyw ={y:Pr[(wxi)2?y]=(1+Æ)2E}showsthat theprobabilityofyaywisatmostaonstantforthe samevalueofm. Theproofof(ii)isidential.ByenteringE,weanjust 
onsiderdistanefromtheoriginofoursamplesratherthan distanealongafxedw. Oneonsequeneofthetheoremsinthissetionisthat 
On 2b) asampleofsizeO(isenoughtoestimatetheinertial ellipsoidofanydistribution(afterremovingatmostanE 
fration)andthusbringitintonearlyisotropiposition.  5. A MATCHING LOWER BOUND WeshowthatforanyE1/2thereexistsadistribution 
fsuhthat,foranySsatisfyingf(S)?1-E,thereexists wsuhthat T2 T2 a max{(wx):xS}?,.[(wx):xS]Pr[xS] a T2 ?, 
.[(wx):xS] 2 an where,=n((b-logl)).Basedontheomparisonbe­tweenourupperandlowerboundson,intheasethatwe 
an'tthrowoutmorethanhalfthedistribution () nnn1 O(b+log)vs.n(b-log) EEEE wedesribeourresultasasymptotiallyoptimal. 
bll bi lowingdistributionalongeahaxis.Lettherebe2bi points atdistanes Fixn,Eand= 2 -4log.Letfbeaopyofthefol­ 
2b. 2b.+l22b.Tl 2b.Tl 2,2l ,...,,e,e,...e EEE andonsiderthedistributionthatplaesa(1-2E)fration oftheprobabilitymassuniformlyonthefrstpointsand 
bi a2Efrationuniformlyontheremainingpoints.This bi distributionsatisifesthatthemaximumbitlengthalongan 
. 221 axisislog:=b. TherearemanywaysofhoosingasubsetSofthisdistri­bution,butweanquiklyrestritthesetofpossiblehoies. 
Firstweshowthatitneverhelpstotreatthediferentaxes asymmetriallyforadistributionthatisonentratedon theaxes.Supposethatthisstatementisnottrue.Webe­ginbynotingthatforadistributiononentratedonthe 
laxi(w)2:s} axes,wmaximizing::alwaysoursonan .[(w)2l axis.Letflbeadistributiononwhihitispossibleto throwoutanEfrationofthedistributionandahievepa­ 
a rameter,.FurthersupposethatthisEistheminimumE aa suhthatthis,isahievable,andtheonlySahieving, isasymmetri.Letaxisibetheaxisthattheoutliero­urson,andsupposethatalongaxisiwethrowoutanEi 
frationofthetotaldistribution.Letbethesubsetoffl Si wherewethrowoutthesamepointsalongeveryaxisthat Ei 
 wethrewoutalongaxisiinS.Thenwehave=nEi.If Ei:E/n,thenontraditstheassumptionthattherewas Si nosymmetrisubsetweouldthrowoutahievingthesame 
a (E,,).IfEiE/n,thenthereissomeotheraxisjsuhthat alongaxisjwethrowoutanEjEifrationoftheprob­ aa abilitydistribution,butahieving,j:,alongthataxis 
a (i.e.max{xj:xS}:,j.[xj2:xS]Pr[xS]).Con- Sii strutingbytakingSandreplaingourhoieofpoints tothrowoutalongaxisiwiththepointsthrownoutalong 
Eii axisjthenyieldsaontraditionbeauseE.Thuswe anrestritourattentiontoSsymmetri. Foranydiretionwalonganaxis,theprojetionontow 
ofanypointontheothern-1axesis0,soweobtain 1 .[(w T x)2]=.[x 2 ,fone-dimensional] n Weignorethefatorofnfortherestoftheproofandre­stritourattentiontoasingleoordinateaxis.Supposethe 
a furthestpointkeptbySahievingparameters(E,,)isthe pointwithexponentk.Byourhoieofdistribution,we annothavethrownoutmorethanhalfthepointswitha 
22k :lfator,andsowehavemax{x 2:xS}=,kbi . Calulatingtheexpetation 2 1-2E22b.T2 .[x:xS]Pr[xS]:(2+2+...+2)+ 
2bi 2E12b. 2b.+2 2k (2+2+...+2) 2biE 22b.Tl22k+l22k+2 :+: 2bibibi a yieldsthat,?4b. fortheone-dimensionalase.Thusour 
lowerboundinthen-dimensionalaseis n1 a ,?(b-log) 8EE  6. AN APPROXIMATION ALGORITHM Weshowedearlierinthepaperthatforanydistribution 
nn f,andanyEweanahieve,=O((b+log)).Aquestion thatnaturallyarisesishowwellweandoonapartiular distributionomparedtothebestpossibleonthatpartiular 
distribution.Formally,givenfandE,weseekSminimizing ,subjettotheonstraintsthat (i)f(S)?1-E TT (ii)\w,max{(wx)2:xS}:,.[(wx)2:xS] 
 Thisisreallyabiriteriaapproximationproblemwithpa­rameters(,,E).Notethatinthisase,wearelookingfor thenormalizedprobabilitydistributiontobe,-outlierfree. 
Weexhibita(l ,1)-approximationalgorithmforthistask lT intheasethatwearegiventhedistributionexpliitly.If 
weanonlysamplefromthedistributionf,ouralgorithm yieldsa(l+Æ,1+Æ)approximationforanyonstantÆ0 lT withhighprobability. 
LEMMA9(PRESERVATIONOFOUTLIERS).Letfbeadis­tribution.Any,-outlierforfisatleasta,(1-E)-outlier withrespettoanysubsetSsatisfyingf(S)?1-E. 
PROOF.Letxbea,-outlierintheoriginaldistribution. TT Thenforsomew,(wx)2 ,.[(wx)2]ForanyS,wehave TT .[(wx)2:xS]Pr[xS]:.[(wx)2]andsoxsatisfes 
TT (wx)2 ,(1-E).[(wx)2:xS] Theapproximationalgorithmissimplyeitheralgorithm desribedinsetion4,witherrorparameterÆinthease 
thatwearesamplingfromf.Weoulddeterminetheop­timal,forafxedEthroughabinarysearh.Supposethe value,JTisahievablebytherestritionofftosome 
Ssatisfyingf(S)?1-E.Anytimeouralgorithmseesa pointthatisa, i-outlierwithrespettotheunnormalized i If!: 
distribution,,lT,weknowthatthisannotbea (:,JT)-outlierunderanyrestritionoffbylemma9.So thispointwillhavetobethrownoutbytheoptimalsolu- 
If!: tion.Thusrunningouralgorithmwith,=lTfores ustothrowawaynopointsthattheoptimalsolutiondoes l notalsothrowaway.ThisyieldsthatweahievealT 
­approximationintheaseofanexpliitlyprovideddistri­bution.Corretnessandrunningtimearelearfromthe preedingdisussions. 
Thereisamorediretmethodthatinfatfndsanap­proximationto,foreveryEinonepass.Thealgorithmsof setion2anbeusedtodefneanoutlierorderingofapoint 
set,namely,thefrstpointthatisanoutlier,theseond point,et.Nowtoapproximatethebestpossible,fora partiularvalueofEwesimplyremovetheinitialEfration 
ofthepointsintheoutlierordering.  7. STANDARD DEVIATIONS FROM THE MEAN Weproveavariantofourtheoremthatshowsweanfnd 
alargesubsetoftheoriginalprobabilitydistributionwhere nopointistoomanystandarddeviationsawayfromthe mean. 
COROLLARY2(STI.DEVIATIONSFROMTHEMEAN). In Letfbeaprobabilitydistributionon.LetSbeare­ b gioninspae.Denotebyf(S)theprobabilitythatxho­ 
sen aording to f is in S.Let ax = .[x : x S] and J2 w =.[(w T(x-ax))2:x S]. ThenforeveryE 0 there existsSand 
n n ,=O E(b+log E) suhthat (i)f(S)?1-E e T n (ii)max{w(x-xa):xS}:,Jwforallwn PROOF.Theproofoftheorollaryismuhliketheproof 
oftheorem1,butwithtwoadditionalsteps.Inthefrst step,weshowthattranslatingfsothattheoriginoinides withthemeandoesnotinreasethevolumeoftheprimal 
inertialellipsoid.Intheseondstep,weshowthatrunning thealgorithmwithourvalueofbdoubledsuÆestopreserve 
ourdualvolumebound.Thesestepstakentogetherwithour previousanalysisimplyorollary2. Inordertoanalyzethevolumeoftheprimalinertialellip­soid,onsidertheradiusroftheprimalinertialellipsoidin 
afxeddiretionw.Impliitlytakingallexpetationswith respettotherestritedprobabilitydistributionfls,and lettingxwbethevalueoftheprojetionofxontow,we 
haver 2 =.[x 2].Supposewehoosetotranslateourori­ w gintoavaluezalongw.Wethenhaver 2 =.[(xw -z)2]. Singlevariablealulusshowsthatthevalueminimizingr 
isz=.[xw],whihisjustthemean.Thustranslatingour origintoxaminimizestheradiusoftheprimalinertialellip­soidineverydiretionsimultaneously.Sineouranalysisin 
 theproofoftheorem1relieduponshowingshrinkageofthe primalellipsoid(growthofthedualellipsoid),thealgorithm 
thatateahsteptranslatestheorigintothenewmeanon­ludesatleastasquikly,throwingoutnomoreprobability massoverall. 
Itmaybethatatsomepointourmeanisnotanelement of.Weshowthateveninthisaseourdualvolume In b boundstillholds.Supposethatatsomesteptheriterion 
forstep2ofeitheralgorithmismetforaxisi,butwith thevalueofbdoubled.Thenwethrowoutallxwithxi? 2T2b (whereourmeanhasxi=0).Notalltheremaining 
elementsneessarilyhavexi=0,buttheydoallneessarily havethesamexivalue,beausetwoelementsofbannot In havedistintvaluesforapartiularoordinatethatdifer 
bylessthan2T2b .Sothedimensiondoesollapse.Ourdual volumeboundonlyrequiredtheguaranteethatineverynon­ollapseddimensionatleastan3nfrationofthepointshave 
2T2b oordinatevalueatleast.Thisonludestheproofof orollary2. 8. REFERENCES [1]A.Blum,A.Frieze,R.KannanandS.Vempala,"A 
Polynomial-TimeAlgorithmforLearningNoisyLinear ThresholdFuntions,"InAlgorithmia,22(1),1999, pp35-52. 
 [2]A.Blum,G.Konjevod,R.Ravi,andS.Vempala, "Semi-DefniteRelaxationsforMinimumBandwidth andotherVertex-OrderingProblems,"InPro.ofthe 
30thACMSymposiumontheTheoryofComputing, Dallas,1998.ToappearinTheoretialComputer Siene,speialissueinhonourofManuelBlum. 
 [3]L.Lovaasz,R.KannanandM.Simonovits,"Random O * 5 walksandan(n)volumealgorithmforonvex bodies,"InRandomStruturesandAlgorithms11, 
pp1-50. [4]L.Lovaasz,R.KannanandM.Simonovits, "Isoperimetriproblemsforonvexbodiesanda loalizationlemma,"InDisreteComputational 
Geometry13,1995,pp541-559. [5]R.HornandC.Johnson,MatrixAnalysis,Cambridge UniversityPress,1985,pp179. 
  9. IMPLEMENTATION LetXbeannxmmatrixwhoseolumnsarethepoints ofourdistribution.Letr,beta,epsilonbethevaluesfor 
m,,,E,andletthebooleanvariabledoneindiatewhether wearefnishedremovingoutliers.IntheasethatXisfull dimensionalthroughoutthealgorithm(aommonase),a 
ompleteimplementationisgivenbythefollowingmatlab ode: done =0 while(-done) done =1 M= X*X'/r Y= M.(-.5)*X%%YisenteredversionofX 
for i=1:r,%%reroveurrentoutliers ifY(:,i)'*Y(:,i)>beta,X(:,i)=0,done=0,end end end Handlingdimensiondroppingaddsafewmorelinesofode. 
 
			